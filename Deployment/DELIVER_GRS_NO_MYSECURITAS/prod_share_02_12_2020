-- IN PRODUCTION ENVIRONMENT ---

--PROD_DATAMART
---------------------------------------------------------------START  PROD SCRIPT------------------------
USE ROLE ACCOUNTADMIN;
--CREATE OR REPLACE SHARE PROD_DATAMART; -- SET COMMENT ='PRODUCTION DATAMART SHARE'

CREATE OR REPLACE SHARE PROD_DATAMART_MYSECURITAS;
CREATE OR REPLACE SHARE PROD_DATAMART_RISKPREDICTION;

GRANT USAGE ON DATABASE DATAMART TO SHARE PROD_DATAMART_MYSECURITAS;
GRANT USAGE ON DATABASE DATAMART TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT USAGE ON SCHEMA DATAMART.MYSECURITAS TO SHARE PROD_DATAMART_MYSECURITAS;
GRANT USAGE ON SCHEMA DATAMART.RISKPREDICTION TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT REFERENCE_USAGE ON DATABASE ODS_GRS_NO TO SHARE PROD_DATAMART_MYSECURITAS;
GRANT REFERENCE_USAGE ON DATABASE DW TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT REFERENCE_USAGE ON DATABASE ODS_GRS_NO TO SHARE PROD_DATAMART_RISKPREDICTION;
GRANT REFERENCE_USAGE ON DATABASE DW TO SHARE PROD_DATAMART_RISKPREDICTION;

--GRANT SELECT ON VIEW "DATAMART"."MYSECURITAS"."GRSNO_ALARM" TO SHARE PROD_DATAMART;

--- GRANT MYSECURITAS ----
GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_GCS_EXPORT_ERP_CALL_OUTS TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_GCS_EXPORT_ERP_CALL_OUT_GUARDS TO SHARE PROD_DATAMART_MYSECURITAS;


GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_ALARM TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_ALARM_CODES TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_ALARM_GROUP TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_ASSIGNMENT_TYPE TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_CONTRACT_PART TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_CONTR_PART_VER TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_CONTRACT_TYPE TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_CUST_CUST_OBJECT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_GD TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_LOCATION_OBJECT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_PRODUCTION_OBJECT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_PROFITCENTER TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_REPORT_MARK TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_GRS_ADDONINFO TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_COMMIT_LOC_OBJECT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_COMMITMENT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_CONTRACT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_CUSTOMER_OBJECT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_CUSTOMER TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_LOCATION_MARK TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_PROD_CUST_OBJECT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_SFU_COMMITMENTPERFORMED TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_SFU_COMMITMENTPERFORMEDEXTRAVISITS TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_REPORT_MARK_CULTURE TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_PROCESSED_TRANSACTIONS TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_TEMP_TRANSACTIONS TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_USERS TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_XPROCESSED_BARCODES TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_XTEMP_TRANSACTIONS TO SHARE PROD_DATAMART_MYSECURITAS;

--GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_XREPORT_MARK TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_XPROCESSED_TRANSACTIONS TO SHARE PROD_DATAMART_MYSECURITAS;

--GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_XTEMP_TRANSACTIONS_ATTACHMENT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_LOC_MARK_TYPE TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_TEMP_TRANSACTIONS_ATTACHMENT TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_TEMP_TRANSACTIONS_ATTACHMENT_CULTURE TO SHARE PROD_DATAMART_MYSECURITAS;

GRANT SELECT ON VIEW DATAMART.MYSECURITAS.GRSNO_LOC_MARK_REPORT TO SHARE PROD_DATAMART_MYSECURITAS;

--GRANT SELECT ON ALL VIEWS  IN SCHEMA DATAMART.MYSECURITAS  TO SHARE PROD_DATAMART; -- BULK VIEW SHARE IS RESTRICTED.

--END MYSECURITAS ----


----- GRANT RISKPREDICTION VIEWS-----

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_GCS_EXPORT_ERP_CALL_OUTS TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_GCS_EXPORT_ERP_CALL_OUT_GUARDS TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_ALARM TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_ALARM_CODES TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_ALARM_GROUP TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_ASSIGNMENT_TYPE TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_CONTRACT_PART TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_CONTR_PART_VER TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_CONTRACT_TYPE TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_CUST_CUST_OBJECT TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_GD TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_LOCATION_OBJECT TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_PRODUCTION_OBJECT TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_PROFITCENTER TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_REPORT_MARK TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_GRS_ADDONINFO TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_COMMIT_LOC_OBJECT TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_COMMITMENT TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_CONTRACT TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_CUSTOMER_OBJECT TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_CUSTOMER TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_LOCATION_MARK TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_PROD_CUST_OBJECT TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_SFU_COMMITMENTPERFORMED TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_SFU_COMMITMENTPERFORMEDEXTRAVISITS TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_REPORT_MARK_CULTURE TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_PROCESSED_TRANSACTIONS TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_TEMP_TRANSACTIONS TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_USERS TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_XPROCESSED_BARCODES TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_XTEMP_TRANSACTIONS TO SHARE PROD_DATAMART_RISKPREDICTION;

--GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_XREPORT_MARK TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_XPROCESSED_TRANSACTIONS TO SHARE PROD_DATAMART_RISKPREDICTION;

--GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_XTEMP_TRANSACTIONS_ATTACHMENT TO SHARE PROD_DATAMART_RISKPREDICTION;

GRANT SELECT ON VIEW DATAMART.RISKPREDICTION.GRSNO_LOC_MARK_REPORT TO SHARE PROD_DATAMART_RISKPREDICTION;

--------END RISKPREDICTION ---
ALTER SHARE PROD_DATAMART_MYSECURITAS ADD ACCOUNTS = SECURITASTEST;
ALTER SHARE PROD_DATAMART_RISKPREDICTION ADD ACCOUNTS = SECURITASTEST;
---------------------------------------------------------------END PROD SCRIPT------------------------


--PRD_DATAMART
---------------------------------------------------------------START  QA SCRIPT------------------------
USE ROLE ACCOUNTADMIN;

CREATE OR REPLACE  DATABASE PRD_DATAMART_MYSECURITAS FROM SHARE SECURITAS.PROD_DATAMART_MYSECURITAS;
CREATE OR REPLACE  DATABASE PRD_DATAMART_RISKPREDICTION FROM SHARE SECURITAS.PROD_DATAMART_RISKPREDICTION;


USE ROLE SECURITYADMIN;
------- DATABASE ACCESS
GRANT IMPORTED PRIVILEGES ON DATABASE PRD_DATAMART_MYSECURITAS  TO ROLE TEAM_EU_ENTERPRISEINTEGRATION;
GRANT IMPORTED PRIVILEGES ON DATABASE PRD_DATAMART_MYSECURITAS  TO ROLE TEAM_EU_IP_DATAENGINEERING;
GRANT IMPORTED PRIVILEGES ON DATABASE PRD_DATAMART_RISKPREDICTION  TO ROLE TEAM_EU_SIS_DATAENGINEERING;
GRANT IMPORTED PRIVILEGES ON DATABASE PRD_DATAMART_RISKPREDICTION  TO ROLE TEAM_EU_SIS_DATASCIENCE;