{"dbEnvironment":"snowflake","version":"1.50.6","jobsTree":{"id":6572,"name":"ROOT","children":[{"id":623631,"name":"KONTROLSYS","children":[],"jobs":[{"id":623630,"name":"CSVFileLoadSystem","description":"Load CSV File to StageSystem","type":"ORCHESTRATION","tag":"11eacfc2-192c-4e3a-b12a-acafd117627a"},{"id":623609,"name":"CSVFileStageODSLoadProcess","description":"Create the table As-Is ODS metadata and replacing the Binary (VARIANT) to Varchar. Data Load from CSV files to KONTROLSYS GRSNO STG tables.","type":"ORCHESTRATION","tag":"dbbc033b-f424-4d6a-b29b-960cd8ab29e2"},{"id":623670,"name":"CreateCSVFileList","description":"Get list of Azure Blob Files, create a file of them, Load that file into a table.","type":"ORCHESTRATION","tag":"ad4e0dbb-da33-4978-b30c-32e4a5aea303"},{"id":623686,"name":"Remove Restricted Data","description":"Remove Restricted/Red List  Data","type":"ORCHESTRATION","tag":"48d7dd62-27fe-4a6c-a2c4-e1338f04a57f"},{"id":623704,"name":"CSVFileProcess","description":"CSVFileProcess","type":"ORCHESTRATION","tag":"e1aedc1e-48b7-4b82-8a9c-cff7ba4573a1"}]}],"jobs":[]},"orchestrationJobs":[{"id":623630,"revision":5,"created":1616150990793,"timestamp":1616150990793,"components":{"623617":{"id":623617,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-224,"y":160,"width":32,"height":32,"inputConnectorIDs":[623636],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623616":{"id":623616,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-576,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[623634],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623619":{"id":623619,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-48,"y":-16,"width":32,"height":32,"inputConnectorIDs":[623646],"outputSuccessConnectorIDs":[623633],"outputFailureConnectorIDs":[623637],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get LoadProcess List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\nSourceSystemId\t,\n--SourceTableName||'_20*.*'\tCSVFileName,\n--'KONTROLSYS_'||SourceTableName||'_20*.*'\tCSVFileName,\n'KONTROLSYS_'||SourceTableName||'_20.*'\tCSVFileFormat,\nStageType\t,\nStageDatabaseName\t,\nStageSchemaName\t,\nStageTableName\t,\nODSDatabaseName\t,\nODSSchemaName\t,\nODSTableName\t,\nSourceSystemName\nfrom \ndw.control.SOURCESYSTEM_LOADPROCESS3\nWHERE LOADPROCESS_ACTIVEFLAG=true \nAND sourcesystemid=${SourceSystemId}\n--AND ODSTableName in ('CONTRACT','BASEFILE')\norder by ODSTableName"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadTableList"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFILEFORMAT"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETYPE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMNAME"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623618":{"id":623618,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-48,"y":160,"width":32,"height":32,"inputConnectorIDs":[623637],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623621":{"id":623621,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":384,"y":-16,"width":32,"height":32,"inputConnectorIDs":[623635],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623620":{"id":623620,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":96,"y":160,"width":32,"height":32,"inputConnectorIDs":[623638],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623623":{"id":623623,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1348346479,"x":-432,"y":-16,"width":32,"height":32,"inputConnectorIDs":[623634],"outputSuccessConnectorIDs":[623647],"outputFailureConnectorIDs":[623639],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted Data Load"}}}},"visible":true},"2":{"slot":2,"name":"SYSTEMNAME","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemName}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623622":{"id":623622,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-432,"y":160,"width":32,"height":32,"inputConnectorIDs":[623639],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623641":{"id":623641,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-224,"y":-16,"width":32,"height":32,"inputConnectorIDs":[623647],"outputSuccessConnectorIDs":[623646],"outputFailureConnectorIDs":[623636],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Blob FileList"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CreateCSVFileList"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ContainerName"},"2":{"slot":2,"type":"STRING","value":"${ContainerName}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623640":{"id":623640,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":96,"y":-16,"width":32,"height":16,"inputConnectorIDs":[623633],"outputSuccessConnectorIDs":[623632],"outputFailureConnectorIDs":[623638],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop parameter List - Stage"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadTableList"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFileFormat"},"2":{"slot":2,"type":"STRING","value":"CSVFileFormat"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageType"},"2":{"slot":2,"type":"STRING","value":"StageType"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"StageDatabaseName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"StageSchemaName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"StageTableName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSystemName"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[623648],"inputIterationConnectorIDs":[]},"623643":{"id":623643,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":96,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFileProcess"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFileProcess"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFileFormat"},"2":{"slot":2,"type":"STRING","value":"${CSVFileFormat}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageType"},"2":{"slot":2,"type":"STRING","value":"${StageType}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemName}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[623648]},"623642":{"id":623642,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":256,"y":-16,"width":32,"height":16,"inputConnectorIDs":[623632],"outputSuccessConnectorIDs":[623635],"outputFailureConnectorIDs":[623649],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop OrphantableList for deletion"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadTableList"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[623650],"inputIterationConnectorIDs":[]},"623645":{"id":623645,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-878169426,"x":256,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OrphanDataDeletion"}}}},"visible":true},"2":{"slot":2,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true},"3":{"slot":3,"name":"DeleteOrphan","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[623650]},"623644":{"id":623644,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":256,"y":160,"width":32,"height":32,"inputConnectorIDs":[623649],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 4"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"623647":{"id":623647,"sourceID":623623,"targetID":623641},"623646":{"id":623646,"sourceID":623641,"targetID":623619},"623633":{"id":623633,"sourceID":623619,"targetID":623640},"623632":{"id":623632,"sourceID":623640,"targetID":623642},"623635":{"id":623635,"sourceID":623642,"targetID":623621}},"failureConnectors":{"623649":{"id":623649,"sourceID":623642,"targetID":623644},"623637":{"id":623637,"sourceID":623619,"targetID":623618},"623636":{"id":623636,"sourceID":623641,"targetID":623617},"623639":{"id":623639,"sourceID":623623,"targetID":623622},"623638":{"id":623638,"sourceID":623640,"targetID":623620}},"unconditionalConnectors":{"623634":{"id":623634,"sourceID":623616,"targetID":623623}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"623648":{"id":623648,"sourceID":623640,"targetID":623643},"623650":{"id":623650,"sourceID":623642,"targetID":623645}},"noteConnectors":{},"canUndo":true,"undoCommand":"Disable Components","undoCreated":1616150988341,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"ContainerName":{"definition":{"name":"ContainerName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"wh-outbound-unzipped"},"CSVFileFormat":{"definition":{"name":"CSVFileFormat","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"KONTROLSYS_BaseFile_20%"},"Expressions":{"definition":{"name":"Expressions","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"SELECT CUSTOMER_ID from ODS_GRS_NO.DBO.CUSTOMER_RESTRICTED_DATA"},"IsRestricted":{"definition":{"name":"IsRestricted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"TRUE"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"ODS_KONTROLSYS_NO"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"RestrictedColumnName":{"definition":{"name":"RestrictedColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_ID"},"RestrictedTablename":{"definition":{"name":"RestrictedTablename","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_RESTRICTED_DATA"},"SourceSchemaName":{"definition":{"name":"SourceSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"3"},"SourceSystemName":{"definition":{"name":"SourceSystemName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"KONTROLSYS"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"STG_KONTROLSYS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"StageType":{"definition":{"name":"StageType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"FULL LOAD"}},"grids":{"LoadTableList":{"definition":{"name":"LoadTableList","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"},{"name":"CSVFileFormat","type":"TEXT"},{"name":"StageType","type":"TEXT"},{"name":"StageDatabaseName","type":"TEXT"},{"name":"StageSchemaName","type":"TEXT"},{"name":"StageTableName","type":"TEXT"},{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"},{"name":"SourceSystemName","type":"TEXT"}],"description":"LoadTableList","visibility":"PRIVATE"},"values":[]}}},{"id":623609,"revision":35,"created":1616747019019,"timestamp":1616747019019,"components":{"623611":{"id":623611,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1120,"y":-144,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[623677],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623610":{"id":623610,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":384,"y":0,"width":32,"height":32,"inputConnectorIDs":[673261],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623613":{"id":623613,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-880,"y":0,"width":32,"height":32,"inputConnectorIDs":[623666],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623612":{"id":623612,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":-448,"y":0,"width":32,"height":32,"inputConnectorIDs":[623655],"outputSuccessConnectorIDs":[623651],"outputFailureConnectorIDs":[623665],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Stage Table"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"4":{"slot":4,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageTableName}"}}}},"visible":true},"5":{"slot":5,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"},"2":{"slot":2,"type":"GRID","value":"Type"},"3":{"slot":3,"type":"GRID","value":"Size"},"4":{"slot":4,"type":"GRID","value":"Precision"},"5":{"slot":5,"type":"GRID","value":"Default_Value"},"6":{"slot":6,"type":"GRID","value":"Not_Null"},"7":{"slot":7,"type":"GRID","value":"Unique"}}}},"visible":true},"6":{"slot":6,"name":"Create/Replace","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Replace"}}}},"visible":true},"7":{"slot":7,"name":"Clustering Keys","elements":{},"visible":true},"8":{"slot":8,"name":"Data Retention Time in Days","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"9":{"slot":9,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"11":{"slot":11,"name":"Primary Keys","elements":{},"visible":true},"12":{"slot":12,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Permanent"}}}},"visible":true},"13":{"slot":13,"name":"Default DDL Collation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623615":{"id":623615,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-448,"y":-144,"width":32,"height":32,"inputConnectorIDs":[623652],"outputSuccessConnectorIDs":[623655],"outputFailureConnectorIDs":[623669],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Replace BINARY Type Grid variable"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import json \n###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0] FULL PULL\n###\n# RestrictedColumnName='C1,C2' BINARY\n\n##access ODSColumns Grid Variable\nv_ODSColumn_IN=context.getGridVariable('ODSColumns')\nprint(\"v_ODSColumn_IN:  \",v_ODSColumn_IN)\nprint(ODSTableName)\nprint(StageTableName)\n\n#list = json.dumps(v_ODSColumn)\n#json.dumps() function converts a Python object into a json string. dumps takes an object and produces a string into collist \ncollist = json.dumps(context.getGridVariable('ODSColumns'))\n\n#print(\"listJson:  \",list)\n#load would take a file-like object, read the data from that object, and use that string to create an object\nReplaceTypeColumns = json.loads (collist.replace('VARIANT','VARCHAR'))\nprint(\"STGColumns intermediate variable:  \",ReplaceTypeColumns)\n\ncontext.updateGridVariable('ODSColumns',ReplaceTypeColumns)\nprint (\"ODSColumn_Final_column_List\", context.getGridVariable('ODSColumns'))\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623614":{"id":623614,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":356330947,"x":-880,"y":-144,"width":32,"height":32,"inputConnectorIDs":[623675],"outputSuccessConnectorIDs":[623672],"outputFailureConnectorIDs":[623666],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumnsMetadata"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"5":{"slot":5,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"6":{"slot":6,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Size"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Precision"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Default Value"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Not Null"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"Unique"}}}},"visible":true},"7":{"slot":7,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623601":{"id":623601,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1395699082,"x":-752,"y":-144,"width":32,"height":32,"inputConnectorIDs":[623672],"outputSuccessConnectorIDs":[623652],"outputFailureConnectorIDs":[623679],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove ODS Audit Fields"}}}},"visible":true},"2":{"slot":2,"name":"Target Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"3":{"slot":3,"name":"Key Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}}},"visible":true},"4":{"slot":4,"name":"Operation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Not In"}}}},"visible":true},"5":{"slot":5,"name":"Fixed/Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fixed"}}}},"visible":true},"6":{"slot":6,"name":"Values Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"}}}},"visible":true},"7":{"slot":7,"name":"Source Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":false},"8":{"slot":8,"name":"Key Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMN_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DATA_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LENGTH"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PK"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623603":{"id":623603,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1989138124,"x":-288,"y":0,"width":32,"height":32,"inputConnectorIDs":[623651],"outputSuccessConnectorIDs":[623673],"outputFailureConnectorIDs":[623664],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"StageFile Blob Storage"}}}},"visible":true},"4":{"slot":4,"name":"Azure Storage Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://devwewhstore/wh-outbound-unzipped/"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"8":{"slot":8,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageTableName}"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSV"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUTO"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"|"}}}},"visible":true},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1"}}}},"visible":true},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\""}}}},"visible":true},"31":{"slot":31,"name":"Null If","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"35":{"slot":35,"name":"Skip Blank Lines","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"36":{"slot":36,"name":"Replace Invalid Characters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"45":{"slot":45,"name":"Nest Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"46":{"slot":46,"name":"Null If","elements":{},"visible":false},"47":{"slot":47,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"50":{"slot":50,"name":"Null If","elements":{},"visible":false},"51":{"slot":51,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"66":{"slot":66,"name":"Null If","elements":{},"visible":false},"67":{"slot":67,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"70":{"slot":70,"name":"Null If","elements":{},"visible":false},"71":{"slot":71,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"126":{"slot":126,"name":"Match By Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${CSVFileName}"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623602":{"id":623602,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-752,"y":0,"width":32,"height":32,"inputConnectorIDs":[623679],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623605":{"id":623605,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-112,"y":-144,"width":32,"height":32,"inputConnectorIDs":[623669],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623604":{"id":623604,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-448,"y":112,"width":32,"height":32,"inputConnectorIDs":[623665],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623607":{"id":623607,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-288,"y":112,"width":32,"height":32,"inputConnectorIDs":[623664],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 4"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623606":{"id":623606,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":991658961,"x":-144,"y":0,"width":32,"height":32,"inputConnectorIDs":[623673],"outputSuccessConnectorIDs":[623654],"outputFailureConnectorIDs":[623678],"outputUnconditionalConnectorIDs":[623676],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove Restricted Data"}}}},"visible":true},"2":{"slot":2,"name":"ContainerName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ContainerName}"}}}},"visible":true},"3":{"slot":3,"name":"CSVFileFormat","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${CSVFileFormat}"}}}},"visible":true},"4":{"slot":4,"name":"ODSDatabaseName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"5":{"slot":5,"name":"ODSSchemaName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"6":{"slot":6,"name":"ODSTableName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"7":{"slot":7,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true},"8":{"slot":8,"name":"SourceSystemName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemName}"}}}},"visible":true},"9":{"slot":9,"name":"StageDatabaseName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"10":{"slot":10,"name":"StageSchemaName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"11":{"slot":11,"name":"StageTableName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageTableName}"}}}},"visible":true},"12":{"slot":12,"name":"StageType","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageType}"}}}},"visible":true},"13":{"slot":13,"name":"DeleteProcess","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623657":{"id":623657,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-144,"y":112,"width":32,"height":32,"inputConnectorIDs":[623678],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 5"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623656":{"id":623656,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":32,"y":128,"width":32,"height":32,"inputConnectorIDs":[623668],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 7"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623659":{"id":623659,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-1008,"y":-144,"width":32,"height":32,"inputConnectorIDs":[623677],"outputSuccessConnectorIDs":[623675,623653],"outputFailureConnectorIDs":[623667],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadProcess"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\nSOURCESYSTEMID,\nSTAGEDATABASENAME,\nSTAGESCHEMANAME,\nSTAGETABLENAME,\nODSDATABASENAME,\nODSSCHEMANAME,\nODSTABLENAME,\nSTAGETYPE,\nLOADTYPE,\nCOLUMNLISTEXP\nfrom dw.control.sourcesystem_loadprocess3\nwhere sourcesystem_activeflag=true\nand loadprocess_activeflag=true\nand SOURCESYSTEMID = ${SourceSystemId}\nand concat(ODSTABLENAME,'_20') = Upper(substr('${CSVFileName}', 12,length(concat(ODSTABLENAME,'_20'))))\n--and ODSTABLENAME = Upper(substr('${CSVFileName}', 12,length(ODSTABLENAME)))\n--and regexp_like(Upper(split_part('${CSVFileName}','_',2)),ODSTABLENAME)\n--and regexp_like(Upper(split_part('KONTROLSYS_BaseFile_20201207_091418_0.csv','_',2)),ODSTABLENAME)\n--and regexp_like(Upper(substr('KONTROLSYS_TicketInspection_Bus_20201213_203349_0.csv', 12)),'TICKETINSPECTION_BUS.*')\n--and regexp_like(Upper(substr('${CSVFileName}', 12)),'${ODSTableName}.*')\norder by loadtype asc"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadProcess"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"LOADTYPE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMNLISTEXP"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623658":{"id":623658,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-1008,"y":0,"width":32,"height":32,"inputConnectorIDs":[623667],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 8"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623661":{"id":623661,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1008,"y":-224,"width":32,"height":32,"inputConnectorIDs":[623653],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python Script 0"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nprint(ColumnListExp)\nprint(CSVFileName)\nprint(ODSTableName)\nprint(StageTableName)\nprint(LoadType)\nv_ColumnListExp=context.getGridVariable('LoadProcess')\n\nprint('v_ColumnListExp : ', v_ColumnListExp)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623660":{"id":623660,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":32,"y":-112,"width":32,"height":32,"inputConnectorIDs":[623676],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python varianle print"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n### \nprint('Select',ColumnListExp )\nprint(StageDatabaseName)\nprint(StageSchemaName)\nprint(StageTableName)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623663":{"id":623663,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":32,"y":0,"width":32,"height":16,"inputConnectorIDs":[623654],"outputSuccessConnectorIDs":[673300],"outputFailureConnectorIDs":[623668],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadProcess"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageType"},"2":{"slot":2,"type":"STRING","value":"StageType"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"StageDatabaseName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"StageSchemaName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"StageTableName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"LoadType"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"ColumnListExp"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[623671],"inputIterationConnectorIDs":[]},"623662":{"id":623662,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-740423399,"x":32,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadObject_STG_ODS 1"}}}},"visible":true},"2":{"slot":2,"name":"LoadType","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${LoadType}"}}}},"visible":true},"3":{"slot":3,"name":"ODSTableName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"4":{"slot":4,"name":"ColumnListExp","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"ODSSchemaName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"6":{"slot":6,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true},"7":{"slot":7,"name":"StageTableName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageTableName}"}}}},"visible":true},"8":{"slot":8,"name":"ODSDatabaseName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"9":{"slot":9,"name":"StageSchemaName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"10":{"slot":10,"name":"StageDatabaseName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"11":{"slot":11,"name":"Constraints","elements":{},"visible":true},"12":{"slot":12,"name":"ColumnListExp","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[623671]},"673287":{"id":673287,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":224,"y":0,"width":32,"height":32,"inputConnectorIDs":[673300],"outputSuccessConnectorIDs":[673261],"outputFailureConnectorIDs":[673308],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delete BlobStorage CsvFile"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\n\necho \"ContainerName:\"  $env_ContainerName\n \n#In bash, set +e is basically the default: If you get an error in a bash script, it normally barfs out an error to the system (this is called an exit code) but the #script will continue running. To exit then you can put set -e on a line to force your script to exit on errors from that point on.\n#So, needed to not exit immediately on non-zero return code\n\nset +e\n\necho \"Delete Azure blob storage KontrolSys file.. After sucessfully processed Data from Source to STG and STG to ODS...\\n\"\necho $CSVFileName\n\naz storage blob delete --container-name \"$env_ContainerName\" --name \"$CSVFileName\" --account-name \"$env_storage\" --sas-token \"$env_sas_token\"\nReturnCode=$?\n\necho $ReturnCode\nif [ $ReturnCode -ne 0 ]; then\n   \techo \"ReturnCode was not zero:  $ReturnCode\"\n    exit $ReturnCode\nfi\n\necho \"Exiting as a success.\"\n\nexit $ReturnCode"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"673305":{"id":673305,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":224,"y":112,"width":32,"height":32,"inputConnectorIDs":[673308],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 6"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"623673":{"id":623673,"sourceID":623603,"targetID":623606},"623672":{"id":623672,"sourceID":623614,"targetID":623601},"623675":{"id":623675,"sourceID":623659,"targetID":623614},"623651":{"id":623651,"sourceID":623612,"targetID":623603},"623653":{"id":623653,"sourceID":623659,"targetID":623661},"623652":{"id":623652,"sourceID":623601,"targetID":623615},"623655":{"id":623655,"sourceID":623615,"targetID":623612},"623654":{"id":623654,"sourceID":623606,"targetID":623663},"673300":{"id":673300,"sourceID":623663,"targetID":673287},"673261":{"id":673261,"sourceID":673287,"targetID":623610}},"failureConnectors":{"623679":{"id":623679,"sourceID":623601,"targetID":623602},"623678":{"id":623678,"sourceID":623606,"targetID":623657},"623665":{"id":623665,"sourceID":623612,"targetID":623604},"623664":{"id":623664,"sourceID":623603,"targetID":623607},"623667":{"id":623667,"sourceID":623659,"targetID":623658},"623666":{"id":623666,"sourceID":623614,"targetID":623613},"623669":{"id":623669,"sourceID":623615,"targetID":623605},"623668":{"id":623668,"sourceID":623663,"targetID":623656},"673308":{"id":673308,"sourceID":673287,"targetID":673305}},"unconditionalConnectors":{"623677":{"id":623677,"sourceID":623611,"targetID":623659},"623676":{"id":623676,"sourceID":623606,"targetID":623660}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"623671":{"id":623671,"sourceID":623663,"targetID":623662}},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1616746800907,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"623608":{"id":623608,"x":-551,"y":-247,"width":367,"height":139,"text":"Imported  Json class\njson.dumps takes an object and produces a string into collist \nJson.load would take a file-like object, read the data from that object, and use that string to create an object\nre-assign updateGridVariable from ReplaceTypeColumns to  ODSColumn","colour":"e6e63c"},"673279":{"id":673279,"x":109,"y":-75,"width":203,"height":127,"text":"Handling file deletion in Azure Blob storage, When the job crashes in ODS load step.","colour":"e6e63c"}},"variables":{"LoadType":{"definition":{"name":"LoadType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"UPSERT"},"StageType":{"definition":{"name":"StageType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"FULL LOAD"},"CSVFileName":{"definition":{"name":"CSVFileName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"KONTROLSYS_JournaltaskFile_20201213_203349_0.csv"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"JOURNALTASKFILE"},"CSVFileFormat":{"definition":{"name":"CSVFileFormat","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"KONTROLSYS_FileData_20.*"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":" CUSTOMERID"},"ContainerName":{"definition":{"name":"ContainerName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"wh-outbound-unzipped"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"3"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CONTRACT"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_KONTROLSYS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemName":{"definition":{"name":"SourceSystemName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"KONTROLSYS_NO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_KONTROLSYS_NO"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Default_Value","type":"TEXT"},{"name":"Not_Null","type":"TEXT"},{"name":"Unique","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["ID","NUMBER","10","","1","",""]},{"values":["Name","VARIANT","8388608","","","",""]}]},"LoadProcess":{"definition":{"name":"LoadProcess","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"},{"name":"StageType","type":"TEXT"},{"name":"StageDatabaseName","type":"TEXT"},{"name":"StageSchemaName","type":"TEXT"},{"name":"StageTableName","type":"TEXT"},{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"},{"name":"LoadType","type":"TEXT"},{"name":"ColumnListExp","type":"TEXT"}],"description":"LoadProcess","visibility":"PRIVATE"},"values":[]},"DeleteProcess":{"definition":{"name":"DeleteProcess","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"},{"name":"StageDatabaseName","type":"TEXT"},{"name":"StageSchemaName","type":"TEXT"},{"name":"StageTableName","type":"TEXT"},{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"},{"name":"SourceSystemName","type":"TEXT"},{"name":"IsRestricted","type":"TEXT"},{"name":"RestrictedColumnName","type":"TEXT"},{"name":"RestrictedTablename","type":"TEXT"},{"name":"Expressions","type":"TEXT"}],"description":"DeleteProcess","visibility":"PRIVATE"},"values":[]},"ReplaceTypeColumns":{"definition":{"name":"ReplaceTypeColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Default_Value","type":"TEXT"},{"name":"Not_Null","type":"TEXT"},{"name":"Unique","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["ID","NUMBER","10","","1","No","No"]},{"values":["Name","VARIANT","8388608","","1","No","No"]}]}}},{"id":623670,"revision":2,"created":1616070345584,"timestamp":1616070345584,"components":{"623689":{"id":623689,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":640,"y":0,"width":32,"height":32,"inputConnectorIDs":[623681],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623688":{"id":623688,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":320,"y":0,"width":32,"height":32,"inputConnectorIDs":[623680],"outputSuccessConnectorIDs":[623683],"outputFailureConnectorIDs":[623687],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create FileList"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"4":{"slot":4,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILELIST"}}}},"visible":true},"5":{"slot":5,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAME"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"1000"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Create/Replace","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Replace"}}}},"visible":true},"7":{"slot":7,"name":"Clustering Keys","elements":{},"visible":true},"8":{"slot":8,"name":"Data Retention Time in Days","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"9":{"slot":9,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"11":{"slot":11,"name":"Primary Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAME"}}}},"visible":true},"12":{"slot":12,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Permanent"}}}},"visible":true},"13":{"slot":13,"name":"Default DDL Collation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623691":{"id":623691,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":160,"y":0,"width":32,"height":32,"inputConnectorIDs":[623682],"outputSuccessConnectorIDs":[623680],"outputFailureConnectorIDs":[623684],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get FileList"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \"ContainerName:  \" $ContainerName\n\n# needed to not exit immediately on non-zero return code\nset +e\n\necho \"Trying to generate FileList...\"\naz storage blob list --container-name \"$ContainerName\" --output tsv --num-results \"*\" --timeout 30 --account-name \"$env_storage\" --sas-token \"$env_sas_token\" | cut -f11 | grep -v \"/\" > /data/$StageDatabaseName.$StageSchemaName.FILELIST 2>/data/$StageDatabaseName.$StageSchemaName.err\nReturnCode=$?\n\necho $ReturnCode\nif [ $ReturnCode -ne 0 ]; then\n  \techo \"ReturnCode was not zero:  $ReturnCode\"\n\tif [[ ! -f \"/data/$StageDatabaseName.$StageSchemaName.FILELIST\" ]]; then\n    \techo \"The intended file was NOT created on your filesystem.\"\n\tfi  \n\tif [[ -f \"/data/$StageDatabaseName.$StageSchemaName.FILELIST\" ]] && [[ ! -s \"/data/$StageDatabaseName.$StageSchemaName.FILELIST\" ]]; then\n    \techo \"The intended file is empty.  Exiting as a success.\"\n        exit 0\n\tfi\n\texit $ReturnCode\nfi\n\necho \"Trying to upload FileList...\"\naz storage blob upload --file /data/$StageDatabaseName.$StageSchemaName.FILELIST --container-name $ContainerName --name $StageDatabaseName.$StageSchemaName.FILELIST --account-name \"$env_storage\" --sas-token \"$env_sas_token\"\nReturnCode=$?\n\necho $ReturnCode\nif [ $ReturnCode -ne 0 ]; then\n   \techo \"ReturnCode was not zero:  $ReturnCode\"\n    exit $ReturnCode\nfi\n\necho \"Exiting as a success.\"\n\nexit $ReturnCode\n"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623690":{"id":623690,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":472,"y":161,"width":32,"height":32,"inputConnectorIDs":[623685],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623693":{"id":623693,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":160,"y":160,"width":32,"height":32,"inputConnectorIDs":[623684],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623692":{"id":623692,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1989138124,"x":480,"y":0,"width":32,"height":32,"inputConnectorIDs":[623683],"outputSuccessConnectorIDs":[623681],"outputFailureConnectorIDs":[623685],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load FileList"}}}},"visible":true},"4":{"slot":4,"name":"Azure Storage Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://${env_storage}/${ContainerName}/"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"8":{"slot":8,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILELIST"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAME"}}}},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSV"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUTO"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":true},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":true},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":true},"31":{"slot":31,"name":"Null If","elements":{},"visible":true},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"35":{"slot":35,"name":"Skip Blank Lines","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"36":{"slot":36,"name":"Replace Invalid Characters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"45":{"slot":45,"name":"Nest Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"46":{"slot":46,"name":"Null If","elements":{},"visible":false},"47":{"slot":47,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"50":{"slot":50,"name":"Null If","elements":{},"visible":false},"51":{"slot":51,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"66":{"slot":66,"name":"Null If","elements":{},"visible":false},"67":{"slot":67,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"70":{"slot":70,"name":"Null If","elements":{},"visible":false},"71":{"slot":71,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"126":{"slot":126,"name":"Match By Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}.${StageSchemaName}.FILELIST"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623695":{"id":623695,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[623682],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623694":{"id":623694,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":318,"y":156,"width":32,"height":32,"inputConnectorIDs":[623687],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"623681":{"id":623681,"sourceID":623692,"targetID":623689},"623680":{"id":623680,"sourceID":623691,"targetID":623688},"623683":{"id":623683,"sourceID":623688,"targetID":623692}},"failureConnectors":{"623685":{"id":623685,"sourceID":623692,"targetID":623690},"623684":{"id":623684,"sourceID":623691,"targetID":623693},"623687":{"id":623687,"sourceID":623688,"targetID":623694}},"unconditionalConnectors":{"623682":{"id":623682,"sourceID":623695,"targetID":623691}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"ContainerName":{"definition":{"name":"ContainerName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"wh-outbound-unzipped"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_KONTROLSYS_NO"}},"grids":{}},{"id":623686,"revision":2,"created":1616070345598,"timestamp":1616070345598,"components":{"623697":{"id":623697,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-480,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[623749],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623696":{"id":623696,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-320,"y":-16,"width":32,"height":32,"inputConnectorIDs":[623749],"outputSuccessConnectorIDs":[623746],"outputFailureConnectorIDs":[623750],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Restricted DeleteProcess List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\nSourceSystemId\t,\nStageDatabaseName\t,\nStageSchemaName\t,\nStageTableName\t,\nODSDatabaseName\t,\nODSSchemaName\t,\nODSTableName\t,\ntrim(SourceSystemName) SourceSystemName,\nIsRestricted,\nRestrictedColumnName,\nRestrictedTablename,\nExpressions\t\nfrom dw.control.sourcesystem_loadprocess3\nWHERE LOADPROCESS_ACTIVEFLAG=true \nAND sourcesystemid=${SourceSystemId}\nAND IsRestricted = 'TRUE'\nOrder by RestrictedTable_Rank desc\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DeleteProcess"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMNAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ISRESTRICTED"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDCOLUMNNAME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDTABLENAME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"EXPRESSIONS"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623699":{"id":623699,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":64,"y":-16,"width":32,"height":32,"inputConnectorIDs":[623747],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623698":{"id":623698,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-320,"y":160,"width":32,"height":32,"inputConnectorIDs":[623750],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623700":{"id":623700,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-128,"y":-16,"width":32,"height":16,"inputConnectorIDs":[623746],"outputSuccessConnectorIDs":[623747],"outputFailureConnectorIDs":[623748],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop sourcesystem parameter List -Stage"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DeleteProcess"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"StageDatabaseName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"StageSchemaName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"StageTableName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSystemName"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"IsRestricted"},"2":{"slot":2,"type":"STRING","value":"IsRestricted"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedTablename"},"2":{"slot":2,"type":"STRING","value":"RestrictedTablename"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedColumnName"},"2":{"slot":2,"type":"STRING","value":"RestrictedColumnName"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"Expressions"},"2":{"slot":2,"type":"STRING","value":"Expressions"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSchemaName"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[623705],"inputIterationConnectorIDs":[]},"623745":{"id":623745,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-128,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build Restricted Delete SQL"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0] FULL PULL\n###\n# RestrictedColumnName='C1,C2'\nif IsRestricted == 'true':\n    \tcmd = \" Delete from \"+StageDatabaseName+\".\"+StageSchemaName+\".\"+StageTableName +\" where \" +RestrictedColumnName + \" IN ( \"+ \\\n        Expressions +\")\"\n        print(cmd)\n    \tcursor = context.cursor()\n    \tcursor.execute(cmd)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[623705]},"623744":{"id":623744,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-128,"y":160,"width":32,"height":32,"inputConnectorIDs":[623748],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"623747":{"id":623747,"sourceID":623700,"targetID":623699},"623746":{"id":623746,"sourceID":623696,"targetID":623700}},"failureConnectors":{"623748":{"id":623748,"sourceID":623700,"targetID":623744},"623750":{"id":623750,"sourceID":623696,"targetID":623698}},"unconditionalConnectors":{"623749":{"id":623749,"sourceID":623697,"targetID":623696}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"623705":{"id":623705,"sourceID":623700,"targetID":623745}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"StageType":{"definition":{"name":"StageType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"FULL LOAD"},"Expressions":{"definition":{"name":"Expressions","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"SELECT CUSTOMER_ID from ODS_GRS_NO.DBO.CUSTOMER_RESTRICTED_DATA"},"IsRestricted":{"definition":{"name":"IsRestricted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"TRUE"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"CSVFileFormat":{"definition":{"name":"CSVFileFormat","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"KONTROLSYS_FileData_20.*"},"ContainerName":{"definition":{"name":"ContainerName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"wh-outbound-unzipped"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"3"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_KONTROLSYS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSchemaName":{"definition":{"name":"SourceSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceSystemName":{"definition":{"name":"SourceSystemName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"KONTROLSYS"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_KONTROLSYS_NO"},"RestrictedTablename":{"definition":{"name":"RestrictedTablename","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_RESTRICTED_DATA"},"RestrictedColumnName":{"definition":{"name":"RestrictedColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_ID"}},"grids":{"DeleteProcess":{"definition":{"name":"DeleteProcess","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"},{"name":"StageDatabaseName","type":"TEXT"},{"name":"StageSchemaName","type":"TEXT"},{"name":"StageTableName","type":"TEXT"},{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"},{"name":"SourceSystemName","type":"TEXT"},{"name":"IsRestricted","type":"TEXT"},{"name":"RestrictedColumnName","type":"TEXT"},{"name":"RestrictedTablename","type":"TEXT"},{"name":"Expressions","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},{"id":623704,"revision":2,"created":1616070345605,"timestamp":1616070345605,"components":{"623707":{"id":623707,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-560,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[623721],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623706":{"id":623706,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-96,"y":144,"width":32,"height":32,"inputConnectorIDs":[623723],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623709":{"id":623709,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-96,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFileLoad Stage Object Process"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFileStageODSLoadProcess"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ContainerName"},"2":{"slot":2,"type":"STRING","value":"${ContainerName}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFileName"},"2":{"slot":2,"type":"STRING","value":"${CSVFileName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageType"},"2":{"slot":2,"type":"STRING","value":"${StageType}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemName}"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"${LoadType}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[623722]},"623708":{"id":623708,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":128,"y":-16,"width":32,"height":32,"inputConnectorIDs":[623702],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623711":{"id":623711,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-352,"y":-16,"width":32,"height":32,"inputConnectorIDs":[623721],"outputSuccessConnectorIDs":[623703],"outputFailureConnectorIDs":[623720],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid FileList"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select \nFILENAME AS CSVFileName \nfrom STG_KONTROLSYS_NO.DBO.FILELIST\n--where FILENAME LIKE '${CSVFileFormat}'\n--Where regexp_like(FILENAME,'KONTROLSYS_Contract_20.*')\nWhere regexp_like(FILENAME,'${CSVFileFormat}')\nAND FILENAME NOT IN ('BaseFile_20201112_094847.csv')\norder by\nto_Number(split_part(split_part(FILENAME,'_',-3),'.',1)),\nto_Number(split_part(split_part(FILENAME,'_',-2),'.',1)),\nto_Number(split_part(split_part(FILENAME,'_',-1),'.',1))"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFileList"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFILENAME"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623710":{"id":623710,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-352,"y":144,"width":32,"height":32,"inputConnectorIDs":[623720],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"623701":{"id":623701,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-96,"y":-16,"width":32,"height":16,"inputConnectorIDs":[623703],"outputSuccessConnectorIDs":[623702],"outputFailureConnectorIDs":[623723],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSVFileList"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAME"},"2":{"slot":2,"type":"STRING","value":"CSVFileName"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[623722],"inputIterationConnectorIDs":[]}},"successConnectors":{"623703":{"id":623703,"sourceID":623711,"targetID":623701},"623702":{"id":623702,"sourceID":623701,"targetID":623708}},"failureConnectors":{"623720":{"id":623720,"sourceID":623711,"targetID":623710},"623723":{"id":623723,"sourceID":623701,"targetID":623706}},"unconditionalConnectors":{"623721":{"id":623721,"sourceID":623707,"targetID":623711}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"623722":{"id":623722,"sourceID":623701,"targetID":623709}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"StageType":{"definition":{"name":"StageType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"FULLLOAD"},"CSVFileName":{"definition":{"name":"CSVFileName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"KONTROLSYS_FileData_20"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"CSVFileFormat":{"definition":{"name":"CSVFileFormat","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"KONTROLSYS_FileData_20.*"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"3"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_KONTROLSYS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSchemaName":{"definition":{"name":"SourceSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceSystemName":{"definition":{"name":"SourceSystemName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"KONTROLSYS"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_KONTROLSYS_NO"}},"grids":{"CSVFileList":{"definition":{"name":"CSVFileList","scope":"BRANCH","definitions":[{"name":"FILENAME","type":"TEXT"}],"description":"CSVFileList","visibility":"PUBLIC"},"values":[]}}}],"transformationJobs":[],"variables":[{"name":"env_account","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_ContainerName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_monitor_email","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_name","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_password","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_sas_token","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_storage","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_username","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"}],"environments":[{"index":0,"name":"securitastest-west-europe MAT User","instanceCredentials":true,"credentialsName":"","awsCredentialsId":-1,"gcCredentialsId":-1,"azureCredentialsId":0,"schema":"BASE","encrypted":false,"url":"securitastest.west-europe.azure","port":"WH_DATA_LOAD","database":"AUDIT","driver":null,"user":"MATUSER","passwordName":"","passphraseName":"","role":"ACCOUNTADMIN","variables":{"env_ContainerName":"wh-outbound-unzipped","env_name":"DEV","env_monitor_email":"naresh.bawankar@securitas.com;santhosh.tm@securitas.com","env_password":"","env_username":"MATILLION_USER","env_account":"securitasdev.west-europe.azure","env_sas_token":"?sv=2019-07-07&ss=btqf&srt=sco&st=2020-09-25T15%3A33%3A33Z&se=2022-09-26T15%3A33%3A00Z&sp=rwdlacup&sig=9N6EITMw7l3ujhP7UrDq%2F7PQQ7K0mGj8usrIfpAWDro%3D","env_storage":"devwewhstore"},"defaultStorageLocation":"","concurrentConnections":4,"passwordType":"PASSWORD","connectionOptions":{},"defaultEnvironment":false}]}