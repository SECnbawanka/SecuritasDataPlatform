{"dbEnvironment":"snowflake","version":"1.46.7","jobsTree":{"id":70383,"name":"ROOT","children":[{"id":84078,"name":"GRS","children":[{"id":84081,"name":"Shared jobs","children":[{"id":84116,"name":"StageSystem","children":[],"jobs":[{"id":84119,"name":"StageSystem","description":"StageSystem","type":"ORCHESTRATION","tag":"30d3523c-87d8-41e5-a959-5032e3bd0e7d"},{"id":84143,"name":"StageObject","description":"Data Loads from Source system to Stage DB","type":"ORCHESTRATION","tag":"3318341d-86b8-4370-a0a2-1fddc21023c9"}]},{"id":84160,"name":"LoadSystem","children":[],"jobs":[{"id":84163,"name":"LoadSystem","description":"LoadSystem","type":"ORCHESTRATION","tag":"405af151-600d-4dec-bca0-0da400bef8a4"},{"id":84179,"name":"LoadObject_STG_ODS","description":"Stage_ODS_Object","type":"ORCHESTRATION","tag":"17616a52-131a-4846-a65c-4ba02c5d70a2"},{"id":84213,"name":"Load - Append","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"bfa10d17-ed44-4731-8faa-be46f01fe77d"},{"id":84221,"name":"Load - Difference","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"45c1d202-c2f5-478a-b876-bbf7236d4e4a"},{"id":84254,"name":"Load - DifferenceDelete","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"6a3410bc-530b-4f01-94f3-b1684406caa4"},{"id":84268,"name":"Load - Overwrite","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"8dacd9a5-448c-43ea-b425-0a5eb0b4ec8f"},{"id":84279,"name":"Load - Upsert","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"0e77207e-ab92-4a15-a0d2-1d07e6970d82"},{"id":84287,"name":"Initial Load - SCD","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"f8f87714-0477-4fc8-82f1-0fc915baba07"},{"id":84312,"name":"Load - SCD from STREAM","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"66d1ea18-d4ba-40a1-b018-86fc19ff3525"},{"id":84321,"name":"Logging","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"62db3212-eb2a-43e3-84d3-e9c23d5ae358"}]},{"id":84324,"name":"Laod_Template","children":[],"jobs":[{"id":84327,"name":"LOAD_TEMPLATE","description":"Unpacked from Shared Job [LOAD_TEMPLATE].","type":"ORCHESTRATION","tag":"60497c6c-f2fc-44a6-b5b4-9a33742cc045"}]}],"jobs":[{"id":84080,"name":"DW Key Processing","description":"Unpacked from Shared Job [DW Key Processing].","type":"ORCHESTRATION","tag":"23a987e8-afbb-4115-9341-2fa21d6a1d00"},{"id":84109,"name":"Restricted Data Load","description":"Restricted Excel Data to load into Global data platform","type":"ORCHESTRATION","tag":"016098ad-1b06-4250-aeb8-8b9081dd5656"}]}],"jobs":[]},{"id":84356,"name":"NETWORK_POLICY","children":[],"jobs":[{"id":84359,"name":"NETWORK_POLICY","description":null,"type":"ORCHESTRATION","tag":"9d870194-ecac-4d1e-8742-4669f7a7dba5"},{"id":84401,"name":"Load NETWORK_POLICY","description":"","type":"TRANSFORMATION","tag":"da8987eb-eb78-4920-9881-c991e87b3eae"}]},{"id":84435,"name":"Audit","children":[],"jobs":[{"id":84434,"name":"Matillion Log Export","description":null,"type":"ORCHESTRATION","tag":"087c698d-8d4c-45ba-be23-ca6e7f7b1e2e"},{"id":84500,"name":"Matillion_Detail","description":null,"type":"TRANSFORMATION","tag":"4797fc63-8e18-4aab-aa6e-9cdbb135c319"},{"id":84457,"name":"Matillion_Log","description":"","type":"TRANSFORMATION","tag":"1e11f676-aef2-474b-bbe0-a97214cc3ebd"},{"id":84475,"name":"Matillion_Summary","description":"","type":"TRANSFORMATION","tag":"00aef3e4-f77b-4a80-9285-58c85d9d5c0d"},{"id":84501,"name":"Send Alert","description":null,"type":"ORCHESTRATION","tag":"7c695c78-2d82-41a1-9d5d-ba757aca6d99"}]}],"jobs":[]},"orchestrationJobs":[{"id":84080,"revision":2,"created":1602243076945,"timestamp":1602243076945,"components":{"84087":{"id":84087,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":320,"y":-7,"width":32,"height":16,"inputConnectorIDs":[84094],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[84105],"outputUnconditionalConnectorIDs":[84101],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Iterate - Key Mapping"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"KeyMap"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[84106],"inputIterationConnectorIDs":[]},"84086":{"id":84086,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84103],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84089":{"id":84089,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":487,"y":-4,"width":32,"height":16,"inputConnectorIDs":[84101],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[84102],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Iterate - Key Object"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"KeyMap"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[84107],"inputIterationConnectorIDs":[]},"84088":{"id":84088,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":317,"y":-4,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Key Object"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nsf = context.cursor()\n\n# get ODS PK\n\n\ndef getodspk(database, schema, table):\n    try:\n        cmd = \"desc table \"+database+\".\"+schema+\".\"+table+\";\"\n        #print(\"DESC TABLE cmd:  \",cmd)\n        sf.execute(cmd)\n        PKCols = sf.fetchall()\n        PKColumns = [[c[0], ] for c in PKCols if c[5] == 'Y']\n    except:\n        PKColumns = []\n    return(PKColumns)\n\n# get KeyMap Columns\n\n\ndef getkm(database, schema, table):\n    try:\n        cmd = \"select coalesce(parent_keymap_id,keymap_id) as keymap, ARRAY_TO_STRING(column_name_list, ',') as column_name_list, coalesce(key_precedence,0) as key_precedence, dw_key_name, dw_column_name from dw.key.keymap where table_catalog=\\'\" + \\\n            database+\"\\' and table_schema=\\'\"+schema + \\\n            \"\\' and table_name=\\'\"+table+\"\\' order by 5 asc,3 asc;\"\n        #print(\"getkm cmd:  \",cmd)\n        sf.execute(cmd)\n        KM = sf.fetchall()\n        # print(type(KM))\n    except:\n        KM = []\n    return KM\n\n\nif __name__ == '__main__':\n    # set cmd sub-variables\n    FromList = \"FROM \"+ODSDatabaseName+\".\"+ODSSchemaName+\".\"+ODSTableName+\" src \"\n\n    # get ODS PK\n    PK = getodspk(ODSDatabaseName, ODSSchemaName, ODSTableName)\n    ODSColList = [\"src.\"+i[0] for i in PK]\n\n    # get KeyMap and build lists for mapped Source columns, DW columns with no precedence, DW columns with precedence, and Key table Joins\n    # Note that Jython interpreter seems to convert all numbers from the cursor to float; added the int() to convert back to integer\n    KM = getkm(ODSDatabaseName, ODSSchemaName, ODSTableName)\n    # print(KM)\n    SrcColList = []\n    Columns = []\n    Column_str = \"\"\n    for k in KM:\n        SrcColList = SrcColList+[\"src.\"+c for c in k[1].split(\",\")]\n    #print(\"SrcColList:  \", SrcColList)\n    \n    #Columns = [\"TO_VARCHAR(src.\"+c+\")\" for c in k[1].split(\",\")]\n    #Column_str = ', '.join(Columns)\n    #print(\"k[1].split \", k[1].split(\",\"))\n    #print(\"k:  \", k)\n    #print(\"Columns:  \",Columns)\n    \n    #vcList = [ \"TO_VARCHAR(\"+k+\")\" for k in k[1].split(\",\")]\n    #print(\"vcList:  \",vcList)\n    #vcList_str = ', '.join([\"TO_VARCHAR(\"+k+\")\" for k in k[1].split(\",\")])\n    \n    DWCP0List = [\"key_\"+str(int(k[0]))+\".\"+k[4] +\n                 \" as DW_\"+k[4]+\"\" for k in KM if k[2] == 0]\n    DWColList = [\"key_\"+str(int(k[0]))+\".\"+k[4]+\" as DW_\" +\n                 k[4]+\"_\"+str(int(k[2]))+\"\" for k in KM if k[2] != 0]\n    TabList = [\"LEFT OUTER JOIN \"+k[3]+\" key_\"+str(int(k[0]))+\" ON key_\"+str(int(k[0]))+\".keymap_id = \"+str(\n        int(k[0]))+\" AND key_\"+str(int(k[0]))+\".COLUMN_VALUE_LIST = ARRAY_CONSTRUCT(\"+', '.join([\"TO_VARCHAR(src.\"+x+\")\" for x in k[1].split(\",\")])+\") \" for k in KM]\n\n    # build Coalesced DW columns\n    DWCPList = list(set([k[4] for k in KM if k[2] != 0]))\n    COAList = \"\"\n\n    # Loop through the distinct DW columns with precedence to build the Coalesced DW columns\n    for i in DWCPList:\n        # print(i)\n        for k in KM:\n            if k[4] == i:\n                CPList = \"coalesce(\" if k[2] == 1 else CPList+\", \"\n                CPList = CPList+\"key_\"+str(int(k[0]))+\".\"+k[4]\n        CPList = CPList+\") as DW_\"+i\n        COAList = COAList+\", \"+CPList\n\n    # convert lists to strings\n    TabList = \"\".join(TabList)\n    SrcList = set(ODSColList+SrcColList)\n    CombList = list(SrcList)+DWCP0List+DWColList\n    ColList = \", \".join(CombList)\n    ColList = ColList+COAList if len(COAList) > 0 else ColList\n    FromList = FromList+\" \"+TabList\n    #print(ColList)\n    #print (FromList)\n    # Build View\n    cmd = \"create or replace view \"+ODSDatabaseName+\".\"+ODSSchemaName + \\\n        \".\"+ODSTableName+\"_KEY as (select \"+ColList+\" \"+FromList+\");\"\n    print(cmd)\n    try:\n        sf.execute(cmd)\n        RC = sf.fetchone()\n    except:\n        RC = \"Error creating view\"\n        raise Exception(RC)\n\n        # get SCD PK\n    SCDPK = getodspk(ODSDatabaseName, ODSSchemaName, ODSTableName+\"_SCD\")\n    if len(SCDPK) > 0:\n        # Build SCD View\n        FromList = \"FROM \"+ODSDatabaseName+\".\"+ODSSchemaName+\".\"+ODSTableName+\"_SCD src \"\n        cmd = \"create or replace view \"+ODSDatabaseName+\".\"+ODSSchemaName + \\\n            \".\"+ODSTableName+\"_SCD_KEY as (select \"+ColList+\", SCD_START_TIMESTAMP \"+FromList+\" \"+TabList+\");\"\n\n        print(cmd)\n        try:\n            sf.execute(cmd)\n            RC = sf.fetchone()\n        except:\n            RC = \"Error creating SCD view\"\n            raise Exception(RC)\n\n    print(\"RC:  \", RC)\n    # sf.close()\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"20"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[84107]},"84091":{"id":84091,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":176,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Key Mapping"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nsf = context.cursor()\n\n# get KeyMap Columns\n\n\ndef getkm(database, schema, table):\n    try:\n        cmd = \"select coalesce(parent_keymap_id,keymap_id) as keymap, coalesce(key_precedence,0) as key_precedence, dw_sequence_name, dw_key_name, dw_column_name, filter_criteria, array_to_string(column_name_list, ', ') from dw.key.keymap where table_catalog=\\'\" + \\\n            database+\"\\' and table_schema=\\'\"+schema + \\\n            \"\\' and table_name=\\'\"+table+\"\\' order by 5 asc, 2 asc;\"\n        print(\"getkm cmd:  \",cmd)\n        sf.execute(cmd)\n        KM = sf.fetchall()\n        #print(KM)\n    except:\n        KM = []\n    return KM\n\n\nif __name__ == '__main__':\n    # Verify Connection to SF\n    #    ver=sf_connected()\n    #    print(ver)\n\n    # get KeyMap and build lists for mapped Source columns, DW columns with no precedence, DW columns with precedence, and Key table Joins\n    KM = getkm(ODSDatabaseName, ODSSchemaName, ODSTableName)\n\n    # Loop through the distinct DW columns with precedence to build the Coalesced DW columns\n    for i in KM:\n        print(i)\n        KEYMAP_ID, KEY_PRECEDENCE, DW_SEQUENCE_NAME, DW_KEY_NAME, DW_COLUMN_NAME, FILTER_CRITERIA, COLUMN_NAME_LIST = i\n        Columns = [\"TRIM(src.\"+c+\")\" for c in COLUMN_NAME_LIST.split(\",\")]\n        # print(type(Columns))\n        # print(Columns)\n        Column_str = ', '.join(Columns)\n        ColList = \"CREATE OR REPLACE TEMPORARY TABLE \"+ODSDatabaseName+\".\"+ODSSchemaName+\".tmp_\"+ODSTableName + \\\n            \" AS SELECT DISTINCT src.ods_src_system_id, \" + \\\n            str(int(KEYMAP_ID))+\" as keymap_id, ARRAY_CONSTRUCT(\" + \\\n            Column_str+\") as column_value_list,  \"\n        FromList = \"FROM \"+ODSDatabaseName+\".\"+ODSSchemaName+\".\"+ODSTableName+\" src \"\n        WhereList = \"WHERE ARRAY_SIZE(ARRAY_CONSTRUCT(\" + \\\n            Column_str+\")) > 0 AND \"\n        if FILTER_CRITERIA != None:\n            WhereList = WhereList+\" \"+FILTER_CRITERIA+\" AND \"\n\n        if KEY_PRECEDENCE > 0:\n            # print(KEY_PRECEDENCE)\n\n            for j in KM:\n                # NOTE:  The next line is for the DW_COLUMN_NAME & the index starts at 0!!!!\n                if j[4] == i[4]:\n                    #print(j[4])\n                    #print(j)\n                    jKEYMAP_ID, jKEY_PRECEDENCE, jDW_SEQUENCE_NAME, jDW_KEY_NAME, jDW_COLUMN_NAME, jFILTER_CRITERIA, jCOLUMN_NAME_LIST = j\n                    if jKEY_PRECEDENCE == 1:\n                        coa = \"coalesce(key_\"+str(int(jKEY_PRECEDENCE)\n                                                  )+\".\"+DW_COLUMN_NAME+\"  \"\n                        #print(coa)\n                        FromList = FromList+\"LEFT OUTER JOIN \"+DW_KEY_NAME+\" key_\"+str(int(jKEY_PRECEDENCE))+\" ON key_\"+str(int(jKEY_PRECEDENCE))+\".keymap_id = \"+str(\n                            int(jKEYMAP_ID))+\" and key_\"+str(int(jKEY_PRECEDENCE))+\".column_value_list = ARRAY_CONSTRUCT(\"+Column_str+\") \"\n                    else:\n                        coa = coa+\", key_\" + \\\n                            str(int(jKEY_PRECEDENCE))+\".\"+DW_COLUMN_NAME\n                        #print(coa)\n                        FromList = FromList+\"LEFT OUTER JOIN \"+DW_KEY_NAME+\" key_\"+str(int(jKEY_PRECEDENCE))+\" ON key_\"+str(int(jKEY_PRECEDENCE))+\".keymap_id = \"+str(\n                            int(jKEYMAP_ID))+\" and key_\"+str(int(jKEY_PRECEDENCE))+\".column_value_list = ARRAY_CONSTRUCT(\"+Column_str+\") \"\n\n            ColList = ColList+\" \"+coa+\")\"\n            WhereList = WhereList+\" key_\" + \\\n                str(int(KEY_PRECEDENCE))+\".\"+DW_COLUMN_NAME\n\n        else:\n            ColList = ColList+\"key.\"+DW_COLUMN_NAME\n            FromList = FromList+\"LEFT OUTER JOIN \"+DW_KEY_NAME+\" key ON key.keymap_id = \" + \\\n                str(int(KEYMAP_ID)) + \\\n                \" and key.column_value_list = ARRAY_CONSTRUCT(\"+Column_str+\") \"\n            WhereList = WhereList+\"key.\"+DW_COLUMN_NAME\n\n        ColList = ColList+\" as \"+DW_COLUMN_NAME+\" \"\n        tmpcmd = ColList+FromList+WhereList+\" is null;\"\n        print(tmpcmd)\n\n        # Build Merge cmd\n        inscmd = \"INSERT ALL INTO \"+DW_KEY_NAME+\" (KEYMAP_ID, COLUMN_VALUE_LIST, \"+DW_COLUMN_NAME+\", DW_SRC_SYSTEM_ID) VALUES (keymap_id, COLUMN_VALUE_LIST, coalesce(\" + \\\n            DW_COLUMN_NAME+\",\"+DW_SEQUENCE_NAME+\".nextval), ods_src_system_id) SELECT * FROM \" + \\\n            ODSDatabaseName+\".\"+ODSSchemaName+\".tmp_\"+ODSTableName+\";\"\n        print(inscmd)\n\n        try:\n            sf.execute(tmpcmd)\n            tmpRC = sf.fetchone()\n        except:\n            tmpRC = \"error on temporary table\"\n            raise Exception (tmpRC)\n\n        try:\n            sf.execute(inscmd)\n            insRC = sf.fetchone()\n        except:\n            insRC = \"error on insert\"\n            raise Exception (insRC)\n\n        print(\"tmpRC:  \", tmpRC)\n        print(\"insRC:  \", insRC)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[84106]},"84090":{"id":84090,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":482,"y":163,"width":32,"height":32,"inputConnectorIDs":[84102],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84093":{"id":84093,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":161,"y":164,"width":32,"height":32,"inputConnectorIDs":[84104],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84092":{"id":84092,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":154,"y":5,"width":32,"height":32,"inputConnectorIDs":[84103],"outputSuccessConnectorIDs":[84094],"outputFailureConnectorIDs":[84104],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get KeyMap List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH x AS (\nSELECT \nggp.KEYMAP_ID AS ggp_keymap_id, ggp.TABLE_CATALOG AS ggp_table_catalog, ggp.TABLE_SCHEMA AS ggp_table_Schema, ggp.TABLE_NAME AS ggp_table_name,\ngp.KEYMAP_ID AS gp_keymap_id, gp.TABLE_CATALOG AS gp_table_catalog, gp.TABLE_SCHEMA AS gp_table_schema, gp.TABLE_NAME AS gp_table_name,\nprnt.KEYMAP_ID AS pr_keymap_id, prnt.TABLE_CATALOG AS pr_table_catalog, prnt.table_schema AS pr_table_schema, prnt.TABLE_NAME AS pr_table_name,\nKEY.keymap_id, KEY.TABLE_CATALOG, KEY.TABLE_SCHEMA, KEY.TABLE_NAME\nFROM dw.KEY.keymap key \nLEFT outer JOIN dw.KEY.keymap prnt\nON KEY.PARENT_KEYMAP_ID=prnt.KEYMAP_ID\nAND KEY.SRC_SYSTEM_ID = PRNT.SRC_SYSTEM_ID\nLEFT OUTER JOIN dw.KEY.keymap gp \nON prnt.TABLE_CATALOG=gp.TABLE_CATALOG\nAND prnt.TABLE_SCHEMA=gp.TABLE_SCHEMA\nAND prnt.TABLE_NAME=gp.TABLE_NAME\nAND key.SRC_SYSTEM_ID= gp.SRC_SYSTEM_ID\nLEFT outer JOIN dw.KEY.keymap ggp\nON gp.PARENT_KEYMAP_ID=ggp.KEYMAP_ID\nAND key.SRC_SYSTEM_ID = ggp.SRC_SYSTEM_ID\nWHERE KEY.SRC_SYSTEM_ID in (${SourceSystemId})\n),\n--use gp_table_catalog rather than ggp_table_catalog in order to return actual catalog, not universals\nggp AS (SELECT DISTINCT ggp_table_catalog AS table_catalog, ggp_TABLE_SCHEMA AS TABLE_SCHEMA, ggp_TABLE_NAME AS TABLE_NAME, ggp_KEYMAP_ID AS rank1, NULL AS rank2, NULL AS rank3, NULL AS rank4  FROM x WHERE ggp_KEYMAP_ID IS NOT NULL),\ngp AS (SELECT DISTINCT gp_table_catalog AS table_catalog, gp_TABLE_SCHEMA AS TABLE_SCHEMA, gp_TABLE_NAME AS TABLE_NAME, null AS rank1, gp_KEYMAP_ID AS rank2, NULL AS rank3, NULL AS rank4  FROM x WHERE gp_KEYMAP_ID IS NOT NULL),\nprnt AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, pr_KEYMAP_ID AS rank3, NULL AS rank4 FROM x WHERE KEYMAP_ID IS NOT NULL),\nKEY AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, null AS rank3, keymap_id AS rank4 FROM x WHERE KEYMAP_ID IS NOT NULL),\nun AS (SELECT * FROM ggp UNION SELECT * FROM gp UNION SELECT * FROM prnt UNION SELECT * FROM key),\nord AS (SELECT *, ROW_NUMBER() over(ORDER BY rank1, rank2, rank3, rank4) AS rnk FROM un)\nSELECT \nTABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, min(rnk) AS rnk\nFROM ord WHERE TABLE_CATALOG NOT LIKE '%UNIVERSAL%' \nGROUP BY TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME\nORDER BY rnk\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"KeyMap"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_CATALOG"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_SCHEMA"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_NAME"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84095":{"id":84095,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":320,"y":160,"width":32,"height":32,"inputConnectorIDs":[84105],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"84094":{"id":84094,"sourceID":84092,"targetID":84087}},"failureConnectors":{"84102":{"id":84102,"sourceID":84089,"targetID":84090},"84105":{"id":84105,"sourceID":84087,"targetID":84095},"84104":{"id":84104,"sourceID":84092,"targetID":84093}},"unconditionalConnectors":{"84101":{"id":84101,"sourceID":84087,"targetID":84089},"84103":{"id":84103,"sourceID":84086,"targetID":84092}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"84107":{"id":84107,"sourceID":84089,"targetID":84088},"84106":{"id":84106,"sourceID":84087,"targetID":84091}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84083":{"id":84083,"x":89,"y":-234,"width":143,"height":306,"text":"Changed to use this...\n\nWITH x AS (\nSELECT \nggp.KEYMAP_ID AS ggp_keymap_id, ggp.TABLE_CATALOG AS ggp_table_catalog, ggp.TABLE_SCHEMA AS ggp_table_Schema, ggp.TABLE_NAME AS ggp_table_name,\ngp.KEYMAP_ID AS gp_keymap_id, gp.TABLE_CATALOG AS gp_table_catalog, gp.TABLE_SCHEMA AS gp_table_schema, gp.TABLE_NAME AS gp_table_name,\nprnt.KEYMAP_ID AS pr_keymap_id, prnt.TABLE_CATALOG AS pr_table_catalog, prnt.table_schema AS pr_table_schema, prnt.TABLE_NAME AS pr_table_name,\nKEY.keymap_id, KEY.TABLE_CATALOG, KEY.TABLE_SCHEMA, KEY.TABLE_NAME\nFROM dw.KEY.keymap key \nLEFT outer JOIN dw.KEY.keymap prnt\nON KEY.PARENT_KEYMAP_ID=prnt.KEYMAP_ID\nAND KEY.SRC_SYSTEM_ID = PRNT.SRC_SYSTEM_ID\nLEFT OUTER JOIN dw.KEY.keymap gp \nON prnt.TABLE_CATALOG=gp.TABLE_CATALOG\nAND prnt.TABLE_SCHEMA=gp.TABLE_SCHEMA\nAND prnt.TABLE_NAME=gp.TABLE_NAME\nAND key.SRC_SYSTEM_ID= gp.SRC_SYSTEM_ID\nLEFT outer JOIN dw.KEY.keymap ggp\nON gp.PARENT_KEYMAP_ID=ggp.KEYMAP_ID\nAND key.SRC_SYSTEM_ID = ggp.SRC_SYSTEM_ID\nWHERE KEY.SRC_SYSTEM_ID in (61)\n),\n--use gp_table_catalog rather than ggp_table_catalog in order to return actual catalog, not universals\nggp AS (SELECT DISTINCT ggp_table_catalog AS table_catalog, ggp_TABLE_SCHEMA AS TABLE_SCHEMA, ggp_TABLE_NAME AS TABLE_NAME, ggp_KEYMAP_ID AS rank1, NULL AS rank2, NULL AS rank3, NULL AS rank4  FROM x WHERE ggp_KEYMAP_ID IS NOT NULL),\ngp AS (SELECT DISTINCT gp_table_catalog AS table_catalog, gp_TABLE_SCHEMA AS TABLE_SCHEMA, gp_TABLE_NAME AS TABLE_NAME, null AS rank1, gp_KEYMAP_ID AS rank2, NULL AS rank3, NULL AS rank4  FROM x WHERE gp_KEYMAP_ID IS NOT NULL),\nprnt AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, pr_KEYMAP_ID AS rank3, NULL AS rank4 FROM x WHERE KEYMAP_ID IS NOT NULL),\nKEY AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, null AS rank3, keymap_id AS rank4 FROM x WHERE KEYMAP_ID IS NOT NULL),\nun AS (SELECT * FROM ggp UNION SELECT * FROM gp UNION SELECT * FROM prnt UNION SELECT * FROM key),\nord AS (SELECT *, ROW_NUMBER() over(ORDER BY rank1, rank2, rank3, rank4) AS rnk FROM un)\nSELECT \nTABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, min(rnk) AS rnk\nFROM ord WHERE TABLE_CATALOG NOT LIKE '%UNIVERSAL%' \nGROUP BY TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME\nORDER BY rnk\n;\n","colour":"d60000"},"84082":{"id":84082,"x":729,"y":-311,"width":62,"height":460,"text":"WITH x AS (\nSELECT \nggp.KEYMAP_ID AS ggp_keymap_id, ggp.TABLE_CATALOG AS ggp_table_catalog, ggp.TABLE_SCHEMA AS ggp_table_Schema, ggp.TABLE_NAME AS ggp_table_name,\ngp.KEYMAP_ID AS gp_keymap_id, gp.TABLE_CATALOG AS gp_table_catalog, gp.TABLE_SCHEMA AS gp_table_schema, gp.TABLE_NAME AS gp_table_name,\nprnt.KEYMAP_ID AS pr_keymap_id, prnt.TABLE_CATALOG AS pr_table_catalog, prnt.table_schema AS pr_table_schema, prnt.TABLE_NAME AS pr_table_name,\nKEY.keymap_id, KEY.TABLE_CATALOG, KEY.TABLE_SCHEMA, KEY.TABLE_NAME\nFROM dw.KEY.keymap key \nLEFT outer JOIN dw.KEY.keymap prnt\nON KEY.PARENT_KEYMAP_ID=prnt.KEYMAP_ID\nLEFT OUTER JOIN dw.KEY.keymap gp \nON prnt.TABLE_CATALOG=gp.TABLE_CATALOG\nAND prnt.TABLE_SCHEMA=gp.TABLE_SCHEMA\nAND prnt.TABLE_NAME=gp.TABLE_NAME\nLEFT outer JOIN dw.KEY.keymap ggp\nON gp.PARENT_KEYMAP_ID=ggp.KEYMAP_ID\nWHERE KEY.SRC_SYSTEM_ID in (${SourceSystemId})\n),\n--use gp_table_catalog rather than ggp_table_catalog in order to return actual catalog, not universals\nggp AS (SELECT DISTINCT ggp_table_catalog AS table_catalog, ggp_TABLE_SCHEMA AS TABLE_SCHEMA, ggp_TABLE_NAME AS TABLE_NAME, ggp_KEYMAP_ID AS rank1, NULL AS rank2, NULL AS rank3  FROM x WHERE ggp_KEYMAP_ID IS NOT NULL),\ngp AS (SELECT DISTINCT gp_table_catalog AS table_catalog, gp_TABLE_SCHEMA AS TABLE_SCHEMA, gp_TABLE_NAME AS TABLE_NAME, null AS rank1, gp_KEYMAP_ID AS rank2, NULL AS rank3  FROM x WHERE gp_KEYMAP_ID IS NOT NULL),\nprnt AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, KEYMAP_ID AS rank3 FROM x WHERE KEYMAP_ID IS NOT NULL),\nun AS (SELECT * FROM ggp UNION SELECT * FROM gp UNION SELECT * FROM prnt),\nord AS (SELECT *, ROW_NUMBER() over(ORDER BY rank1, rank2) AS rnk FROM un)\nSELECT TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, min(rnk) \nFROM ord WHERE TABLE_CATALOG NOT LIKE '%UNIVERSAL%' GROUP BY TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME\nORDER BY 4","colour":"f9c21b"},"84085":{"id":84085,"x":649,"y":-314,"width":67,"height":466,"text":"Pass in SourceSystemId as a parameter.\n\nFIX!\n\nShould joins in this really be as...\n\nFROM dw.KEY.keymap key \nLEFT outer JOIN dw.KEY.keymap prnt\nON KEY.PARENT_KEYMAP_ID=prnt.KEYMAP_ID\nLEFT OUTER JOIN dw.KEY.KEYMAP gp \nON prnt.PARENT_KEYMAP_ID = gp.KEYMAP_ID\nLEFT outer JOIN dw.KEY.keymap ggp\nON gp.PARENT_KEYMAP_ID=ggp.KEYMAP_ID","colour":"f9c21b"},"84084":{"id":84084,"x":-395,"y":-76,"width":359,"height":164,"text":"**``CHANGE HISTORY``**\n\n20190725:  Changed to support composite source keys.  Requires many DDL changes...\nnew table DW.KEY.KEY_MAP\nAdditional column COLUMN_VALUE_LIST on KEY tables (plus COLUMN_VALUE & DATA_TYPE  as NULLABLE)\n20190726:  Added support for raise exceptions in Python code (BRR)\n20190821:  Added support for Key Objects on SCD objects (BRR)\n20200108:  Change the SQL for KeyMap List to eliminate redundancies.  (BRR)\n20200114:  Changed to add TO_VARCHAR to the Key Object definition (BRR)\n20200115:  Changed to correct TO_VARCHAR in Key Object.  (BRR)\n20200116:  Changed Key Object to properly handle composite value lists.  (BRR)","colour":"00ce4f"}},"variables":{"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"ODS_GRS_NO"}},"grids":{"KeyMap":{"definition":{"name":"KeyMap","scope":"BRANCH","definitions":[{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]}}},{"id":84109,"revision":2,"created":1602243076957,"timestamp":1602243076957,"components":{"84111":{"id":84111,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-336,"y":-48,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84114],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84110":{"id":84110,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1897708461,"x":-112,"y":-48,"width":32,"height":32,"inputConnectorIDs":[84114],"outputSuccessConnectorIDs":[84115],"outputFailureConnectorIDs":[84117],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Excel Query 0"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Customer"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"RowId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_SYSTEM_NAME"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT ..."}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_GRS_NO"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DBO"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_RESTRICTED_DATA"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"18":{"slot":18,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Excel"}}}},"visible":false},"400":{"slot":400,"name":"Storage URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://${env_storage}/restricted-data/restricteddata.xlsx"}}}},"visible":true},"401":{"slot":401,"name":"Cell Range","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"A1:B1048786"}}}},"visible":true},"402":{"slot":402,"name":"Contains Header Row","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"498":{"slot":498,"name":"Storage Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Azure Blob Storage"}}}},"visible":true},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake Managed"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84113":{"id":84113,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":167,"y":-50,"width":32,"height":32,"inputConnectorIDs":[84115],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84112":{"id":84112,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-112,"y":64,"width":32,"height":32,"inputConnectorIDs":[84117],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"84115":{"id":84115,"sourceID":84110,"targetID":84113}},"failureConnectors":{"84117":{"id":84117,"sourceID":84110,"targetID":84112}},"unconditionalConnectors":{"84114":{"id":84114,"sourceID":84111,"targetID":84110}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84108":{"id":84108,"x":-185,"y":-129,"width":237,"height":134,"text":"Pull the data from Excel Restricted Data into ODS and while processing in ODS ignore these data into Global data platform warehouse","colour":"e6e63c"}},"variables":{"SYSTEMNAME":{"definition":{"name":"SYSTEMNAME","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"GRS_NO"},"SchemaName":{"definition":{"name":"SchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CONTROL"},"DatabaseName":{"definition":{"name":"DatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DW"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"1"}},"grids":{}},{"id":84119,"revision":2,"created":1602243076966,"timestamp":1602243076966,"components":{"84118":{"id":84118,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-64,"y":160,"width":32,"height":32,"inputConnectorIDs":[84139],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84121":{"id":84121,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-64,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load_Source_Stage_Object"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"StageObject"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ContainerName"},"2":{"slot":2,"type":"STRING","value":"${ContainerName}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"${LoadType}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SourceConnectionString"},"2":{"slot":2,"type":"STRING","value":"${SourceConnectionString}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"SourceDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${SourceDatabaseName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SourceJDBCDriver"},"2":{"slot":2,"type":"STRING","value":"${SourceJDBCDriver}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"SourcePassword"},"2":{"slot":2,"type":"STRING","value":"${SourcePassword}"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSchemaName"},"2":{"slot":2,"type":"STRING","value":"${SourceSchemaName}"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"SourceTableName"},"2":{"slot":2,"type":"STRING","value":"${SourceTableName}"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"SourceUserID"},"2":{"slot":2,"type":"STRING","value":"${SourceUserID}"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"StageType"},"2":{"slot":2,"type":"STRING","value":"${StageType}"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"WatermarkColumnName"},"2":{"slot":2,"type":"STRING","value":"${WatermarkColumnName}"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"WatermarkDataType"},"2":{"slot":2,"type":"STRING","value":"${WatermarkDataType}"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"IsRestricted"},"2":{"slot":2,"type":"STRING","value":"${IsRestricted}"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedColumnName"},"2":{"slot":2,"type":"STRING","value":"${RestrictedColumnName}"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedTablename"},"2":{"slot":2,"type":"STRING","value":"${RestrictedTablename}"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"Source_sql"},"2":{"slot":2,"type":"STRING","value":"${Source_sql}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[84140]},"84120":{"id":84120,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-496,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84134],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84123":{"id":84123,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-256,"y":-16,"width":32,"height":32,"inputConnectorIDs":[84134],"outputSuccessConnectorIDs":[84135],"outputFailureConnectorIDs":[84138],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get LoadProcess List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\nSourceSystemId\t,\nSourceJDBCDriver\t,\nSourceConnectionString\t,\nsourceuserid,\nsourcepassword,\nSourceDatabaseName\t,\nSourceSchemaName\t,\nSourceTableName\t,\nStageType\t,\nStageDatabaseName\t,\nStageSchemaName\t,\nStageTableName\t,\nWatermarkColumnName\t,\nWatermarkDataType\t,\nWatermarkValue\t,\nODSDatabaseName\t,\nODSSchemaName\t,\nODSTableName\t,\nreplace(lower(StageDatabaseName),'_','-') as ContainerName,\ntrim(SourceSystemName) SourceSystemName,\nIsRestricted,\nRestrictedColumnName,\nRestrictedTablename,\nSource_Sql,\nExpressions\t\nfrom dw.control.sourcesystem_loadprocess3\nWHERE LOADPROCESS_ACTIVEFLAG=true \nAND STAGETYPE <> 'BYPASS'\nAND sourcesystemid=${SourceSystemId}\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadProcess"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCEJDBCDRIVER"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCECONNECTIONSTRING"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCEUSERID"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCEPASSWORD"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCEDATABASENAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESCHEMANAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCETABLENAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETYPE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"WATERMARKCOLUMNNAME"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"WATERMARKDATATYPE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"WATERMARKVALUE"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"CONTAINERNAME"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMNAME"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"ISRESTRICTED"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDCOLUMNNAME"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDTABLENAME"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_SQL"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"EXPRESSIONS"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84122":{"id":84122,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-64,"y":-16,"width":32,"height":16,"inputConnectorIDs":[84135],"outputSuccessConnectorIDs":[84133],"outputFailureConnectorIDs":[84139],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop sourcesystem parameter List - Stage"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadProcess"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SourceJDBCDriver"},"2":{"slot":2,"type":"STRING","value":"SourceJDBCDriver"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SourceConnectionString"},"2":{"slot":2,"type":"STRING","value":"SourceConnectionString"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SourceDatabaseName"},"2":{"slot":2,"type":"STRING","value":"SourceDatabaseName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSchemaName"},"2":{"slot":2,"type":"STRING","value":"SourceSchemaName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SourceTableName"},"2":{"slot":2,"type":"STRING","value":"SourceTableName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"StageType"},"2":{"slot":2,"type":"STRING","value":"StageType"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"StageDatabaseName"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"StageSchemaName"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"StageTableName"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"WatermarkColumnName"},"2":{"slot":2,"type":"STRING","value":"WatermarkColumnName"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"WatermarkDataType"},"2":{"slot":2,"type":"STRING","value":"WatermarkDataType"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"SourceUserid"},"2":{"slot":2,"type":"STRING","value":"SourceUserID"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"SourcePassword"},"2":{"slot":2,"type":"STRING","value":"SourcePassword"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"ContainerName"},"2":{"slot":2,"type":"STRING","value":"ContainerName"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSystemName"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"IsRestricted"},"2":{"slot":2,"type":"STRING","value":"IsRestricted"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedTablename"},"2":{"slot":2,"type":"STRING","value":"RestrictedTablename"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedColumnName"},"2":{"slot":2,"type":"STRING","value":"RestrictedColumnName"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"Source_sql"},"2":{"slot":2,"type":"STRING","value":"Source_sql"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[84140],"inputIterationConnectorIDs":[]},"84125":{"id":84125,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":592,"y":-16,"width":32,"height":32,"inputConnectorIDs":[84132],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84124":{"id":84124,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-256,"y":160,"width":32,"height":32,"inputConnectorIDs":[84138],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84127":{"id":84127,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":384,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build Restricted Delete SQL"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0] FULL PULL\n###\n# RestrictedColumnName='C1,C2'\nif IsRestricted == 'true':\n    \tcmd = \" Delete from \"+StageDatabaseName+\".\"+StageSchemaName+\".\"+StageTableName +\" where \" +RestrictedColumnName + \" IN ( \"+ \\\n        Expressions +\")\"\n        print(cmd)\n    \tcursor = context.cursor()\n    \tcursor.execute(cmd)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[84141]},"84126":{"id":84126,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":384,"y":160,"width":32,"height":32,"inputConnectorIDs":[84137],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84129":{"id":84129,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":384,"y":-16,"width":32,"height":16,"inputConnectorIDs":[84130],"outputSuccessConnectorIDs":[84132],"outputFailureConnectorIDs":[84137],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop sourcesystem parameter List -Stage"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Deleteprocess"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"StageDatabaseName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"StageSchemaName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"StageTableName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSystemName"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"IsRestricted"},"2":{"slot":2,"type":"STRING","value":"IsRestricted"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedTablename"},"2":{"slot":2,"type":"STRING","value":"RestrictedTablename"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedColumnName"},"2":{"slot":2,"type":"STRING","value":"RestrictedColumnName"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"Expressions"},"2":{"slot":2,"type":"STRING","value":"Expressions"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSchemaName"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[84141],"inputIterationConnectorIDs":[]},"84128":{"id":84128,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":176,"y":-16,"width":32,"height":32,"inputConnectorIDs":[84133],"outputSuccessConnectorIDs":[84130],"outputFailureConnectorIDs":[84136],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Restricted DeleteProcess List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\nSourceSystemId\t,\nStageDatabaseName\t,\nStageSchemaName\t,\nStageTableName\t,\nODSDatabaseName\t,\nODSSchemaName\t,\nODSTableName\t,\ntrim(SourceSystemName) SourceSystemName,\nIsRestricted,\nRestrictedColumnName,\nRestrictedTablename,\nExpressions\t\nfrom dw.control.sourcesystem_loadprocess3\nWHERE LOADPROCESS_ACTIVEFLAG=true \nAND STAGETYPE <> 'BYPASS'\nAND sourcesystemid=${SourceSystemId}\nAND IsRestricted = 'TRUE'\nOrder by RestrictedTable_Rank desc\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Deleteprocess"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMNAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ISRESTRICTED"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDCOLUMNNAME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDTABLENAME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"EXPRESSIONS"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84131":{"id":84131,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":176,"y":160,"width":32,"height":32,"inputConnectorIDs":[84136],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"84130":{"id":84130,"sourceID":84128,"targetID":84129},"84133":{"id":84133,"sourceID":84122,"targetID":84128},"84132":{"id":84132,"sourceID":84129,"targetID":84125},"84135":{"id":84135,"sourceID":84123,"targetID":84122}},"failureConnectors":{"84137":{"id":84137,"sourceID":84129,"targetID":84126},"84136":{"id":84136,"sourceID":84128,"targetID":84131},"84139":{"id":84139,"sourceID":84122,"targetID":84118},"84138":{"id":84138,"sourceID":84123,"targetID":84124}},"unconditionalConnectors":{"84134":{"id":84134,"sourceID":84120,"targetID":84123}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"84141":{"id":84141,"sourceID":84129,"targetID":84127},"84140":{"id":84140,"sourceID":84122,"targetID":84121}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"LoadType":{"definition":{"name":"LoadType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"APPEND"},"StageType":{"definition":{"name":"StageType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"INCREMENTAL"},"Source_sql":{"definition":{"name":"Source_sql","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"select * from"},"Expressions":{"definition":{"name":"Expressions","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"SELECT CUSTOMER_ID from ODS_GRS_NO.DBO.CUSTOMER_RESTRICTED_DATA"},"IsRestricted":{"definition":{"name":"IsRestricted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"TRUE"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"SourceUserID":{"definition":{"name":"SourceUserID","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"seu_dwloader"},"ContainerName":{"definition":{"name":"ContainerName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"stg_grs_norway"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourcePassword":{"definition":{"name":"SourcePassword","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS NO-bob"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"ODS_GRS_NO"},"SourceTableName":{"definition":{"name":"SourceTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceJDBCDriver":{"definition":{"name":"SourceJDBCDriver","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"SQL Server (Microsoft Driver)"},"SourceSchemaName":{"definition":{"name":"SourceSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceSystemName":{"definition":{"name":"SourceSystemName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS_NO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"STG_GRS_NO"},"WatermarkDataType":{"definition":{"name":"WatermarkDataType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"TIMESTAMP"},"SourceDatabaseName":{"definition":{"name":"SourceDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS_NO"},"RestrictedTablename":{"definition":{"name":"RestrictedTablename","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_RESTRICTED_DATA"},"WatermarkColumnName":{"definition":{"name":"WatermarkColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"INSERT_DATE"},"RestrictedColumnName":{"definition":{"name":"RestrictedColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_ID"},"SourceConnectionString":{"definition":{"name":"SourceConnectionString","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"jdbc:sqlserver://10.163.34.34\\GRS_NO:1433"}},"grids":{"LoadProcess":{"definition":{"name":"LoadProcess","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"},{"name":"SourceJDBCDriver","type":"TEXT"},{"name":"SourceConnectionString","type":"TEXT"},{"name":"SourceUserid","type":"TEXT"},{"name":"SourcePassword","type":"TEXT"},{"name":"SourceDatabaseName","type":"TEXT"},{"name":"SourceSchemaName","type":"TEXT"},{"name":"SourceTableName","type":"TEXT"},{"name":"StageType","type":"TEXT"},{"name":"StageDatabaseName","type":"TEXT"},{"name":"StageSchemaName","type":"TEXT"},{"name":"StageTableName","type":"TEXT"},{"name":"WatermarkColumnName","type":"TEXT"},{"name":"WatermarkDataType","type":"TEXT"},{"name":"WatermarkValue","type":"TEXT"},{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"},{"name":"ContainerName","type":"TEXT"},{"name":"SourceSystemName","type":"TEXT"},{"name":"IsRestricted","type":"TEXT"},{"name":"RestrictedColumnName","type":"TEXT"},{"name":"RestrictedTablename","type":"TEXT"},{"name":"Source_sql","type":"TEXT"},{"name":"Expressions","type":"TEXT"}],"description":"LoadProcess","visibility":"PRIVATE"},"values":[]},"Deleteprocess":{"definition":{"name":"Deleteprocess","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"},{"name":"StageDatabaseName","type":"TEXT"},{"name":"StageSchemaName","type":"TEXT"},{"name":"StageTableName","type":"TEXT"},{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"},{"name":"SourceSystemName","type":"TEXT"},{"name":"IsRestricted","type":"TEXT"},{"name":"RestrictedColumnName","type":"TEXT"},{"name":"RestrictedTablename","type":"TEXT"},{"name":"Expressions","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]}}},{"id":84143,"revision":2,"created":1602243076984,"timestamp":1602243076984,"components":{"84147":{"id":84147,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-352,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84156],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84146":{"id":84146,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":631604974,"x":-208,"y":0,"width":32,"height":32,"inputConnectorIDs":[84156],"outputSuccessConnectorIDs":[84154],"outputFailureConnectorIDs":[84158],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceJDBCDriver}"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceConnectionString}"}}}},"visible":true},"4":{"slot":4,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceUserID}"}}}},"visible":true},"5":{"slot":5,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${SourcePassword}"}}}},"visible":true},"6":{"slot":6,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"databaseName"},"2":{"slot":2,"type":"STRING","value":"${SourceDatabaseName}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"instanceName"},"2":{"slot":2,"type":"STRING","value":"${SourceSchemaName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"useSSL"},"2":{"slot":2,"type":"STRING","value":"true"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"requireSSL"},"2":{"slot":2,"type":"STRING","value":"false"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"verifyServerCertificate"},"2":{"slot":2,"type":"STRING","value":"false"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSchemaName}"}}}},"visible":true},"8":{"slot":8,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceTableName}"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"10":{"slot":10,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Size"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Precision"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Primary Key"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84149":{"id":84149,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-208,"y":144,"width":32,"height":32,"inputConnectorIDs":[84158],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84148":{"id":84148,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-28,"y":0,"width":32,"height":32,"inputConnectorIDs":[84154],"outputSuccessConnectorIDs":[84157],"outputFailureConnectorIDs":[84161],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build SQL"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport datetime\n\nprint StageType\nprint WatermarkDataType\nprint SourceJDBCDriver\n\nif StageType == 'INCREMENTAL':\n    cmd = \"select max(\"+WatermarkColumnName+\") from \" + \\\n        ODSDatabaseName+\".\"+ODSSchemaName+\".\"+ODSTableName\n    print(cmd)\n    cursor = context.cursor()\n    cursor.execute(cmd)\n    maxval = cursor.fetchone()\n    print(type(maxval[0]))\n    output = \"\"\n        #output = \"'\"+maxval[0].strftime(\"%Y-%m-%d %H:%M:%S.%f\") [:-3] + \"'\"\n      #output = \"'\"+maxval[0].strftime(\"%Y-%m-%d %H:%M:%S\")+ \"'\"\n    if type(maxval[0]) == datetime.datetime:\n        output = \"'\"+maxval[0].strftime(\"%Y-%m-%d %H:%M:%S.%f\") [:-3] + \"'\"\n    elif type(maxval[0]) == datetime.date:\n        output = \"'\"+maxval[0].strftime(\"%Y-%m-%d\")+\"'\"\n    elif type(maxval[0]) == datetime.time:\n        output = \"'\"+maxval[0].strftime(\"%H:%M:%S.%f\")+\"'\"\n    elif type(maxval[0]) == int:\n        output = \"'\"+str(maxval[0])+\"'\"\n    elif type(maxval[0]) == float:\n        output = \"'\"+str(maxval[0])+\"'\"\n    elif type(maxval[0]) == long:\n        output = \"'\"+str(maxval[0])+\"'\"\n    elif type(maxval[0]) == complex:\n        output = \"'\"+str(maxval[0])+\"'\"\n    elif maxval[0] == None:\n        if WatermarkDataType == \"TIMESTAMP\":\n            output = \"'1800-01-01 00:00:00'\"\n        else:\n          output = \"0\"\n\n    if \"ORACLE\" in SourceJDBCDriver.upper() and WatermarkDataType == \"TIMESTAMP\":\n        WatermarkLastValue = \"TO_TIMESTAMP(\"+output+\", 'YYYY-MM-DD HH24:MI:SS')\"\n    else:\n        WatermarkLastValue = output\n\n\n    context.updateVariable('WatermarkLastValue', WatermarkLastValue)\n    print(\"Type of WatermarkLastValue:  \",type(WatermarkLastValue))\n    print(\"WatermarkLastValue:  \", WatermarkLastValue)\n\n    context.updateGridVariable('SourceFilter', [[WatermarkColumnName,'Is','Greater than',WatermarkLastValue]])\n    \nelse:\n    print(\"NOT INCREMENTAL\")\n#    context.updateGridVariable('SourceFilter', [None,None,None,None])\n\n##Build SourceSQL Variable\n##SourceSQL=\"select * from \"+SourceSchemaName+\".\"+SourceTableName\nSourceSQL=Source_sql + \" \" + SourceSchemaName+\".\"+SourceTableName\nprint(\"Base SourceSQL: \", SourceSQL)\nif StageType == \"INCREMENTAL\" :\n  context.updateVariable(\"ExecuteSourceSQL\", SourceSQL+\" where \"+WatermarkColumnName+\" > \"+WatermarkLastValue)\n##print(\"SourceSQL:  \",SourceSQL)\n##print(\"SourceFilter:  \",context.getGridVariable('SourceFilter'))\n\n##print(\"STGColumns: \",context.getGridVariable('STGColumns'))\n\n\n##Build SourceSQL Variable for Restricted table data\n#var1 = if == \"INCREMENTAL\" then \"where\"\n#else \"and\"\n##if StageType == \"INCREMENTAL\" : \n##    var1 = \" and \"\n##else : \n##    var1 = \" where \" \n\n##if IsRestricted == \"TRUE\" :\n##  cmd = \"(select \"+RestrictedColumnName+\" from \" + ODSDatabaseName+\".\"+ODSSchemaName+\".\"+RestrictedTablename+\")\"\n##  context.updateVariable(\"SourceSQL\", SourceSQL+ var1 +RestrictedColumnName+\" NOT IN  \"+cmd)\nprint(\"SourceSQL:  \",SourceSQL)\nprint(\"ExecuteSourceSQL:  \",ExecuteSourceSQL)\nprint(\"SourceFilter:  \",context.getGridVariable('SourceFilter'))\n\nprint(\"STGColumns: \",context.getGridVariable('STGColumns'))"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84150":{"id":84150,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-32,"y":144,"width":32,"height":32,"inputConnectorIDs":[84161],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84151":{"id":84151,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":784,"y":0,"width":32,"height":32,"inputConnectorIDs":[84155],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84153":{"id":84153,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":400,"y":144,"width":32,"height":32,"inputConnectorIDs":[84159],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84152":{"id":84152,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":400,"y":0,"width":32,"height":32,"inputConnectorIDs":[84157],"outputSuccessConnectorIDs":[84155],"outputFailureConnectorIDs":[84159],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Extract & Stage Data"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceJDBCDriver}"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceConnectionString}"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceUserID}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tNqfz9SRvGZvdD4v"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ExecuteSourceSQL}"}}}},"visible":true},"9":{"slot":9,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"databaseName"},"2":{"slot":2,"type":"STRING","value":"${SourceDatabaseName}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"instanceName"},"2":{"slot":2,"type":"STRING","value":"${SourceSchemaName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"useSSL"},"2":{"slot":2,"type":"STRING","value":"true"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"requireSSL"},"2":{"slot":2,"type":"STRING","value":"false"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"verifyServerCertificate"},"2":{"slot":2,"type":"STRING","value":"false"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"zeroDateTimeBehavior"},"2":{"slot":2,"type":"STRING","value":"convertToNull"}}}},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":false},"13":{"slot":13,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"14":{"slot":14,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageTableName}"}}}},"visible":true},"15":{"slot":15,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"16":{"slot":16,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"17":{"slot":17,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"101":{"slot":101,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"102":{"slot":102,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"103":{"slot":103,"name":"Data Selection","elements":{},"visible":false},"104":{"slot":104,"name":"Data Source Filter","elements":{},"visible":false},"105":{"slot":105,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"106":{"slot":106,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake Managed"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"84155":{"id":84155,"sourceID":84152,"targetID":84151},"84154":{"id":84154,"sourceID":84146,"targetID":84148},"84157":{"id":84157,"sourceID":84148,"targetID":84152}},"failureConnectors":{"84161":{"id":84161,"sourceID":84148,"targetID":84150},"84159":{"id":84159,"sourceID":84152,"targetID":84153},"84158":{"id":84158,"sourceID":84146,"targetID":84149}},"unconditionalConnectors":{"84156":{"id":84156,"sourceID":84147,"targetID":84146}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84142":{"id":84142,"x":-739,"y":-127,"width":301,"height":469,"text":"``Required Variables`` \n\nODSDatabaseName\nODSSchemaName\nODSTableName\nSourceConnectionString\nSourceDatabaseName\nSourceJDBCDriver\nSourcePassword\nSourceSchemaName\nSourceSQL\nSourceTableName\nSourceUserName\nStageType\nSTGDatabaseName\nSTGSchemaName\nSTGTableName\nWatermarkColumnName\nWatermarkDataType\nWatermarkLastValue\n\n``Required Grid Variables``\n1) Source Filter:\nInput_Column\nQualifier\nComparator\nValue\n2) STGColumn\nName\nType\nSize\nPrecision\nPrimary_Key","colour":"e6e63c"},"84145":{"id":84145,"x":-98,"y":-47,"width":252,"height":110,"text":"Pull Incremental data based on the Watermark columns as mention in metadata","colour":"e6e63c"},"84144":{"id":84144,"x":182,"y":-122,"width":498,"height":223,"text":"Snowflake managed the Stage area where data loads (Truncate and Load) from SRC to STG \n\nThis component is potentially destructive. If the target table undergoes a change in structure, it will be recreated. Otherwise, the target table is truncated. Setting the Load Option Recreate Target Table to \"Off\" will prevent both recreation and truncation. Do not modify the target table structure manually.\n\n","colour":"e6e63c"}},"variables":{"LoadType":{"definition":{"name":"LoadType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"APPEND"},"StageType":{"definition":{"name":"StageType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"INCREMENTAL"},"Source_sql":{"definition":{"name":"Source_sql","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"Select * from"},"IsRestricted":{"definition":{"name":"IsRestricted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"TRUE"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"SourceUserID":{"definition":{"name":"SourceUserID","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"seu_dwloader"},"ContainerName":{"definition":{"name":"ContainerName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"stg_grs_norway"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourcePassword":{"definition":{"name":"SourcePassword","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"GRS NO-bob"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"TEXT","scope":"BRANCH","description":"1","visibility":"PUBLIC"},"value":"2"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"SourceTableName":{"definition":{"name":"SourceTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"ExecuteSourceSQL":{"definition":{"name":"ExecuteSourceSQL","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"select * from ${SourceSchemaName}.${SourceTableName}"},"SourceJDBCDriver":{"definition":{"name":"SourceJDBCDriver","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"SQL Server (Microsoft Driver)"},"SourceSchemaName":{"definition":{"name":"SourceSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemName":{"definition":{"name":"SourceSystemName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS_NO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"},"WatermarkDataType":{"definition":{"name":"WatermarkDataType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"TIMESTAMP"},"SourceDatabaseName":{"definition":{"name":"SourceDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"GRS_NO"},"WatermarkLastValue":{"definition":{"name":"WatermarkLastValue","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"'1800-01-01 00:00:00'"},"RestrictedTablename":{"definition":{"name":"RestrictedTablename","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_RESTRICTED_DATA"},"WatermarkColumnName":{"definition":{"name":"WatermarkColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CHANGE_DATE"},"RestrictedColumnName":{"definition":{"name":"RestrictedColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID"},"SourceConnectionString":{"definition":{"name":"SourceConnectionString","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"jdbc:sqlserver://10.163.34.34\\GRS_NO:1433"}},"grids":{"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Primary_Key","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"SourceFilter":{"definition":{"name":"SourceFilter","scope":"BRANCH","definitions":[{"name":"Input_Column","type":"TEXT"},{"name":"Qualifier","type":"TEXT"},{"name":"Comparator","type":"TEXT"},{"name":"Value","type":"TEXT"}],"description":"SourceFilter","visibility":"PRIVATE"},"values":[]}}},{"id":84163,"revision":2,"created":1602243076995,"timestamp":1602243076995,"components":{"84164":{"id":84164,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-576,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84175],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84167":{"id":84167,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-416,"y":-16,"width":32,"height":32,"inputConnectorIDs":[84175],"outputSuccessConnectorIDs":[84173],"outputFailureConnectorIDs":[84174],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get LoadProcess List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select Distinct\nSOURCESYSTEMID,\nSTAGEDATABASENAME,\nSTAGESCHEMANAME,\nSTAGETABLENAME,\nODSDATABASENAME,\nODSSCHEMANAME,\nODSTABLENAME,\nSOURCESYSTEM_ACTIVEFLAG,\nLOADTYPE,\nCOLUMNLISTEXP\nfrom dw.control.sourcesystem_loadprocess3\nwhere sourcesystem_activeflag=TRUE\nand loadprocess_activeflag=TRUE\nand sourcesystemid=${SourceSystemId}\nand COLUMNLISTEXP is not null"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ObjectList"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"LOADTYPE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMNLISTEXP"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84166":{"id":84166,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-160,"y":-16,"width":32,"height":16,"inputConnectorIDs":[84173],"outputSuccessConnectorIDs":[84172],"outputFailureConnectorIDs":[84177],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop Stg system parameter List - Ods"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ObjectList"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"},"2":{"slot":2,"type":"STRING","value":"StageDatabaseName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"},"2":{"slot":2,"type":"STRING","value":"StageSchemaName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"},"2":{"slot":2,"type":"STRING","value":"StageTableName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"LOADTYPE"},"2":{"slot":2,"type":"STRING","value":"LoadType"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMNLISTEXP"},"2":{"slot":2,"type":"STRING","value":"ColumnListExp"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[84176],"inputIterationConnectorIDs":[]},"84169":{"id":84169,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":128,"y":-16,"width":32,"height":32,"inputConnectorIDs":[84172],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84168":{"id":84168,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-416,"y":160,"width":32,"height":32,"inputConnectorIDs":[84174],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84171":{"id":84171,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-160,"y":160,"width":32,"height":32,"inputConnectorIDs":[84177],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84170":{"id":84170,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-160,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load_Stage_ODS_Object"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadObject_STG_ODS"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"${LoadType}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[84176]}},"successConnectors":{"84173":{"id":84173,"sourceID":84167,"targetID":84166},"84172":{"id":84172,"sourceID":84166,"targetID":84169}},"failureConnectors":{"84177":{"id":84177,"sourceID":84166,"targetID":84171},"84174":{"id":84174,"sourceID":84167,"targetID":84168}},"unconditionalConnectors":{"84175":{"id":84175,"sourceID":84164,"targetID":84167}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"84176":{"id":84176,"sourceID":84166,"targetID":84170}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84162":{"id":84162,"x":-908,"y":-88,"width":292,"height":204,"text":"``Required Variables`` \n(Text\tCopied\tPrivate) excluding the  SourceSystemId\t\n\nODSDatabaseName\nODSSchemaName\nODSTableName\nSourceSystemId\nSourceUserId\nSTGDatabaseName\nSTGSchemaName\nSTGTableName\n\n``Required Grid Variables``\nObjectList (Column Names)\nSOURCESYSTEMID\nSTAGEDATABASENAME\nSTAGESCHEMANAME\nSTAGETABLENAME\nODSDATABASENAME\nODSSCHEMANAME\nODSTABLENAME\nLOADTYPE","colour":"e6e63c"},"84165":{"id":84165,"x":-326,"y":-108,"width":340,"height":202,"text":" ``Grid Iterator Loop Stg system parameter List - Ods  ``\n\nSOURCESYSTEMID\nSTAGEDATABASENAME\nSTAGESCHEMANAME\nSTAGETABLENAME\nODSDATABASENAME\nODSSCHEMANAME\nODSTABLENAME\nLOADTYPE\n","colour":"e6e63c"}},"variables":{"LoadType":{"definition":{"name":"LoadType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"UPSERT"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"SourceUserId":{"definition":{"name":"SourceUserId","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS_NO"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"STG_GRS_NO"}},"grids":{"ObjectList":{"definition":{"name":"ObjectList","scope":"BRANCH","definitions":[{"name":"SOURCESYSTEMID","type":"DECIMAL"},{"name":"STAGEDATABASENAME","type":"TEXT"},{"name":"STAGESCHEMANAME","type":"TEXT"},{"name":"STAGETABLENAME","type":"TEXT"},{"name":"ODSDATABASENAME","type":"TEXT"},{"name":"ODSSCHEMANAME","type":"TEXT"},{"name":"ODSTABLENAME","type":"TEXT"},{"name":"LOADTYPE","type":"TEXT"},{"name":"COLUMNLISTEXP","type":"TEXT"}],"description":"ObjectList","visibility":"PRIVATE"},"values":[]}}},{"id":84179,"revision":2,"created":1602243077009,"timestamp":1602243077009,"components":{"84178":{"id":84178,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1280,"y":-256,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84201],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84181":{"id":84181,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":356330947,"x":-1104,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84201],"outputSuccessConnectorIDs":[84243],"outputFailureConnectorIDs":[84210],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"5":{"slot":5,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"6":{"slot":6,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Database Type"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Size"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Precision"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Default Value"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"Not Null"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"Unique"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"Primary Key"}}}},"visible":true},"7":{"slot":7,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84180":{"id":84180,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-1104,"y":-96,"width":32,"height":32,"inputConnectorIDs":[84210],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84183":{"id":84183,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1395699082,"x":-944,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84243],"outputSuccessConnectorIDs":[84242],"outputFailureConnectorIDs":[84202],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove Audit Fields"}}}},"visible":true},"2":{"slot":2,"name":"Target Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"3":{"slot":3,"name":"Key Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}}},"visible":true},"4":{"slot":4,"name":"Operation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Not In"}}}},"visible":true},"5":{"slot":5,"name":"Fixed/Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fixed"}}}},"visible":true},"6":{"slot":6,"name":"Values Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"}}}},"visible":true},"7":{"slot":7,"name":"Source Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":false},"8":{"slot":8,"name":"Key Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMN_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DATA_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LENGTH"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PK"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84182":{"id":84182,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-944,"y":-96,"width":32,"height":32,"inputConnectorIDs":[84202],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84185":{"id":84185,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-369209785,"x":-784,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84242],"outputSuccessConnectorIDs":[84233],"outputFailureConnectorIDs":[84205],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"2":{"slot":2,"name":"Target Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"3":{"slot":3,"name":"Fixed/Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid"}}}},"visible":true},"4":{"slot":4,"name":"Values Grid","elements":{},"visible":false},"5":{"slot":5,"name":"Source Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"6":{"slot":6,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Database_Type"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Size"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Precision"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Default_Value"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"Not_Null"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"Unique"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"Primary_Key"}}}},"visible":true},"7":{"slot":7,"name":"Append/Prepend","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84184":{"id":84184,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-784,"y":-96,"width":32,"height":32,"inputConnectorIDs":[84205],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84187":{"id":84187,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-672,"y":-96,"width":32,"height":32,"inputConnectorIDs":[84206],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84186":{"id":84186,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1395699082,"x":-608,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84233],"outputSuccessConnectorIDs":[84240,84245,84235],"outputFailureConnectorIDs":[84206],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns Remove Audit Fields"}}}},"visible":true},"2":{"slot":2,"name":"Target Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"3":{"slot":3,"name":"Key Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}}},"visible":true},"4":{"slot":4,"name":"Operation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Not In"}}}},"visible":true},"5":{"slot":5,"name":"Fixed/Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fixed"}}}},"visible":true},"6":{"slot":6,"name":"Values Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}}},"visible":true},"7":{"slot":7,"name":"Source Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":false},"8":{"slot":8,"name":"Key Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMN_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DATA_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LENGTH"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PK"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84189":{"id":84189,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-464,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84240],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[84247],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If APPEND"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"APPEND"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84188":{"id":84188,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-304,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84247],"outputSuccessConnectorIDs":[84237],"outputFailureConnectorIDs":[84208],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Append"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Append"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{"2":{"slot":2,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}},"3":{"slot":3,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84191":{"id":84191,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-304,"y":-160,"width":32,"height":32,"inputConnectorIDs":[84208],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 4"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84190":{"id":84190,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":592,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84230,84232,84234,84237],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84250],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84193":{"id":84193,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":880,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84241],"outputSuccessConnectorIDs":[84236],"outputFailureConnectorIDs":[84211],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Logging"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Logging"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ProcessType"},"2":{"slot":2,"type":"STRING","value":"LOAD"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"RunResult"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Command"},"2":{"slot":2,"type":"STRING","value":"LOAD - ${LoadType}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84192":{"id":84192,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":1152,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84236],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84195":{"id":84195,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":1152,"y":-176,"width":32,"height":32,"inputConnectorIDs":[84211],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84194":{"id":84194,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-448,"y":-48,"width":32,"height":32,"inputConnectorIDs":[84245],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[84249],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If OVERWRITE"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"OVERWRITE"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84197":{"id":84197,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-304,"y":-48,"width":32,"height":32,"inputConnectorIDs":[84249],"outputSuccessConnectorIDs":[84230],"outputFailureConnectorIDs":[84209],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Overwrite"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Overwrite"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{"2":{"slot":2,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}},"3":{"slot":3,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84196":{"id":84196,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-80,"y":-48,"width":32,"height":32,"inputConnectorIDs":[84209],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 5"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84199":{"id":84199,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-608,"y":96,"width":32,"height":32,"inputConnectorIDs":[84235],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[84244],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If DIFFERENCE or DIFFERENCEDELETE or UPSERT or SCD"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"UPSERT"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"DIFFERENCEDELETE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"DIFFERENCE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"SCD"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84198":{"id":84198,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-352,"y":96,"width":32,"height":32,"inputConnectorIDs":[84244],"outputSuccessConnectorIDs":[84239,84238],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PK Grid Variable"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n##access Hashcolumnlist Grid Variable\n\n#v_Hashcolumnlist=context.getGridVariable('Hashcolumnlist')\n#print(\"v_Hashcolumnlist:  \",v_Hashcolumnlist)\n\n##access ColumnListExp Grid Variable\nv_ColumnListExp=context.getGridVariable('ColumnListExp')\nprint(\"v_ColumnListExp:  \",v_ColumnListExp)\n\n##access ODSColumns Grid Variable\nv_ODSColumns=context.getGridVariable('ODSColumns')\nprint(\"v_ODSColumns:  \",v_ODSColumns)\n\n## Build PKColumns Grid Variable\nPKColumns=[[c[0],] for c in v_ODSColumns if c[8] =='Yes']\ncontext.updateGridVariable('PKColumns', PKColumns)\nprint(\"PKColumns:  \",context.getGridVariable('PKColumns'))\n\n## Build PKColumns\nPKColumnsList=[\"\\\"tgt\\\".\\\"\"+c[0]+\"\\\"=\\\"src\\\".\\\"\"+c[0]+\"\\\"\" for c in v_ODSColumns if c[8] =='Yes']\nPKMatch=\" and \".join(PKColumnsList) if len(PKColumnsList) > 0 else \"\"\ncontext.updateVariable('PKMatch', PKMatch)\nprint(\"PKMatch:  \",PKMatch)\n\n## Build PKMatch Variable\nPKLister=[\"\\\"\"+c[0]+\"\\\"\" for c in v_ODSColumns if c[8] =='Yes']\nPKList=\", \".join(PKLister) if len(PKLister) > 0 else \"\"\ncontext.updateVariable('PKList', PKList)\nprint(\"PKList:  \",PKList)\n\n## Build CompareColumns\nCompareColumnsList=[[c[0], \"\\\"compare_\"+c[0]+\"\\\"\",] for c in v_ODSColumns if (c[8] == 'No' and c[0] != 'ODS_SRC_SYSTEM_ID' and c[0] != 'ODS_MODIFIEDBY' and c[0] != 'ODS_MODIFIEDBY_TIMESTAMP')]\ncontext.updateGridVariable('CompareColumns', CompareColumnsList)\nprint(\"CompareColumns:  \",context.getGridVariable('CompareColumns'))\n\n##Build CompareList\nCCList=[\"EQUAL_NULL(\\\"tgt\\\".\\\"\"+c[0]+\"\\\",\\\"src\\\".\\\"\"+c[0]+\"\\\") = FALSE\" for c in v_ODSColumns if (c[8] == 'No' and c[0] != 'ODS_SRC_SYSTEM_ID' and c[0] != 'ODS_MODIFIEDBY' and c[0] != 'ODS_MODIFIEDBY_TIMESTAMP')]\nCompareList=\" or \".join(CCList) if len(CCList) > 0 else \"\"\ncontext.updateVariable('CompareList', CompareList)\nprint(\"CompareList:  \",CompareList)\n\n##Build OtherList\nOtherLister=[\"\\\"\"+c[0]+\"\\\"\" for c in v_ODSColumns if (c[8] == 'No' and c[0] != 'ODS_SRC_SYSTEM_ID' and c[0] != 'ODS_MODIFIEDBY' and c[0] != 'ODS_MODIFIEDBY_TIMESTAMP')]\nOtherColumns=\", \".join(OtherLister) if len(OtherLister) > 0 else \"\"\ncontext.updateVariable('OtherColumns', OtherColumns)\nprint(\"OtherColumns:  \", OtherColumns)\n\n#End\n#quit()"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84200":{"id":84200,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-128,"y":64,"width":32,"height":32,"inputConnectorIDs":[84239],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[84246],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If UPSERT"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"UPSERT"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84225":{"id":84225,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":96,"y":64,"width":32,"height":32,"inputConnectorIDs":[84246],"outputSuccessConnectorIDs":[84232],"outputFailureConnectorIDs":[84204],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Upsert"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Upsert"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"PKMatch"},"2":{"slot":2,"type":"STRING","value":"${PKMatch}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{"2":{"slot":2,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}},"3":{"slot":3,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84224":{"id":84224,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":336,"y":64,"width":32,"height":32,"inputConnectorIDs":[84204],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure  6"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84227":{"id":84227,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-128,"y":176,"width":32,"height":32,"inputConnectorIDs":[84238],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[84248],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If DIFFERENCE"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"DIFFERENCE"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84226":{"id":84226,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":112,"y":176,"width":32,"height":32,"inputConnectorIDs":[84248],"outputSuccessConnectorIDs":[84234],"outputFailureConnectorIDs":[84203],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Difference"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Difference"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"PKMatch"},"2":{"slot":2,"type":"STRING","value":"${PKMatch}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"CompareList"},"2":{"slot":2,"type":"STRING","value":"${CompareList}"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{"2":{"slot":2,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}},"3":{"slot":3,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84229":{"id":84229,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":336,"y":176,"width":32,"height":32,"inputConnectorIDs":[84203],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 8"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84228":{"id":84228,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":736,"y":-256,"width":32,"height":32,"inputConnectorIDs":[84250],"outputSuccessConnectorIDs":[84241],"outputFailureConnectorIDs":[84207],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build STG Clean SQL"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0] FULL PULL\n###\nif StageTableName is not None:\n    \tcmd = \" Truncate table \"+StageDatabaseName+\".\"+StageSchemaName+\".\"+StageTableName \n        print(cmd)\n    \tcursor = context.cursor()\n    \tcursor.execute(cmd)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84231":{"id":84231,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":736,"y":-112,"width":32,"height":32,"inputConnectorIDs":[84207],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure  7"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"84230":{"id":84230,"sourceID":84197,"targetID":84190},"84233":{"id":84233,"sourceID":84185,"targetID":84186},"84232":{"id":84232,"sourceID":84225,"targetID":84190},"84235":{"id":84235,"sourceID":84186,"targetID":84199},"84234":{"id":84234,"sourceID":84226,"targetID":84190},"84237":{"id":84237,"sourceID":84188,"targetID":84190},"84236":{"id":84236,"sourceID":84193,"targetID":84192},"84239":{"id":84239,"sourceID":84198,"targetID":84200},"84238":{"id":84238,"sourceID":84198,"targetID":84227},"84241":{"id":84241,"sourceID":84228,"targetID":84193},"84240":{"id":84240,"sourceID":84186,"targetID":84189},"84243":{"id":84243,"sourceID":84181,"targetID":84183},"84242":{"id":84242,"sourceID":84183,"targetID":84185},"84245":{"id":84245,"sourceID":84186,"targetID":84194}},"failureConnectors":{"84209":{"id":84209,"sourceID":84197,"targetID":84196},"84208":{"id":84208,"sourceID":84188,"targetID":84191},"84211":{"id":84211,"sourceID":84193,"targetID":84195},"84210":{"id":84210,"sourceID":84181,"targetID":84180},"84203":{"id":84203,"sourceID":84226,"targetID":84229},"84202":{"id":84202,"sourceID":84183,"targetID":84182},"84205":{"id":84205,"sourceID":84185,"targetID":84184},"84204":{"id":84204,"sourceID":84225,"targetID":84224},"84207":{"id":84207,"sourceID":84228,"targetID":84231},"84206":{"id":84206,"sourceID":84186,"targetID":84187}},"unconditionalConnectors":{"84201":{"id":84201,"sourceID":84178,"targetID":84181},"84250":{"id":84250,"sourceID":84190,"targetID":84228}},"trueConnectors":{"84244":{"id":84244,"sourceID":84199,"targetID":84198},"84247":{"id":84247,"sourceID":84189,"targetID":84188},"84246":{"id":84246,"sourceID":84200,"targetID":84225},"84249":{"id":84249,"sourceID":84194,"targetID":84197},"84248":{"id":84248,"sourceID":84227,"targetID":84226}},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"PKList":{"definition":{"name":"PKList","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"PK_CUSTOMER"},"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"\"tgt\".\"CUSTOMER_ID\"=\"src\".\"CUSTOMER_ID\""},"LoadType":{"definition":{"name":"LoadType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"UPSERT"},"ClusterKey":{"definition":{"name":"ClusterKey","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":""},"CompareList":{"definition":{"name":"CompareList","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_ID"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"OtherColumns":{"definition":{"name":"OtherColumns","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_ID"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"Constraint_Name":{"definition":{"name":"Constraint_Name","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"PK_CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"Table_Recreated":{"definition":{"name":"Table_Recreated","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"False"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"PKColumns":{"definition":{"name":"PKColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["CUSTOMER_ID"]}]},"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Database_Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Default_Value","type":"TEXT"},{"name":"Not_Null","type":"TEXT"},{"name":"Unique","type":"TEXT"},{"name":"Primary_Key","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["CUSTOMER_ID","","","","","","","",""]}]},"SCDColumns":{"definition":{"name":"SCDColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Database_Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Default_Value","type":"TEXT"},{"name":"Not_Null","type":"TEXT"},{"name":"Unique","type":"TEXT"},{"name":"Primary_Key","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Database_Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Default_Value","type":"TEXT"},{"name":"Not_Null","type":"TEXT"},{"name":"Unique","type":"TEXT"},{"name":"Primary_Key","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["CUSTOMER_ID","","","","","","","",""]}]},"Constraints":{"definition":{"name":"Constraints","scope":"BRANCH","definitions":[{"name":"constraint_name","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]},"ColumnListExp":{"definition":{"name":"ColumnListExp","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"ColumnListExp","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"CompareColumns":{"definition":{"name":"CompareColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"},{"name":"COMPARE_NAME","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["CUSTOMER_TYPE_ID","compare_CUSTOMER_TYPE_ID"]}]}}},{"id":84327,"revision":2,"created":1602243077096,"timestamp":1602243077096,"components":{"84326":{"id":84326,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-592,"y":-80,"width":32,"height":32,"inputConnectorIDs":[84344],"outputSuccessConnectorIDs":[84345],"outputFailureConnectorIDs":[84353],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get SourceSystemId List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW"}}}},"visible":false},"4":{"slot":4,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEM"}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}}},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select SOURCESYSTEMID\nfrom \"DW\".\"CONTROL\".\"SOURCESYSTEM\"\nwhere activeflag=true\nand SOURCESYSTEMNAME = '${SYSTEMNAME}'\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystem"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}}},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CONTROL"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84329":{"id":84329,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-592,"y":48,"width":32,"height":32,"inputConnectorIDs":[84353],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84328":{"id":84328,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-880,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84346],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84331":{"id":84331,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-272,"y":64,"width":32,"height":32,"inputConnectorIDs":[84348],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84330":{"id":84330,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":48,"y":-80,"width":32,"height":32,"inputConnectorIDs":[84342],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84333":{"id":84333,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-112,"y":-80,"width":32,"height":16,"inputConnectorIDs":[84347],"outputSuccessConnectorIDs":[84342],"outputFailureConnectorIDs":[84349],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop over SourceSystemId List - Key Processing"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystem"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[84355],"inputIterationConnectorIDs":[]},"84332":{"id":84332,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-112,"y":48,"width":32,"height":32,"inputConnectorIDs":[84349],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 4"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84335":{"id":84335,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1625823177,"x":-112,"y":-48,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW Key Processing 0"}}}},"visible":true},"2":{"slot":2,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[84355]},"84334":{"id":84334,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-432,"y":-80,"width":32,"height":16,"inputConnectorIDs":[84345],"outputSuccessConnectorIDs":[84343],"outputFailureConnectorIDs":[84350],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop SourceSystemId List - Stage"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystem"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[84357],"inputIterationConnectorIDs":[]},"84337":{"id":84337,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-272,"y":-80,"width":32,"height":16,"inputConnectorIDs":[84343],"outputSuccessConnectorIDs":[84347],"outputFailureConnectorIDs":[84348],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop SourceSystemId List - ODS Load"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystem"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[84354],"inputIterationConnectorIDs":[]},"84336":{"id":84336,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-432,"y":64,"width":32,"height":32,"inputConnectorIDs":[84350],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84339":{"id":84339,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-752,"y":48,"width":32,"height":32,"inputConnectorIDs":[84352],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84338":{"id":84338,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1348346479,"x":-750,"y":-77,"width":32,"height":32,"inputConnectorIDs":[84346],"outputSuccessConnectorIDs":[84344],"outputFailureConnectorIDs":[84352],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted Data Load"}}}},"visible":true},"2":{"slot":2,"name":"SYSTEMNAME","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRS_NO"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84341":{"id":84341,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":962214725,"x":-432,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load Source to Stage System"}}}},"visible":true},"2":{"slot":2,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[84357]},"84340":{"id":84340,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-342421753,"x":-272,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load Stage to ODS System"}}}},"visible":true},"2":{"slot":2,"name":"ColumnListExp","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"}}}},"visible":true},"3":{"slot":3,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[84354]}},"successConnectors":{"84343":{"id":84343,"sourceID":84334,"targetID":84337},"84342":{"id":84342,"sourceID":84333,"targetID":84330},"84345":{"id":84345,"sourceID":84326,"targetID":84334},"84344":{"id":84344,"sourceID":84338,"targetID":84326},"84347":{"id":84347,"sourceID":84337,"targetID":84333}},"failureConnectors":{"84353":{"id":84353,"sourceID":84326,"targetID":84329},"84352":{"id":84352,"sourceID":84338,"targetID":84339},"84349":{"id":84349,"sourceID":84333,"targetID":84332},"84348":{"id":84348,"sourceID":84337,"targetID":84331},"84350":{"id":84350,"sourceID":84334,"targetID":84336}},"unconditionalConnectors":{"84346":{"id":84346,"sourceID":84328,"targetID":84338}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"84355":{"id":84355,"sourceID":84333,"targetID":84335},"84354":{"id":84354,"sourceID":84337,"targetID":84340},"84357":{"id":84357,"sourceID":84334,"targetID":84341}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"SYSTEMNAME":{"definition":{"name":"SYSTEMNAME","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"GRS_NO"},"SchemaName":{"definition":{"name":"SchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CONTROL"},"DatabaseName":{"definition":{"name":"DatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DW"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"1"}},"grids":{"SourceSystem":{"definition":{"name":"SourceSystem","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["1"]}]}}},{"id":84359,"revision":2,"created":1602243077105,"timestamp":1602243077105,"components":{"84363":{"id":84363,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":315,"y":160,"width":32,"height":32,"inputConnectorIDs":[84398],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84362":{"id":84362,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":1120,"y":-160,"width":32,"height":32,"inputConnectorIDs":[84384],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84392],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Network Policy"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use role ACCOUNTADMIN;\ncreate or replace network policy AZURE_WHITELIST allowed_ip_list = (\n'65.51.228.0/24',\n${NetworkPolicy}\n);\ndesc network policy AZURE_WHITELIST;\nuse role DATA_LOADER;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84365":{"id":84365,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":960,"y":-160,"width":32,"height":32,"inputConnectorIDs":[84385],"outputSuccessConnectorIDs":[84384],"outputFailureConnectorIDs":[84351],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build IP Ranges"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nsf = context.cursor()\n\n# get KeyMap Columns\n\n\ndef getip(environ):\n    try:\n#        cmd = \"select IP_RANGE from ODS_REFERENCE.BASE.NETWORK_POLICY where \"+environ+\"_ACTIVEFLAG=true order by to_number(split_part(parse_ip(ip_range,\\'CIDR\\'):host,\\'.\\',1));\"\n        cmd = \"select IP_RANGE from ODS_REFERENCE.BASE.NETWORK_POLICY where \"+environ+\"_ACTIVEFLAG=true order by ip_range;\"\n        print(\"getip cmd:  \",cmd)\n        sf.execute(cmd)\n        IPRANGE = sf.fetchall()\n        print(IPRANGE)\n    except:\n        IPRANGE = []\n    return IPRANGE\n\n\nif __name__ == '__main__':\n\n    # Get IP Ranges from Snowflake table ODS_REFERENCE.BASE.NETWORK_POLICY for this environment and build a string to \\\n    # use in a create network policy command\n    IPRANGE = (getip(env_name))\n    print(\"IPRANGE:  \",IPRANGE)\n    if len(IPRANGE) == 0:\n      emptyRC = \"empty set returned \"\n      raise Exception (emptyRC)\n      \n    IPR_STR = [\"'\"+i[0]+\"'\" for i in IPRANGE]\n    print(\"IPR_STR:  \",IPR_STR)\n    IPR = ', '.join(IPR_STR)\n    print(\"IPR:  \",IPR)\n    try:\n      context.updateVariable('NetworkPolicy', IPR)\n    except:\n      setRC = \"error on Job Variable set\"\n      raise Exception (setRC)\n            "}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84364":{"id":84364,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-160,"y":-160,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84394],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84367":{"id":84367,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":800,"y":-160,"width":32,"height":32,"inputConnectorIDs":[84395],"outputSuccessConnectorIDs":[84385],"outputFailureConnectorIDs":[84400],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load NETWORK_POLICY"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load NETWORK_POLICY"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84366":{"id":84366,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":160,"y":160,"width":32,"height":32,"inputConnectorIDs":[84396],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84369":{"id":84369,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":960,"y":0,"width":32,"height":32,"inputConnectorIDs":[84351],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84368":{"id":84368,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1897708330,"x":320,"y":0,"width":32,"height":32,"inputConnectorIDs":[84383],"outputSuccessConnectorIDs":[84386],"outputFailureConnectorIDs":[84398],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Stage File"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Upload"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IP_RANGE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"NOTES"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"DEV_ACTIVEFLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"TEST_ACTIVEFLAG"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"PROD_ACTIVEFLAG"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT ..."}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"RowScanDepth"},"2":{"slot":2,"type":"STRING","value":"100"}}}},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_REFERENCE"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NETWORK_POLICY"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"18":{"slot":18,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Excel"}}}},"visible":false},"400":{"slot":400,"name":"Storage URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://devwewhstore/stg-reference/EU Network Policy Builder.xlsx"}}}},"visible":true},"401":{"slot":401,"name":"Cell Range","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"A*:F*"}}}},"visible":true},"402":{"slot":402,"name":"Contains Header Row","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"498":{"slot":498,"name":"Storage Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Azure Blob Storage"}}}},"visible":true},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"5"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake Managed"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84371":{"id":84371,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":638,"y":-159,"width":32,"height":32,"inputConnectorIDs":[84386,84393],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84395],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84370":{"id":84370,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":160,"y":0,"width":32,"height":32,"inputConnectorIDs":[84387],"outputSuccessConnectorIDs":[84383],"outputFailureConnectorIDs":[84396],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate STG"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_REFERENCE"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NETWORK_POLICY"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84373":{"id":84373,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":800,"y":0,"width":32,"height":32,"inputConnectorIDs":[84400],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84372":{"id":84372,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":1280,"y":-320,"width":32,"height":32,"inputConnectorIDs":[84390],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84375":{"id":84375,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":320,"y":-160,"width":32,"height":32,"inputConnectorIDs":[84382],"outputSuccessConnectorIDs":[84389],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Stage"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_REFERENCE"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"4":{"slot":4,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AZURE_IP"}}}},"visible":true},"5":{"slot":5,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"APPLICATION"},"2":{"slot":2,"type":"STRING","value":"VARIANT"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"Yes"},"7":{"slot":7,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Create/Replace","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Replace"}}}},"visible":true},"7":{"slot":7,"name":"Clustering Keys","elements":{},"visible":true},"8":{"slot":8,"name":"Data Retention Time in Days","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"9":{"slot":9,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"11":{"slot":11,"name":"Primary Keys","elements":{},"visible":true},"12":{"slot":12,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Permanent"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84374":{"id":84374,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":1280,"y":0,"width":32,"height":32,"inputConnectorIDs":[84399],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 4"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84377":{"id":84377,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":160,"y":-160,"width":32,"height":32,"inputConnectorIDs":[84391],"outputSuccessConnectorIDs":[84382],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Bash Get Azure IPs"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\n\nset -e\n\nINITIALURL=\"https://www.microsoft.com/en-in/download/confirmation.aspx?id=56519\"\n\n# Calls the initial download confirmation page and rips out the manual download URL\nOUT=$(curl -s \"${INITIALURL}\" | grep -Eo '\"https://[^\"]*ServiceTags_Public[^\"]*\"'|head -n 1|cut -d '\"' -f 2)\n\n# Downloads the actual data file (JSON format) and write it to the Matillion Unix box\ncurl -s -f \"${OUT}\" -o \"/tmp/ServiceTags_Public.json\"\n\n# Copies the downloaded file to Azure blob storage\naz storage blob upload --file \"/tmp/ServiceTags_Public.json\" --container-name stg-reference --name \"ServiceTags_Public.json\" --account-name \"$env_storage\" --sas-token \"$env_sas_token\"\n"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84376":{"id":84376,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[84388],"outputSuccessConnectorIDs":[84387],"outputFailureConnectorIDs":[84397],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create NETWORK_POLICY Table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use ROLE SYSADMIN;\nuse database \"ODS_REFERENCE\";\nuse SCHEMA \"BASE\";\n\nCREATE TABLE if not exists \"NETWORK_POLICY\" (\n\tIP_RANGE varchar(45) NOT NULL,\n\tCATEGORY varchar(200),\n\tNOTES varchar(1000),\n\tDEV_ACTIVEFLAG boolean,\n\tTEST_ACTIVEFLAG boolean,\n\tPROD_ACTIVEFLAG boolean,\n\tODS_SRC_SYSTEM_ID NUMBER(38,0) NOT NULL,\n\tODS_CREATEDBY VARCHAR(255) NOT NULL DEFAULT CURRENT_USER(),\n\tODS_CREATEDBY_TIMESTAMP TIMESTAMP_LTZ(9) NOT NULL DEFAULT CURRENT_TIMESTAMP(),\n\tODS_MODIFIEDBY VARCHAR(255) NOT NULL DEFAULT CURRENT_USER(),\n\tODS_MODIFIEDBY_TIMESTAMP TIMESTAMP_LTZ(9) NOT NULL DEFAULT CURRENT_TIMESTAMP(),\n\tconstraint PK_NETWORK_POLICY primary key (IP_RANGE)\n)\n;\nuse role DATA_LOADER;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84379":{"id":84379,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":1280,"y":-160,"width":32,"height":32,"inputConnectorIDs":[84392],"outputSuccessConnectorIDs":[84390],"outputFailureConnectorIDs":[84399],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Role Data_Loader 2"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use role DATA_LOADER;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84378":{"id":84378,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1989138124,"x":480,"y":-160,"width":32,"height":32,"inputConnectorIDs":[84389],"outputSuccessConnectorIDs":[84393],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Stage Azure IPs"}}}},"visible":true},"4":{"slot":4,"name":"Azure Storage Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://${env_storage}/stg-reference/"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_REFERENCE"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"8":{"slot":8,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AZURE_IP"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"APPLICATION"}}}},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JSON"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUTO"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":false},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":false},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":false},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":false},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":false},"31":{"slot":31,"name":"Null If","elements":{},"visible":false},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":false},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"35":{"slot":35,"name":"Skip Blank Lines","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"36":{"slot":36,"name":"Replace Invalid Characters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ServiceTags_Public.json"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84381":{"id":84381,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":0,"y":-160,"width":32,"height":32,"inputConnectorIDs":[84394],"outputSuccessConnectorIDs":[84388,84391],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Role Data_Loader"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use role DATA_LOADER;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84380":{"id":84380,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":0,"y":160,"width":32,"height":32,"inputConnectorIDs":[84397],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 5"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"84385":{"id":84385,"sourceID":84367,"targetID":84365},"84384":{"id":84384,"sourceID":84365,"targetID":84362},"84387":{"id":84387,"sourceID":84376,"targetID":84370},"84386":{"id":84386,"sourceID":84368,"targetID":84371},"84389":{"id":84389,"sourceID":84375,"targetID":84378},"84388":{"id":84388,"sourceID":84381,"targetID":84376},"84391":{"id":84391,"sourceID":84381,"targetID":84377},"84390":{"id":84390,"sourceID":84379,"targetID":84372},"84393":{"id":84393,"sourceID":84378,"targetID":84371},"84383":{"id":84383,"sourceID":84370,"targetID":84368},"84382":{"id":84382,"sourceID":84377,"targetID":84375}},"failureConnectors":{"84400":{"id":84400,"sourceID":84367,"targetID":84373},"84397":{"id":84397,"sourceID":84376,"targetID":84380},"84396":{"id":84396,"sourceID":84370,"targetID":84366},"84399":{"id":84399,"sourceID":84379,"targetID":84374},"84351":{"id":84351,"sourceID":84365,"targetID":84369},"84398":{"id":84398,"sourceID":84368,"targetID":84363}},"unconditionalConnectors":{"84392":{"id":84392,"sourceID":84362,"targetID":84379},"84395":{"id":84395,"sourceID":84371,"targetID":84367},"84394":{"id":84394,"sourceID":84364,"targetID":84381}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84358":{"id":84358,"x":1047,"y":-312,"width":144,"height":226,"text":"**``NOTE``**\n\nIncludes Elmsford as a default/safety!!  65.51.228.0/24\n","colour":"00ce4f"},"84361":{"id":84361,"x":87,"y":-472,"width":467,"height":387,"text":"This downloads a specific file.  Azure has deprecated its predecessor, so keeping up will be an issue.\n\nThis renames the downloaded file to a standard name.\n\nUsing the Azure instance credentials in the script would be better than the SAS token, which will expire.\n\nBlob loader requires an existing target table.","colour":"e6e63c"},"84360":{"id":84360,"x":-555,"y":-235,"width":308,"height":148,"text":"**``CHANGE HISTORY``**\n\n20200123:  Created.  (BRR)\n20200925:  Changes to handle mixed case.  (BRR)","colour":"00ce4f"}},"variables":{"NetworkPolicy":{"definition":{"name":"NetworkPolicy","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"'65.51.228.0/24'"}},"grids":{}},{"id":84434,"revision":2,"created":1602243077141,"timestamp":1602243077141,"components":{"84436":{"id":84436,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1214167305,"x":160,"y":0,"width":32,"height":32,"inputConnectorIDs":[84485],"outputSuccessConnectorIDs":[84484],"outputFailureConnectorIDs":[84498],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API Summary"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Run History Summary"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"groupName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"projectName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"versionID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"versionName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"environmentName"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"jobName"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"state"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"enqueuedTime"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"endTime"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"message"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"enqueuedTime"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"${SummaryLastValue}"}}}},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n[id],\n[type],\n[groupName],\n[projectName],\n[versionID],\n[versionName],\n[environmentName],\n[jobName],\n[state],\n[enqueuedTime],\n[startTime],\n[endTime],\n[message]\nfrom [Run History Summary]\nwhere\nsince = '1900-01-01'"}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PseudoColumns"},"2":{"slot":2,"type":"STRING","value":"*=*"}}}},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_MATILLION_SUMMARY"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"18":{"slot":18,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REST"}}}},"visible":false},"100":{"slot":100,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion API"}}}},"visible":true},"499":{"slot":499,"name":"Authentication Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"User/Password"}}}},"visible":true},"500":{"slot":500,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"api-user"}}}},"visible":true},"501":{"slot":501,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"API"}}}},"visible":true},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake Managed"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84439":{"id":84439,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-160,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84490,84492],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84438":{"id":84438,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":0,"y":160,"width":32,"height":32,"inputConnectorIDs":[84492],"outputSuccessConnectorIDs":[84491],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Watermark Detail"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n# get max value of jobtimestamp\ncmd = \"select coalesce(max(id),0) from AUDIT.BASE.MATILLION_DETAIL\"\nprint(cmd)\ncursor = context.cursor()\ncursor.execute(cmd)\nmaxval = cursor.fetchone()\n#print(type(maxval[0]))\nprint(maxval[0])\n\n#assign max value of jobtimestamp to variable\n#context.updateVariable('DetailLastValue', maxval[0])\ncontext.updateVariable('DetailLastValue', '10090909090909090909090909')\n\nprint(\"DetailLastValue:  \", DetailLastValue)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84441":{"id":84441,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":480,"y":160,"width":32,"height":32,"inputConnectorIDs":[84487],"outputSuccessConnectorIDs":[84486],"outputFailureConnectorIDs":[84494],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_Detail"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_Detail"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84440":{"id":84440,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1214167305,"x":160,"y":160,"width":32,"height":32,"inputConnectorIDs":[84491],"outputSuccessConnectorIDs":[84487],"outputFailureConnectorIDs":[84495],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API Details"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Run History Details"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"jobTimestamp"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"componentName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"state"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"rowCount"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"endTime"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"message"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"since"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"${DetailLastValue}"}}}},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n[id],\n[type],\n[jobTimestamp],\n[componentName],\n[state],\n[rowCount],\n[startTime],\n[endTime],\n[message]\nfrom [Run History Details]\nwhere\nsince = '1900-01-01'"}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"200"}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PseudoColumns"},"2":{"slot":2,"type":"STRING","value":"*=*"}}}},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_MATILLION_DETAIL"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"18":{"slot":18,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"100":{"slot":100,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion API"}}}},"visible":true},"499":{"slot":499,"name":"Authentication Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"User/Password"}}}},"visible":true},"500":{"slot":500,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"api-user"}}}},"visible":true},"501":{"slot":501,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"API"}}}},"visible":true},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake Managed"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84443":{"id":84443,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[84490],"outputSuccessConnectorIDs":[84485],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Watermark Summary"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n# get max value of jobtimestamp\ncmd = \"select coalesce(max(enqueuedtime),0) from AUDIT.BASE.MATILLION_SUMMARY\"\nprint(cmd)\ncursor = context.cursor()\ncursor.execute(cmd)\nmaxval = cursor.fetchone()\n#print(type(maxval[0]))\nprint(maxval[0])\n\n#assign max value of jobtimestamp to variable\n#context.updateVariable('SummaryLastValue', maxval[0])\ncontext.updateVariable('SummaryLastValue', '10090909090909090909090909')\nprint(\"SummaryLastValue:  \", SummaryLastValue)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84442":{"id":84442,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":160,"y":80,"width":32,"height":32,"inputConnectorIDs":[84498],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84445":{"id":84445,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":480,"y":240,"width":32,"height":32,"inputConnectorIDs":[84494],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84444":{"id":84444,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":320,"y":0,"width":32,"height":32,"inputConnectorIDs":[84484],"outputSuccessConnectorIDs":[84488],"outputFailureConnectorIDs":[84496],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_Summary"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_Summary"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84447":{"id":84447,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":160,"y":240,"width":32,"height":32,"inputConnectorIDs":[84495],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84446":{"id":84446,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":960,"y":0,"width":32,"height":32,"inputConnectorIDs":[84489],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84449":{"id":84449,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":800,"y":80,"width":32,"height":32,"inputConnectorIDs":[84499],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 4"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84448":{"id":84448,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":320,"y":80,"width":32,"height":32,"inputConnectorIDs":[84496],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84450":{"id":84450,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":640,"y":0,"width":32,"height":32,"inputConnectorIDs":[84482,84486],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84493],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84481":{"id":84481,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":800,"y":0,"width":32,"height":32,"inputConnectorIDs":[84493],"outputSuccessConnectorIDs":[84489],"outputFailureConnectorIDs":[84499],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_Log"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_Log"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84480":{"id":84480,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":479,"y":82,"width":32,"height":32,"inputConnectorIDs":[84497],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 5"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84483":{"id":84483,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":480,"y":0,"width":32,"height":32,"inputConnectorIDs":[84488],"outputSuccessConnectorIDs":[84482],"outputFailureConnectorIDs":[84497],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send Alert"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send Alert"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SummaryLastValue"},"2":{"slot":2,"type":"STRING","value":"${SummaryLastValue}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"84482":{"id":84482,"sourceID":84483,"targetID":84450},"84485":{"id":84485,"sourceID":84443,"targetID":84436},"84484":{"id":84484,"sourceID":84436,"targetID":84444},"84487":{"id":84487,"sourceID":84440,"targetID":84441},"84486":{"id":84486,"sourceID":84441,"targetID":84450},"84489":{"id":84489,"sourceID":84481,"targetID":84446},"84488":{"id":84488,"sourceID":84444,"targetID":84483},"84491":{"id":84491,"sourceID":84438,"targetID":84440}},"failureConnectors":{"84497":{"id":84497,"sourceID":84483,"targetID":84480},"84496":{"id":84496,"sourceID":84444,"targetID":84448},"84499":{"id":84499,"sourceID":84481,"targetID":84449},"84498":{"id":84498,"sourceID":84436,"targetID":84442},"84495":{"id":84495,"sourceID":84440,"targetID":84447},"84494":{"id":84494,"sourceID":84441,"targetID":84445}},"unconditionalConnectors":{"84490":{"id":84490,"sourceID":84439,"targetID":84443},"84493":{"id":84493,"sourceID":84450,"targetID":84481},"84492":{"id":84492,"sourceID":84439,"targetID":84438}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84437":{"id":84437,"x":-152,"y":-151,"width":707,"height":64,"text":"Trying to get similar info to this...\n\nhttps://www.matillion.com/blog/redshift/amazon-quicksight-dashboard-matillion-jobs/?utm_content=73830408","colour":"00ce4f"}},"variables":{"DetailLastValue":{"definition":{"name":"DetailLastValue","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"0"},"SummaryLastValue":{"definition":{"name":"SummaryLastValue","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"0"}},"grids":{}},{"id":84501,"revision":2,"created":1602243077181,"timestamp":1602243077181,"components":{"84504":{"id":84504,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[84510],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84507":{"id":84507,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":160,"y":0,"width":32,"height":32,"inputConnectorIDs":[84510],"outputSuccessConnectorIDs":[84511],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Job History"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_LOG"}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"GROUPNAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PROJECTNAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"VERSIONID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"VERSIONNAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ENVIRONMENTNAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"JOBNAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_STATE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_ENQUEUEDTIME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_STARTTIME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_ENDTIME"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_MESSAGE"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_TYPE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_TIMESTAMP"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_NAME"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_STATE"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"ROWCOUNT"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_STARTTIME"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_ENDTIME"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_MESSAGE"}}}},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT DISTINCT\n\"PROJECTNAME\",\n\"JOBNAME\",\n\"STATE\",\nconvert_timezone('UTC','CET',dateadd('milliseconds',TO_NUMBER(\"ENQUEUEDTIME\")/1,'1970-01-01 00:00:00.0000')::timestamp_ltz) as \"ENQUEUEDTIME\"\nFROM AUDIT.BASE.MATILLION_SUMMARY\nWHERE \n\"TYPE\" in ('RUN_ORCHESTRATION','RUN_JOB','API_ORCHESTRATION','SCHEDULE_ORCHESTRATION')\nand\n\"STATE\" ='FAILED'\nand\nTO_TIMESTAMP_NTZ(\"ENQUEUEDTIME\") > dateadd(minute,-6,convert_timezone('CET','UTC',current_timestamp()))\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jobs"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JOBNAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ENQUEUEDTIME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STATE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PROJECTNAME"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_ENQUEUEDTIME"}}}},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Descending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84506":{"id":84506,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1900230221,"x":464,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send to Azure Queue"}}}},"visible":true},"2":{"slot":2,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"devdwstoreu202"}}}},"visible":true},"3":{"slot":3,"name":"Queue","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dw-status"}}}},"visible":true},"4":{"slot":4,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"At ${JOB_ENQUEUEDTIME}, in the ${JOB_ENVIRONMENT} environment, job ${JOB_NAME} was queued and had a status of ${JOB_STATUS}."}}}},"visible":true},"5":{"slot":5,"name":"Message Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Plain"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"84509":{"id":84509,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":320,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SendMail"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"#\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\n\n\nEMAIL=$env_monitor_email\nSUBJECT=\"Matillion Failure - $env_name - $JOB_NAME\"\nBODY=\"Job $JOB_NAME on Matillion $JOB_ENVIRONMENT Enqueued at $JOB_ENQUEUEDTIME has a status of $JOB_STATUS.\"\nMAIL=\"subject:$SUBJECT\\nfrom:Matillion Server<admin@snaportal.com>\\n$BODY\"\n#MAIL=\"subject:Matillion Mail Test\\nfrom:Matillion ELT Box<admin@snaportal.com>\\nThis is a test mail\"\n#echo $SUBJECT#e\n#echo $BODY\n#echo $BODY | mail -s \"$SUBJECT\" -aFrom: Admin\\<admin@snaportal.com\\> $EMAIL\necho $MAIL\necho -e $MAIL | /sbin/sendmail -t $EMAIL"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[84513]},"84508":{"id":84508,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":320,"y":0,"width":32,"height":16,"inputConnectorIDs":[84511],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Iterate Job"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jobs"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_NAME"},"2":{"slot":2,"type":"STRING","value":"JOB_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_STARTTIME"},"2":{"slot":2,"type":"STRING","value":"JOB_ENQUEUEDTIME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_STATUS"},"2":{"slot":2,"type":"STRING","value":"JOB_STATUS"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_ENVIRONMENT"},"2":{"slot":2,"type":"STRING","value":"JOB_ENVIRONMENT"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[84513],"inputIterationConnectorIDs":[]}},"successConnectors":{"84511":{"id":84511,"sourceID":84507,"targetID":84508}},"failureConnectors":{},"unconditionalConnectors":{"84510":{"id":84510,"sourceID":84504,"targetID":84507}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"84513":{"id":84513,"sourceID":84508,"targetID":84509}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84503":{"id":84503,"x":-796,"y":-127,"width":463,"height":191,"text":"From Renak...\n\n[5/29 5:27 PM] Brian Renak\n    This is to test email.  The bash version has some extra stuff in it to keep track of when you last sent.  If no new errors, it will send the update that its OK now.  Read through it, hope it makes sense.  Right now it will only create the required file, send a mail, set the value that it sent to 1, then stop.  Running a second time leaving the emailsent file there, will NOT send an email (as designed).  You'd have to comment out the error section so its value is 0, then it would send the update...\n","colour":"e6e63c"},"84502":{"id":84502,"x":-344,"y":126,"width":433,"height":225,"text":"Is this needed, too?\n\n#!/bin/bash\nfunction extract_value {\n    FILENAME=$1\n    VAR=$2\n    grep -w $VAR $FILENAME | awk -v N=2 '{sep=\"\"; for (i=N; i<=NF; i++) {printf(\"%s%s\",sep,$i); sep=OFS}; printf(\"\\n\")}'\n}\n\n#This depends on a file called \"emailsent\" to exist, with a line in it that reads \"Email_Sent: #\"\n#The below checks for it, and if it does not find it, creates it for you\nif [ ! -f emailsent ]\nthen\n    echo \"Email_Sent: 0\" > emailsent\nfi\n\nEmail_Sent=$(extract_value emailsent Email_Sent)\n\n#You would add up error counts to know if you need to send an email.\n#Example:\nERROR_COUNT=0\nif [ 1 > 2 ]\nthen\n    ERRORS[$ERROR_COUNT]=\"Some kind of a message here that will show up in email body\"\n    ERROR_COUNT=$(($ERROR_COUNT+1))\nfi\n\nif [ $ERROR_COUNT -gt 0 ]\nthen\n    if [ \"$Email_Sent\" == 0 ]\n    then\n        EMAIL=brian.raney@securitasinc.com\n        SUBJECT=\"ALERT: ERRORS In XYZ\"\n        BODY=''\n        CNT=0\n        while [ \"$CNT\" != \"$ERROR_COUNT\" ]\n        do\n            BODY=\"$BODY ${ERRORS[$CNT]}\"\n            CNT=$(($CNT+1))\n        done\n\t\tBODY=\"$(echo -e \"${BODY}\" | sed -e 's/^[[:space:]]*//')\"\n        MAIL=\"subject:$SUBJECT\\nfrom:Matillion DEV<admin@snaportal.com>\\n$BODY\"\n        echo -e $MAIL | /sbin/sendmail $EMAIL\n        echo \"Email_Sent: 1\" > emailsent\n    else\n        echo \"Replication FAILED Email Already Sent\"\n    fi\nelse\n    if [ \"$Email_Sent\" == 1 ]\n    then\n        EMAIL=brian.raney@securitasinc.com\n        SUBJECT=\"ALERT: XYZ Back Online\"\n        BODY=''\n        MAIL=\"subject:$SUBJECT\\nfrom:Matillion DEV<admin@snaportal.com>\\n$BODY\"\n        echo -e $MAIL | /sbin/sendmail $EMAIL\n    fi\n    echo \"Email_Sent: 0\" > emailsent\n    echo \"Replication OK\"\n    printf \"file: %s at %'d\\n\" $Master_Log_File  $Read_Master_Log_Pos\n\nfi\n","colour":"e6e63c"},"84505":{"id":84505,"x":-810,"y":82,"width":443,"height":220,"text":"Bash Send email...\n\nEMAIL=brian.raney@securitasinc.com\nSUBJECT=\"ERRORS in replication\"\nBODY=\"Replication (SQL) is stopped 1396 Error\"\n#MAIL=\"subject:$SUBJECT\\nfrom:TrackTick MySQL Replication<admin@snaportal.com>\\n$BODY\"\nMAIL=\"subject:Matillion Mail Test\\nfrom:Matillion ELT Box<admin@snaportal.com>\\nThis is a test mail\"\n#echo $SUBJECT\n#echo $BODY\n#echo $BODY | mail -s \"$SUBJECT\" -aFrom: Admin\\<admin@snaportal.com\\> $EMAIL\necho -e $MAIL | /sbin/sendmail $EMAIL\n","colour":"e6e63c"}},"variables":{"JOB_NAME":{"definition":{"name":"JOB_NAME","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"test job"},"JOB_STATUS":{"definition":{"name":"JOB_STATUS","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"FAILED"},"JOB_ENVIRONMENT":{"definition":{"name":"JOB_ENVIRONMENT","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"test env"},"JOB_ENQUEUEDTIME":{"definition":{"name":"JOB_ENQUEUEDTIME","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"00:00:00"},"SummaryLastValue":{"definition":{"name":"SummaryLastValue","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"}},"grids":{"Jobs":{"definition":{"name":"Jobs","scope":"BRANCH","definitions":[{"name":"JOB_NAME","type":"TEXT"},{"name":"JOB_STARTTIME","type":"DATETIME"},{"name":"JOB_STATUS","type":"TEXT"},{"name":"JOB_ENVIRONMENT","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]}}}],"transformationJobs":[{"id":84213,"revision":2,"created":1602243077023,"timestamp":1602243077023,"components":{"84214":{"id":84214,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":160,"y":192,"width":32,"height":32,"inputConnectorIDs":[84218],"outputConnectorIDs":[84219],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84217":{"id":84217,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":364,"y":196,"width":32,"height":32,"inputConnectorIDs":[84219],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84216":{"id":84216,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":-32,"y":192,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84218],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${ColumnListExp} from ${StageDatabaseName}.${StageSchemaName}.\"${StageTableName}\""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84219":{"id":84219,"sourceID":84214,"targetID":84217},"84218":{"id":84218,"sourceID":84216,"targetID":84214}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84212":{"id":84212,"x":-466,"y":73,"width":272,"height":204,"text":"``Required Variables`` \n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nSourceSystemId\t\nStageDatabaseName\t\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns (COLUMN_NAME)\nODSColumns COLUMN_NAME)","colour":"e6e63c"},"84215":{"id":84215,"x":-465,"y":-4,"width":250,"height":58,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"}},"noteConnectors":{},"variables":{"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"ColumnListExp":{"definition":{"name":"ColumnListExp","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"COLUMNLISTEXP","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]}}},{"id":84221,"revision":2,"created":1602243077035,"timestamp":1602243077035,"components":{"84222":{"id":84222,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":400,"y":240,"width":32,"height":32,"inputConnectorIDs":[84255],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge ODS"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${PKMatch}"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${CompareList}"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84251":{"id":84251,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":240,"y":240,"width":32,"height":32,"inputConnectorIDs":[84252],"outputConnectorIDs":[84255],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84253":{"id":84253,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":64,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84252],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${ColumnListExp} from ${StageDatabaseName}.${StageSchemaName}.${StageTableName}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84252":{"id":84252,"sourceID":84253,"targetID":84251},"84255":{"id":84255,"sourceID":84251,"targetID":84222}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84220":{"id":84220,"x":-317,"y":87,"width":257,"height":247,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nCompareList\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nPKMatch\t\nSourceSystemId\t\nStageDatabaseName\t\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns (COLUMN_NAME)\nODSColumns  (COLUMN_NAME)","colour":"e6e63c"},"84223":{"id":84223,"x":-315,"y":7,"width":250,"height":58,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"}},"noteConnectors":{},"variables":{"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"\"tgt\".\"CUSTOMER_ID\"=\"src\".\"CUSTOMER_ID\""},"CompareList":{"definition":{"name":"CompareList","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"equal_null(src.ADDRESS,tgt.ADDRESS) = FALSE OR equal_null(src.NAME,tgt.NAME)=FALSE"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,'1029','KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,'1029','KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,'1029','KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,'1029','KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,'1029','KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"COLUMNLISTEXP":{"definition":{"name":"COLUMNLISTEXP","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"COLUMNLISTEXP","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]}}},{"id":84254,"revision":2,"created":1602243077043,"timestamp":1602243077043,"components":{"84259":{"id":84259,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":720,"y":240,"width":32,"height":32,"inputConnectorIDs":[84266],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge ODS"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${PKMatch}"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR = 'C'"},"2":{"slot":2,"type":"STRING","value":"Update"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR = 'D'"},"2":{"slot":2,"type":"STRING","value":"Delete"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84258":{"id":84258,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":560,"y":240,"width":32,"height":32,"inputConnectorIDs":[84265],"outputConnectorIDs":[84266],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84261":{"id":84261,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":80,"y":304,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84264],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84260":{"id":84260,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":240,"y":240,"width":32,"height":32,"inputConnectorIDs":[84264,84267],"outputConnectorIDs":[84269],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect Changes"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"PKColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"CompareColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"CompareColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COMPARE_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84263":{"id":84263,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":400,"y":240,"width":32,"height":32,"inputConnectorIDs":[84269],"outputConnectorIDs":[84265],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"N, C, or D"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"D"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84262":{"id":84262,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":80,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84267],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageTableName}"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84265":{"id":84265,"sourceID":84263,"targetID":84258},"84264":{"id":84264,"sourceID":84261,"targetID":84260},"84267":{"id":84267,"sourceID":84262,"targetID":84260},"84266":{"id":84266,"sourceID":84258,"targetID":84259},"84269":{"id":84269,"sourceID":84260,"targetID":84263}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84257":{"id":84257,"x":-234,"y":167,"width":267,"height":233,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nPKMatch\t\nSourceSystemId\t\nStageDatabaseName\t\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns  (COLUMN_NAME)\nODSColumns  (COLUMN_NAME)\nCompareColumns (COLLUMN_NAME, COMPARE_NAME)\nPKColumns (COLUMN_NAME)","colour":"e6e63c"},"84256":{"id":84256,"x":-232,"y":84,"width":286,"height":61,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"}},"noteConnectors":{},"variables":{"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"src.customer_id = tgt.customer_id "},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_TYPE_ID\tcompare_CUSTOMER_TYPE_ID"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NORWAY"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NORWAY"}},"grids":{"PKColumns":{"definition":{"name":"PKColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_TYPE_ID"]},{"values":["CUSTOMER_ID"]},{"values":["NAME_1"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_TYPE_ID"]},{"values":["CUSTOMER_ID"]},{"values":["NAME_1"]}]},"ColumnListExp":{"definition":{"name":"ColumnListExp","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"COLUMNLISTEXP","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"CompareColumns":{"definition":{"name":"CompareColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"},{"name":"COMPARE_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_TYPE_ID","compare_CUSTOMER_TYPE_ID"]}]}}},{"id":84268,"revision":2,"created":1602243077051,"timestamp":1602243077051,"components":{"84272":{"id":84272,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":262,"y":198,"width":32,"height":32,"inputConnectorIDs":[84277],"outputConnectorIDs":[84276],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84275":{"id":84275,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":364,"y":196,"width":32,"height":32,"inputConnectorIDs":[84276],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84274":{"id":84274,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":128,"y":192,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84277],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${ColumnListExp} from ${StageDatabaseName}.${StageSchemaName}.${StageTableName}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84277":{"id":84277,"sourceID":84274,"targetID":84272},"84276":{"id":84276,"sourceID":84272,"targetID":84275}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84271":{"id":84271,"x":-234,"y":87,"width":280,"height":195,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nSourceSystemId\t\nStageDatabaseName\t\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns  (COLUMN_NAME)\nODSColumns  (COLUMN_NAME)","colour":"e6e63c"},"84270":{"id":84270,"x":-233,"y":6,"width":250,"height":58,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"},"84273":{"id":84273,"x":242,"y":59,"width":250,"height":58,"text":"SELECT \n  \"CUST_OBJ_ID\", \n  CURRENT_TIMESTAMP()\nAS \"ODS_MODIFIEDBY_TIMESTAMP\", \n  CURRENT_USER()\t\t\nAS \"ODS_MODIFIEDBY\", \n  1\nAS \"ODS_SRC_SYSTEM_ID\", \n  MD5(NVL( ADDRESS,'0')||NVL( ADDRESS_2,'0')||NVL( CUST_OBJ_NO,0)||NVL( NAME,'0')||NVL( POSTCODE,0)||NVL( POSTDELIVERY_ADDRESS,'0'))\nAS \"HASHVALUE\" \nFROM \"STG_GRS_NORWAY\".\"DBO\".\"CUSTOMER_OBJECT\";","colour":"e6e63c"}},"noteConnectors":{},"variables":{"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"COLUMNLISTEXP":{"definition":{"name":"COLUMNLISTEXP","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"COLUMNLISTEXP","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]}}},{"id":84279,"revision":2,"created":1602243077058,"timestamp":1602243077058,"components":{"84280":{"id":84280,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":464,"y":208,"width":32,"height":32,"inputConnectorIDs":[84284],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge ODS"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${PKMatch}"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"true"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true}},"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Rows Inserted","mapTo":"RowInserted"}},"expectedFailure":null,"activationStatus":"ENABLED"},"84283":{"id":84283,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":262,"y":210,"width":32,"height":32,"inputConnectorIDs":[84285],"outputConnectorIDs":[84284],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84282":{"id":84282,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":96,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84285],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${ColumnListExp} from ${StageDatabaseName}.${StageSchemaName}.${StageTableName}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84285":{"id":84285,"sourceID":84282,"targetID":84283},"84284":{"id":84284,"sourceID":84283,"targetID":84280}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84278":{"id":84278,"x":-232,"y":84,"width":276,"height":180,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nPKMatch\nSourceSystemId\nStageDatabaseName\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns  (COLUMN_NAME)\nODSColumns  (COLUMN_NAME)","colour":"e6e63c"},"84281":{"id":84281,"x":-235,"y":6,"width":250,"height":58,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"}},"noteConnectors":{},"variables":{"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"\"tgt\".\"CUSTOMER_ID\"=\"src\".\"CUSTOMER_ID\""},"RowInserted":{"definition":{"name":"RowInserted","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,'1029','KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,'1029','KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,'1029','KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,'1029','KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,'1029','KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"ColumnListExp":{"definition":{"name":"ColumnListExp","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"ColumnListExp","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]}}},{"id":84287,"revision":2,"created":1602243077070,"timestamp":1602243077070,"components":{"84289":{"id":84289,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1040,"y":240,"width":32,"height":32,"inputConnectorIDs":[84306],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert Multiple Current"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}_SCD"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"SCDColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84288":{"id":84288,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":80,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84301],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84291":{"id":84291,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":400,"y":400,"width":32,"height":32,"inputConnectorIDs":[84313],"outputConnectorIDs":[84302],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Single Active Only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"\"ODS_MODIFIEDBY_TIMESTAMP\""}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84290":{"id":84290,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":640,"y":240,"width":32,"height":32,"inputConnectorIDs":[84303],"outputConnectorIDs":[84307],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Multiple Current"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"ODS_MODIFIEDBY_TIMESTAMP\"::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_START_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'9999-12-31 23:59:59.99999'::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_END_TIMESTAMP"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TRUE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_CURRENT_FLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_FLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Null::TIMESTAMP_LTZ"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84293":{"id":84293,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1949249710,"x":240,"y":240,"width":32,"height":32,"inputConnectorIDs":[84301],"outputConnectorIDs":[84305,84313],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Replicate"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84292":{"id":84292,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":640,"y":400,"width":32,"height":32,"inputConnectorIDs":[84302],"outputConnectorIDs":[84309],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Single Current"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"ODS_CREATEDBY_TIMESTAMP\"::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_START_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'9999-12-31 23:59:59.99999'::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_END_TIMESTAMP"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TRUE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_CURRENT_FLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_FLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"null::timestamp_LTZ"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84295":{"id":84295,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":400,"y":240,"width":32,"height":32,"inputConnectorIDs":[84305],"outputConnectorIDs":[84304,84303],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Multiple Only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"\"ODS_MODIFIEDBY_TIMESTAMP\""}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84294":{"id":84294,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":640,"y":320,"width":32,"height":32,"inputConnectorIDs":[84304],"outputConnectorIDs":[84311],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Multiple Closed"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"ODS_CREATEDBY_TIMESTAMP\"::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_START_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"ODS_MODIFIEDBY_TIMESTAMP\"::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_END_TIMESTAMP"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_CURRENT_FLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_FLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"null::timestamp_LTZ"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84297":{"id":84297,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1040,"y":320,"width":32,"height":32,"inputConnectorIDs":[84310],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert Multiple Closed"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}_SCD"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"SCDColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84296":{"id":84296,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":800,"y":240,"width":32,"height":32,"inputConnectorIDs":[84307],"outputConnectorIDs":[84306],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS - Multiple Current"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84299":{"id":84299,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1040,"y":400,"width":32,"height":32,"inputConnectorIDs":[84308],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert Single Current"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}_SCD"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"SCDColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84298":{"id":84298,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":800,"y":400,"width":32,"height":32,"inputConnectorIDs":[84309],"outputConnectorIDs":[84308],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS - Single Current"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84300":{"id":84300,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":800,"y":320,"width":32,"height":32,"inputConnectorIDs":[84311],"outputConnectorIDs":[84310],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS - Multiple Closed"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84301":{"id":84301,"sourceID":84288,"targetID":84293},"84303":{"id":84303,"sourceID":84295,"targetID":84290},"84302":{"id":84302,"sourceID":84291,"targetID":84292},"84305":{"id":84305,"sourceID":84293,"targetID":84295},"84304":{"id":84304,"sourceID":84295,"targetID":84294},"84307":{"id":84307,"sourceID":84290,"targetID":84296},"84306":{"id":84306,"sourceID":84296,"targetID":84289},"84309":{"id":84309,"sourceID":84292,"targetID":84298},"84308":{"id":84308,"sourceID":84298,"targetID":84299},"84311":{"id":84311,"sourceID":84294,"targetID":84300},"84310":{"id":84310,"sourceID":84300,"targetID":84297},"84313":{"id":84313,"sourceID":84293,"targetID":84291}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84286":{"id":84286,"x":-232,"y":163,"width":271,"height":177,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nSourceSystemId\t\n\n``Required Grid Variables``\nSTGColumns (COLUMN_NAME)\nODSColumns (COLUMN_NAME)","colour":"e6e63c"}},"noteConnectors":{},"variables":{"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_OBJECT"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NORWAY"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUST_OBJ_ID"]}]},"SCDColumns":{"definition":{"name":"SCDColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUST_OBJ_ID"]}]}}},{"id":84312,"revision":2,"created":1602243077078,"timestamp":1602243077078,"components":{"84314":{"id":84314,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":240,"y":240,"width":32,"height":32,"inputConnectorIDs":[84318],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge SCD"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}_SCD"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${PKMatch}\nAND\n\"tgt\".\"SCD_START_TIMESTAMP\"=\"src\".\"SCD_START_TIMESTAMP\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt.scd_current_flag = true"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD_END_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SCD_END_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SCD_CURRENT_FLAG"},"2":{"slot":2,"type":"STRING","value":"SCD_CURRENT_FLAG"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SCD_DELETE_FLAG"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_FLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"SCDColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84317":{"id":84317,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":-80,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84319],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS STREAM"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${PKList}, ${OtherColumns},\nods_modifiedby_timestamp as scd_start_timestamp,\ncase\n\twhen metadata$action='DELETE' AND metadata$isupdate=TRUE THEN lag(ods_modifiedby_timestamp) over (partition by ${PKList} order by ods_modifiedby_timestamp desc)\n    when metadata$action='DELETE' AND metadata$isupdate=FALSE THEN current_timestamp::timestamp_ltz\n    when metadata$action='INSERT' then '9999-12-31 23:59:59.99999'::TIMESTAMP_LTZ\nend AS scd_end_timestamp,\ncase\n\twhen metadata$action='DELETE' AND metadata$isupdate=TRUE THEN FALSE\n    when metadata$action='DELETE' AND metadata$isupdate=FALSE THEN FALSE\n    when metadata$action='INSERT' then TRUE\nend as scd_current_flag,\ncase\n\twhen metadata$action='DELETE' AND metadata$isupdate=TRUE THEN FALSE\n    when metadata$action='DELETE' AND metadata$isupdate=FALSE THEN TRUE\n    when metadata$action='INSERT' then FALSE\nend as scd_delete_flag,\ncase\n\twhen metadata$action='DELETE' AND metadata$isupdate=TRUE THEN null\n    when metadata$action='DELETE' AND metadata$isupdate=FALSE THEN current_timestamp::timestamp_ltz\n    when metadata$action='INSERT' then null\nend as scd_delete_timestamp\nfrom ${ODSDatabaseName}.${ODSSchemaName}.${ODSTableName}_STREAM"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84316":{"id":84316,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":80,"y":240,"width":32,"height":32,"inputConnectorIDs":[84319],"outputConnectorIDs":[84318],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84319":{"id":84319,"sourceID":84317,"targetID":84316},"84318":{"id":84318,"sourceID":84316,"targetID":84314}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84315":{"id":84315,"x":-397,"y":82,"width":260,"height":216,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nPKList\nPKMatch\nOtherColumns\nSourceSystemId\t\n\n``Required Grid Variables``\nSCDColumns (COLUMN_NAME)","colour":"e6e63c"}},"noteConnectors":{},"variables":{"PKList":{"definition":{"name":"PKList","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":null},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_OBJECT"},"OtherColumns":{"definition":{"name":"OtherColumns","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":null},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NORWAY"}},"grids":{"SCDColumns":{"definition":{"name":"SCDColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},{"id":84321,"revision":2,"created":1602243077086,"timestamp":1602243077086,"components":{"84323":{"id":84323,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":181,"y":194,"width":32,"height":32,"inputConnectorIDs":[84325],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Logging"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LOGGING"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PROCESS_TYPE"},"2":{"slot":2,"type":"STRING","value":"PROCESS_TYPE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"OBJECT_NAME"},"2":{"slot":2,"type":"STRING","value":"OBJECT_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"COMMAND"},"2":{"slot":2,"type":"STRING","value":"COMMAND"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"RUN_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"RUN_TIMESTAMP"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"RUN_RESULT"},"2":{"slot":2,"type":"STRING","value":"RUN_RESULT"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_INSERTED"},"2":{"slot":2,"type":"STRING","value":"RECORDS_INSERTED"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_UPDATED"},"2":{"slot":2,"type":"STRING","value":"RECORDS_UPDATED"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_DELETED"},"2":{"slot":2,"type":"STRING","value":"RECORDS_DELETED"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_SYSTEM_ID"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CONTROL"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84322":{"id":84322,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":738944574,"x":15,"y":193,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84325],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set Values"}}}},"visible":true},"2":{"slot":2,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PROCESS_TYPE"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":null}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"OBJECT_NAME"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"COMMAND"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"RUN_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"TIMESTAMP"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"RUN_RESULT"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":null},"4":{"slot":4,"type":"INTEGER","value":""}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_INSERTED"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":"0"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_UPDATED"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":"0"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_DELETED"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":"0"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_ID"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":""}}}},"visible":true},"3":{"slot":3,"name":"Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'${ProcessType}'"},"2":{"slot":2,"type":"STRING","value":"'${DatabaseName}.${SchemaName}.${TableName}'"},"3":{"slot":3,"type":"STRING","value":"'${Command}'"},"4":{"slot":4,"type":"DATETIME","value":"${RunTimestamp}"},"5":{"slot":5,"type":"STRING","value":"'${RunResult}'"},"6":{"slot":6,"type":"DECIMAL","value":"${RecordsInserted}"},"7":{"slot":7,"type":"DECIMAL","value":"${RecordsUpdated}"},"8":{"slot":8,"type":"DECIMAL","value":"${RecordsDeleted}"},"9":{"slot":9,"type":"DECIMAL","value":"${SourceSystemId}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84325":{"id":84325,"sourceID":84322,"targetID":84323}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84320":{"id":84320,"x":-366,"y":71,"width":235,"height":177,"text":"``Required Variables``\nCommand\nDatabaseName\nProcessType\nRecordsDeleted\nRecordsInserted\nRecordsUpdated\nRunResult\nRunTimestamp\nSchemaName\nSourceSystemId\nTableName\n","colour":"e6e63c"}},"noteConnectors":{},"variables":{"Command":{"definition":{"name":"Command","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":null},"RunResult":{"definition":{"name":"RunResult","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"UNKNOWN"},"TableName":{"definition":{"name":"TableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"LOGGING"},"SchemaName":{"definition":{"name":"SchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CONTROL"},"ProcessType":{"definition":{"name":"ProcessType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":null},"DatabaseName":{"definition":{"name":"DatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DW"},"RunTimestamp":{"definition":{"name":"RunTimestamp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1800-01-01 00:00:00"},"RecordsDeleted":{"definition":{"name":"RecordsDeleted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"0"},"RecordsUpdated":{"definition":{"name":"RecordsUpdated","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"0"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"RecordsInserted":{"definition":{"name":"RecordsInserted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"0"}},"grids":{}},{"id":84401,"revision":2,"created":1602243077125,"timestamp":1602243077125,"components":{"84402":{"id":84402,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":1440,"y":160,"width":32,"height":32,"inputConnectorIDs":[84420],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NETWORK_POLICY"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_REFERENCE"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"tgt\".\"IP_RANGE\" = \"src\".\"IP_RANGE\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"src\".\"Indicator\" in ('C')"},"2":{"slot":2,"type":"STRING","value":"Update"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"src\".\"Indicator\" in ('D')"},"2":{"slot":2,"type":"STRING","value":"Delete"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CATEGORY"},"2":{"slot":2,"type":"STRING","value":"CATEGORY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_NOTES"},"2":{"slot":2,"type":"STRING","value":"NOTES"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEV_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"DEV_ACTIVEFLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TEST_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"TEST_ACTIVEFLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PROD_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"PROD_ACTIVEFLAG"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"DW_SRC_SYSTEM_ID"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"DW_MODIFIEDBY"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"DW_MODIFIEDBY_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IP_RANGE"},"2":{"slot":2,"type":"STRING","value":"IP_RANGE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CATEGORY"},"2":{"slot":2,"type":"STRING","value":"CATEGORY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_NOTES"},"2":{"slot":2,"type":"STRING","value":"NOTES"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEV_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"DEV_ACTIVEFLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TEST_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"TEST_ACTIVEFLAG"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PROD_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"PROD_ACTIVEFLAG"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"DW_SRC_SYSTEM_ID"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"DW_MODIFIEDBY"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"DW_MODIFIEDBY_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84405":{"id":84405,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-160,"y":160,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84425],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NETWORK_POLICY"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NETWORK_POLICY"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IP_RANGE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"NOTES"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"DEV_ACTIVEFLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"TEST_ACTIVEFLAG"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"PROD_ACTIVEFLAG"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_REFERENCE"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84404":{"id":84404,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":960,"y":160,"width":32,"height":32,"inputConnectorIDs":[84422,84431],"outputConnectorIDs":[84424],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect Changes"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect NETWORK_POLICY"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IP_RANGE"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"NOTES"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DEV_ACTIVEFLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TEST_ACTIVEFLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"PROD_ACTIVEFLAG"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CATEGORY"},"2":{"slot":2,"type":"STRING","value":"compare_CATEGORY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_NOTES"},"2":{"slot":2,"type":"STRING","value":"compare_NOTES"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEV_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"compare_DEV_ACTIVEFLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TEST_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"compare_TEST_ACTIVEFLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PROD_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"compare_PROD_ACTIVEFLAG"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84407":{"id":84407,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1935486466,"x":640,"y":320,"width":32,"height":32,"inputConnectorIDs":[84432],"outputConnectorIDs":[84430],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"First/Last 0"}}}},"visible":true},"2":{"slot":2,"name":"Grouping Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IP_RANGE"}}}},"visible":true},"3":{"slot":3,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"},"2":{"slot":2,"type":"STRING","value":"Nulls Last"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"NOTES"},"2":{"slot":2,"type":"STRING","value":"Nulls Last"}}}},"visible":true},"4":{"slot":4,"name":"First/Last Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"},"2":{"slot":2,"type":"STRING","value":"First"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"NOTES"},"2":{"slot":2,"type":"STRING","value":"First"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DEV_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"First"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TEST_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"First"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"PROD_ACTIVEFLAG"},"2":{"slot":2,"type":"STRING","value":"First"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84406":{"id":84406,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-160,"y":320,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84418],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AZURE_IP"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AZURE_IP"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"APPLICATION"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_REFERENCE"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84409":{"id":84409,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":960,"y":320,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84422],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect NETWORK_POLICY"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NETWORK_POLICY"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IP_RANGE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"NOTES"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"DEV_ACTIVEFLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"TEST_ACTIVEFLAG"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"PROD_ACTIVEFLAG"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_REFERENCE"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84408":{"id":84408,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1280,"y":160,"width":32,"height":32,"inputConnectorIDs":[84423],"outputConnectorIDs":[84420],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"DW_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"DW_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"0"},"2":{"slot":2,"type":"STRING","value":"DW_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84411":{"id":84411,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":160,"y":160,"width":32,"height":32,"inputConnectorIDs":[84427],"outputConnectorIDs":[84429],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ACTIVEFLAG"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_BOOLEAN(\"DEV_ACTIVEFLAG\")"},"2":{"slot":2,"type":"STRING","value":"DEV_ACTIVEFLAG"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TO_BOOLEAN(\"TEST_ACTIVEFLAG\")"},"2":{"slot":2,"type":"STRING","value":"TEST_ACTIVEFLAG"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TO_BOOLEAN(\"PROD_ACTIVEFLAG\")"},"2":{"slot":2,"type":"STRING","value":"PROD_ACTIVEFLAG"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84410":{"id":84410,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":0,"y":160,"width":32,"height":32,"inputConnectorIDs":[84425],"outputConnectorIDs":[84427],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Not Azure"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"Azure"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84413":{"id":84413,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":1120,"y":160,"width":32,"height":32,"inputConnectorIDs":[84424],"outputConnectorIDs":[84423],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"N, C, or D"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"D"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84412":{"id":84412,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1838652813,"x":800,"y":160,"width":32,"height":32,"inputConnectorIDs":[84428],"outputConnectorIDs":[84431],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Convert Type 0"}}}},"visible":true},"2":{"slot":2,"name":"Conversions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IP_RANGE"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"45"},"4":{"slot":4,"type":"INTEGER","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"200"},"4":{"slot":4,"type":"INTEGER","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"NOTES"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"1000"},"4":{"slot":4,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84415":{"id":84415,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":0,"y":320,"width":32,"height":32,"inputConnectorIDs":[84418],"outputConnectorIDs":[84421],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL Flatten"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n\t\"f1\".VALUE:name::varchar as \"NAME\",\n\t\"f1\".VALUE:properties:platform::varchar as \"PLATFORM\",\n\t\"f1\".VALUE:properties:region::varchar as \"REGION\",\n\t\"f1\".VALUE:properties:systemService::varchar as \"SYSTEMSERVICE\",\n\t\"f2\".VALUE::varchar as \"IP_RANGE\"\nFROM \n\t$T{AZURE_IP} \"FLATTEN_VARIANT_INPUT\",\n\tlateral flatten(input=>\"FLATTEN_VARIANT_INPUT\".\"APPLICATION\":values, mode => 'array') \"f1\",\n\tlateral flatten(input=>\"f1\".VALUE:properties:addressPrefixes, mode => 'array') \"f2\""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84414":{"id":84414,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":320,"y":320,"width":32,"height":32,"inputConnectorIDs":[84426],"outputConnectorIDs":[84433],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Clean-up"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"PLATFORM\""},"2":{"slot":2,"type":"STRING","value":"CATEGORY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"SYSTEMSERVICE\"||' '||\"REGION\""},"2":{"slot":2,"type":"STRING","value":"NOTES"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"true::boolean"},"2":{"slot":2,"type":"STRING","value":"DEV_ACTIVEFLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"true::boolean"},"2":{"slot":2,"type":"STRING","value":"TEST_ACTIVEFLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"true::boolean"},"2":{"slot":2,"type":"STRING","value":"PROD_ACTIVEFLAG"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"CONTAINS(\"IP_RANGE\", ':')"},"2":{"slot":2,"type":"STRING","value":"IPV6_FLAG"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84417":{"id":84417,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":160,"y":320,"width":32,"height":32,"inputConnectorIDs":[84421],"outputConnectorIDs":[84426],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AzureCloud Only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NAME"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"AzureCloud.westeurope"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84416":{"id":84416,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":480,"y":320,"width":32,"height":32,"inputConnectorIDs":[84433],"outputConnectorIDs":[84432],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove IPv6"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IPV6_FLAG"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"False"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84419":{"id":84419,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-1841822228,"x":640,"y":160,"width":32,"height":32,"inputConnectorIDs":[84429,84430],"outputConnectorIDs":[84428],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Union"}}}},"visible":true},"2":{"slot":2,"name":"Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Overlapping Columns"}}}},"visible":true},"3":{"slot":3,"name":"Cast Types","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"4":{"slot":4,"name":"Add Source Component Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Remove duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84418":{"id":84418,"sourceID":84406,"targetID":84415},"84421":{"id":84421,"sourceID":84415,"targetID":84417},"84420":{"id":84420,"sourceID":84408,"targetID":84402},"84423":{"id":84423,"sourceID":84413,"targetID":84408},"84422":{"id":84422,"sourceID":84409,"targetID":84404},"84425":{"id":84425,"sourceID":84405,"targetID":84410},"84424":{"id":84424,"sourceID":84404,"targetID":84413},"84427":{"id":84427,"sourceID":84410,"targetID":84411},"84426":{"id":84426,"sourceID":84417,"targetID":84414},"84429":{"id":84429,"sourceID":84411,"targetID":84419},"84428":{"id":84428,"sourceID":84419,"targetID":84412},"84431":{"id":84431,"sourceID":84412,"targetID":84404},"84430":{"id":84430,"sourceID":84407,"targetID":84419},"84433":{"id":84433,"sourceID":84414,"targetID":84416},"84432":{"id":84432,"sourceID":84416,"targetID":84407}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84403":{"id":84403,"x":-555,"y":85,"width":308,"height":148,"text":"**``CHANGE HISTORY``**\n\n2020013:  Created (BRR)\n20200618:  Replaced Flatten Variant component with SQL component due to Matillion bug.  (BRR)\n20200917:  Added support to remove IPv6 ranges from Azure.  (BRR)","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},{"id":84500,"revision":2,"created":1602243077154,"timestamp":1602243077154,"components":{"84452":{"id":84452,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":556,"y":243,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84454],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_MATILLION_DETAIL"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_MATILLION_DETAIL"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"jobTimestamp"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"componentName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"state"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"rowCount"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"endTime"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"message"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"since"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84455":{"id":84455,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":720,"y":240,"width":32,"height":32,"inputConnectorIDs":[84454],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_DETAIL"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_DETAIL"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"tgt\".\"ID\" = \"src\".\"id\"\nAND\n\"tgt\".\"COMPONENTNAME\" = \"src\".\"componentName\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"<none>"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"type"},"2":{"slot":2,"type":"STRING","value":"TYPE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"jobTimestamp"},"2":{"slot":2,"type":"STRING","value":"JOBTIMESTAMP"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"componentName"},"2":{"slot":2,"type":"STRING","value":"COMPONENTNAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"state"},"2":{"slot":2,"type":"STRING","value":"STATE"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"rowCount"},"2":{"slot":2,"type":"STRING","value":"ROWCOUNT"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"},"2":{"slot":2,"type":"STRING","value":"STARTTIME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"endTime"},"2":{"slot":2,"type":"STRING","value":"ENDTIME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"message"},"2":{"slot":2,"type":"STRING","value":"MESSAGE"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id"},"2":{"slot":2,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"type"},"2":{"slot":2,"type":"STRING","value":"TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"jobTimestamp"},"2":{"slot":2,"type":"STRING","value":"JOBTIMESTAMP"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"componentName"},"2":{"slot":2,"type":"STRING","value":"COMPONENTNAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"state"},"2":{"slot":2,"type":"STRING","value":"STATE"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"rowCount"},"2":{"slot":2,"type":"STRING","value":"ROWCOUNT"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"},"2":{"slot":2,"type":"STRING","value":"STARTTIME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"endTime"},"2":{"slot":2,"type":"STRING","value":"ENDTIME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"message"},"2":{"slot":2,"type":"STRING","value":"MESSAGE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84454":{"id":84454,"sourceID":84452,"targetID":84455}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84451":{"id":84451,"x":902,"y":179,"width":250,"height":58,"text":"create or replace TABLE MATILLION_DETAIL (\n\tID VARCHAR(2000) NOT NULL,\n\tTYPE VARCHAR(2000),\n\tJOBTIMESTAMP VARCHAR(2000),\n\tCOMPONENTNAME VARCHAR(2000),\n\tSTATE VARCHAR(2000),\n\tROWCOUNT VARCHAR(2000),\n\tSTARTTIME VARCHAR(2000),\n\tENDTIME VARCHAR(2000),\n\tMESSAGE VARCHAR(2000),\n\tAUDIT_SRC_SYSTEM_ID VARCHAR(1024),\n\tAUDIT_CREATEDBY VARCHAR(255) NOT NULL DEFAULT CURRENT_USER(),\n\tAUDIT_CREATEDBY_TIMESTAMP TIMESTAMP_LTZ(9) NOT NULL DEFAULT CURRENT_TIMESTAMP(),\n\tAUDIT_MODIFIEDBY VARCHAR(255) NOT NULL DEFAULT CURRENT_USER(),\n\tAUDIT_MODIFIEDBY_TIMESTAMP TIMESTAMP_LTZ(9) NOT NULL DEFAULT CURRENT_TIMESTAMP(),\n\tconstraint PK_MATILLION_DETAIL primary key (ID)\n);","colour":"e6e63c"},"84453":{"id":84453,"x":165,"y":168,"width":305,"height":148,"text":"**``CHANGE HISTORY``**\n\n20191108:  Created (BRR)","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},{"id":84457,"revision":2,"created":1602243077160,"timestamp":1602243077160,"components":{"84458":{"id":84458,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":398,"y":393,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84472],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_SUMMARY"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_SUMMARY"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"GROUPNAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PROJECTNAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"VERSIONID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"VERSIONNAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ENVIRONMENTNAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"JOBNAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"STATE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ENQUEUEDTIME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"STARTTIME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"ENDTIME"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"MESSAGE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84461":{"id":84461,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":395,"y":235,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84470],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_DETAIL"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_DETAIL"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JOBTIMESTAMP"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENTNAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"STATE"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ROWCOUNT"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"STARTTIME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ENDTIME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"MESSAGE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84460":{"id":84460,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":720,"y":240,"width":32,"height":32,"inputConnectorIDs":[84473],"outputConnectorIDs":[84469],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flatten SQL"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nmd.id,\nTYPE.value::string AS type, \njts.value::integer AS jobtimestamp,\ncn.value::string AS componentname,\nstate.value::string AS state,\nrowcount.value::integer AS rowcount,\nst.value::integer AS starttime,\net.value::integer AS endtime,\nmsg.value::string as message\nFROM $T{SPLIT Strings} md,\nLATERAL flatten(INPUT => md.TYPE, mode => 'ARRAY') type,\nLATERAL flatten(INPUT => md.jobtimestamp, mode => 'ARRAY') jts,\nLATERAL flatten(INPUT => md.componentname, mode => 'ARRAY') cn,\nLATERAL flatten(INPUT => md.state, mode => 'ARRAY') state,\nLATERAL flatten(INPUT => md.rowcount, mode => 'ARRAY') rowcount,\nLATERAL flatten(INPUT => md.starttime, mode => 'ARRAY') st, \nLATERAL flatten(INPUT => md.endtime, mode => 'ARRAY') et,\nLATERAL flatten(INPUT => md.message, mode => 'ARRAY') msg\nWHERE \n TYPE.INDEX = jts.INDEX\nAND TYPE.INDEX = cn.INDEX\nAND TYPE.INDEX = state.INDEX\nAND TYPE.INDEX = rowcount.INDEX\nAND TYPE.INDEX = st.INDEX\nAND TYPE.INDEX = et.index\nAND TYPE.INDEX = msg.index"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84463":{"id":84463,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":880,"y":240,"width":32,"height":32,"inputConnectorIDs":[84469],"outputConnectorIDs":[84468],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Only Execution"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TYPE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Ilike"},"4":{"slot":4,"type":"STRING","value":"%EXEC%"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STATE"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Ilike"},"4":{"slot":4,"type":"STRING","value":"%DISABLED%"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84462":{"id":84462,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":1040,"y":240,"width":32,"height":32,"inputConnectorIDs":[84468,84472],"outputConnectorIDs":[84466],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join 0"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_SUMMARY"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ms"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Only Execution"},"2":{"slot":2,"type":"STRING","value":"md"},"3":{"slot":3,"type":"STRING","value":"Inner"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"ms\".\"ID\" = \"md\".\"ID\""},"2":{"slot":2,"type":"STRING","value":"ms_Inner_md"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ms.ID"},"2":{"slot":2,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ms.TYPE"},"2":{"slot":2,"type":"STRING","value":"JOB_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ms.GROUPNAME"},"2":{"slot":2,"type":"STRING","value":"GROUPNAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ms.PROJECTNAME"},"2":{"slot":2,"type":"STRING","value":"PROJECTNAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ms.VERSIONID"},"2":{"slot":2,"type":"STRING","value":"VERSIONID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ms.VERSIONNAME"},"2":{"slot":2,"type":"STRING","value":"VERSIONNAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ms.ENVIRONMENTNAME"},"2":{"slot":2,"type":"STRING","value":"ENVIRONMENTNAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ms.JOBNAME"},"2":{"slot":2,"type":"STRING","value":"JOBNAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ms.STATE"},"2":{"slot":2,"type":"STRING","value":"JOB_STATE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ms.ENQUEUEDTIME"},"2":{"slot":2,"type":"STRING","value":"ENQUEUEDTIME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"ms.STARTTIME"},"2":{"slot":2,"type":"STRING","value":"ms_STARTTIME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"ms.ENDTIME"},"2":{"slot":2,"type":"STRING","value":"ms_ENDTIME"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"ms.MESSAGE"},"2":{"slot":2,"type":"STRING","value":"JOB_MESSAGE"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"md.TYPE"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_TYPE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"md.JOBTIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"JOBTIMESTAMP"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"md.COMPONENTNAME"},"2":{"slot":2,"type":"STRING","value":"COMPONENTNAME"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"md.STATE"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_STATE"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"md.ROWCOUNT"},"2":{"slot":2,"type":"STRING","value":"ROWCOUNT"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"md.STARTTIME"},"2":{"slot":2,"type":"STRING","value":"md_STARTTIME"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"md.ENDTIME"},"2":{"slot":2,"type":"STRING","value":"md_ENDTIME"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"md.MESSAGE"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_MESSAGE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84465":{"id":84465,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1200,"y":240,"width":32,"height":32,"inputConnectorIDs":[84466],"outputConnectorIDs":[84471],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Clean-up"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dateadd('milliseconds',TO_NUMBER(\"ms_STARTTIME\")/1,'1970-01-01 00:00:00 0000')::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"JOB_STARTTIME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"dateadd('milliseconds',TO_NUMBER(\"ENQUEUEDTIME\")/1,'1970-01-01 00:00:00 0000')::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"ENQUEUED_TIME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dateadd('milliseconds',TO_NUMBER(\"ms_ENDTIME\")/1,'1970-01-01 00:00:00 0000')::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"JOB_ENDTIME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"dateadd('milliseconds',TO_NUMBER(\"JOBTIMESTAMP\")/1,'1970-01-01 00:00:00 0000')::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"JOBTIMESTAMP"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"dateadd('milliseconds',TO_NUMBER(\"md_STARTTIME\")/1,'1970-01-01 00:00:00 0000')::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_STARTTIME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"dateadd('milliseconds',TO_NUMBER(\"md_ENDTIME\")/1,'1970-01-01 00:00:00 0000')::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_ENDTIME"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84464":{"id":84464,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":1360,"y":240,"width":32,"height":32,"inputConnectorIDs":[84471],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_LOG"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_LOG"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"tgt\".\"ID\" = \"src\".\"ID\"\nand\n\"tgt\".\"JOBNAME\" = \"src\".\"JOBNAME\"\nand\n\"tgt\".\"COMPONENT_NAME\" = \"src\".\"COMPONENTNAME\"\nand\n\"tgt\".\"COMPONENT_STARTTIME\" = \"src\".\"COMPONENT_STARTTIME\"\nand \n\"tgt\".\"COMPONENT_ENDTIME\" = \"src\".\"COMPONENT_ENDTIME\"\nand\n\"tgt\".\"COMPONENT_MESSAGE\" = \"src\".\"COMPONENT_MESSAGE\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"<none>"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_TYPE"},"2":{"slot":2,"type":"STRING","value":"JOB_TYPE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"GROUPNAME"},"2":{"slot":2,"type":"STRING","value":"GROUPNAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"PROJECTNAME"},"2":{"slot":2,"type":"STRING","value":"PROJECTNAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"VERSIONID"},"2":{"slot":2,"type":"STRING","value":"VERSIONID"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"VERSIONNAME"},"2":{"slot":2,"type":"STRING","value":"VERSIONNAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ENVIRONMENTNAME"},"2":{"slot":2,"type":"STRING","value":"ENVIRONMENTNAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"JOBNAME"},"2":{"slot":2,"type":"STRING","value":"JOBNAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_STATE"},"2":{"slot":2,"type":"STRING","value":"JOB_STATE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ENQUEUEDTIME"},"2":{"slot":2,"type":"STRING","value":"JOB_ENQUEUEDTIME"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_STARTTIME"},"2":{"slot":2,"type":"STRING","value":"JOB_STARTTIME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_ENDTIME"},"2":{"slot":2,"type":"STRING","value":"JOB_ENDTIME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"JOB_MESSAGE"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_TYPE"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_TYPE"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"JOBTIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"JOB_TIMESTAMP"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_STATE"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_STATE"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"ROWCOUNT"},"2":{"slot":2,"type":"STRING","value":"ROWCOUNT"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_ENDTIME"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_ENDTIME"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_MESSAGE"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ID"},"2":{"slot":2,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_TYPE"},"2":{"slot":2,"type":"STRING","value":"JOB_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"GROUPNAME"},"2":{"slot":2,"type":"STRING","value":"GROUPNAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PROJECTNAME"},"2":{"slot":2,"type":"STRING","value":"PROJECTNAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"VERSIONID"},"2":{"slot":2,"type":"STRING","value":"VERSIONID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"VERSIONNAME"},"2":{"slot":2,"type":"STRING","value":"VERSIONNAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ENVIRONMENTNAME"},"2":{"slot":2,"type":"STRING","value":"ENVIRONMENTNAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"JOBNAME"},"2":{"slot":2,"type":"STRING","value":"JOBNAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_STATE"},"2":{"slot":2,"type":"STRING","value":"JOB_STATE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ENQUEUEDTIME"},"2":{"slot":2,"type":"STRING","value":"JOB_ENQUEUEDTIME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_STARTTIME"},"2":{"slot":2,"type":"STRING","value":"JOB_STARTTIME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_ENDTIME"},"2":{"slot":2,"type":"STRING","value":"JOB_ENDTIME"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"JOB_MESSAGE"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_TYPE"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_TYPE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"JOBTIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"JOB_TIMESTAMP"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENTNAME"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_NAME"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_STATE"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_STATE"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"ROWCOUNT"},"2":{"slot":2,"type":"STRING","value":"ROWCOUNT"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_STARTTIME"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_STARTTIME"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_ENDTIME"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_ENDTIME"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"COMPONENT_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"COMPONENT_MESSAGE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84467":{"id":84467,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":560,"y":240,"width":32,"height":32,"inputConnectorIDs":[84470],"outputConnectorIDs":[84473],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SPLIT Strings"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SPLIT(\"TYPE\",',')"},"2":{"slot":2,"type":"STRING","value":"TYPE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SPLIT(\"JOBTIMESTAMP\",',')"},"2":{"slot":2,"type":"STRING","value":"JOBTIMESTAMP"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SPLIT(\"COMPONENTNAME\",',')\n"},"2":{"slot":2,"type":"STRING","value":"COMPONENTNAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SPLIT(\"STATE\",',')"},"2":{"slot":2,"type":"STRING","value":"STATE"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SPLIT(\"ROWCOUNT\",',')\n"},"2":{"slot":2,"type":"STRING","value":"ROWCOUNT"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SPLIT(\"STARTTIME\",',')"},"2":{"slot":2,"type":"STRING","value":"STARTTIME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"SPLIT(\"ENDTIME\",',')"},"2":{"slot":2,"type":"STRING","value":"ENDTIME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SPLIT(\"MESSAGE\",',')"},"2":{"slot":2,"type":"STRING","value":"MESSAGE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84466":{"id":84466,"sourceID":84462,"targetID":84465},"84469":{"id":84469,"sourceID":84460,"targetID":84463},"84468":{"id":84468,"sourceID":84463,"targetID":84462},"84471":{"id":84471,"sourceID":84465,"targetID":84464},"84470":{"id":84470,"sourceID":84461,"targetID":84467},"84473":{"id":84473,"sourceID":84467,"targetID":84460},"84472":{"id":84472,"sourceID":84458,"targetID":84462}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84456":{"id":84456,"x":1476,"y":63,"width":371,"height":472,"text":"create or replace TABLE MATILLION_LOG (\n\tID NUMBER(38,0) NOT NULL,\n\tJOB_TYPE VARCHAR(1024),\n\tGROUPNAME VARCHAR(1024),\n\tPROJECTNAME VARCHAR(1024),\n\tVERSIONID NUMBER(38,0),\n\tVERSIONNAME VARCHAR(1024),\n\tENVIRONMENTNAME VARCHAR(1024),\n\tJOBNAME VARCHAR(1024),\n\tJOB_STATE VARCHAR(250),\n\tJOB_ENQUEUEDTIME TIMESTAMP_LTZ(9),\n\tJOB_STARTTIME TIMESTAMP_LTZ(9),\n\tJOB_ENDTIME TIMESTAMP_LTZ(9),\n\tJOB_MESSAGE VARCHAR(1024),\n\tCOMPONENT_TYPE VARCHAR(1024),\n\tJOB_TIMESTAMP TIMESTAMP_LTZ(9),\n\tCOMPONENT_NAME VARCHAR(1024),\n\tCOMPONENT_STATE VARCHAR(256),\n\tROWCOUNT NUMBER(38,0),\n\tCOMPONENT_STARTTIME TIMESTAMP_LTZ(9),\n\tCOMPONENT_ENDTIME TIMESTAMP_LTZ(9),\n\tCOMPONENT_MESSAGE VARCHAR(16777216),\n\tAUDIT_SRC_SYSTEM_ID VARCHAR(1024),\n\tAUDIT_CREATEDBY VARCHAR(255) NOT NULL DEFAULT CURRENT_USER(),\n\tAUDIT_CREATEDBY_TIMESTAMP TIMESTAMP_LTZ(9) NOT NULL DEFAULT CURRENT_TIMESTAMP(),\n\tAUDIT_MODIFIEDBY VARCHAR(255) NOT NULL DEFAULT CURRENT_USER(),\n\tAUDIT_MODIFIEDBY_TIMESTAMP TIMESTAMP_LTZ(9) NOT NULL DEFAULT CURRENT_TIMESTAMP(),\n\tconstraint PK_MATILLION_LOG primary key (ID)\n);","colour":"e6e63c"},"84459":{"id":84459,"x":648,"y":88,"width":147,"height":227,"text":"Matillion Flatten is not capable of outputting the INDEX for these joins.","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},{"id":84475,"revision":2,"created":1602243077171,"timestamp":1602243077171,"components":{"84476":{"id":84476,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":368,"y":-64,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[84478],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_MATILLION_SUMMARY"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_MATILLION_SUMMARY"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"groupName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"projectName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"versionID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"versionName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"environmentName"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"jobName"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"state"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"enqueuedTime"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"endTime"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"message"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"84479":{"id":84479,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":528,"y":-64,"width":32,"height":32,"inputConnectorIDs":[84478],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_SUMMARY"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_SUMMARY"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BASE"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"tgt\".\"ID\"= \"src\".\"id\"\n"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"<none>"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"type"},"2":{"slot":2,"type":"STRING","value":"TYPE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"groupName"},"2":{"slot":2,"type":"STRING","value":"GROUPNAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"projectName"},"2":{"slot":2,"type":"STRING","value":"PROJECTNAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"versionID"},"2":{"slot":2,"type":"STRING","value":"VERSIONID"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"versionName"},"2":{"slot":2,"type":"STRING","value":"VERSIONNAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"environmentName"},"2":{"slot":2,"type":"STRING","value":"ENVIRONMENTNAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"jobName"},"2":{"slot":2,"type":"STRING","value":"JOBNAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"state"},"2":{"slot":2,"type":"STRING","value":"STATE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"enqueuedTime"},"2":{"slot":2,"type":"STRING","value":"ENQUEUEDTIME"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"},"2":{"slot":2,"type":"STRING","value":"STARTTIME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"},"2":{"slot":2,"type":"STRING","value":"ENDTIME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"message"},"2":{"slot":2,"type":"STRING","value":"MESSAGE"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"id"},"2":{"slot":2,"type":"STRING","value":"ID"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id"},"2":{"slot":2,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"type"},"2":{"slot":2,"type":"STRING","value":"TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"groupName"},"2":{"slot":2,"type":"STRING","value":"GROUPNAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"projectName"},"2":{"slot":2,"type":"STRING","value":"PROJECTNAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"versionID"},"2":{"slot":2,"type":"STRING","value":"VERSIONID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"versionName"},"2":{"slot":2,"type":"STRING","value":"VERSIONNAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"environmentName"},"2":{"slot":2,"type":"STRING","value":"ENVIRONMENTNAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"jobName"},"2":{"slot":2,"type":"STRING","value":"JOBNAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"state"},"2":{"slot":2,"type":"STRING","value":"STATE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"enqueuedTime"},"2":{"slot":2,"type":"STRING","value":"ENQUEUEDTIME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"startTime"},"2":{"slot":2,"type":"STRING","value":"STARTTIME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"endTime"},"2":{"slot":2,"type":"STRING","value":"ENDTIME"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"message"},"2":{"slot":2,"type":"STRING","value":"MESSAGE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"84478":{"id":84478,"sourceID":84476,"targetID":84479}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"84474":{"id":84474,"x":791,"y":-268,"width":454,"height":381,"text":"create or replace TABLE MATILLION_SUMMARY (\n\tID VARCHAR(2000) NOT NULL,\n\tTYPE VARCHAR(2000),\n\tGROUPNAME VARCHAR(2000),\n\tPROJECTNAME VARCHAR(2000),\n\tVERSIONID VARCHAR(2000),\n\tVERSIONNAME VARCHAR(2000),\n\tENVIRONMENTNAME VARCHAR(2000),\n\tJOBNAME VARCHAR(2000),\n\tSTATE VARCHAR(2000),\n\tENQUEUEDTIME VARCHAR(2000),\n\tSTARTTIME VARCHAR(2000),\n\tENDTIME VARCHAR(2000),\n\tMESSAGE VARCHAR(2000),\n\tAUDIT_SRC_SYSTEM_ID VARCHAR(1024),\n\tAUDIT_CREATEDBY VARCHAR(255) NOT NULL DEFAULT CURRENT_USER(),\n\tAUDIT_CREATEDBY_TIMESTAMP TIMESTAMP_LTZ(9) NOT NULL DEFAULT CURRENT_TIMESTAMP(),\n\tAUDIT_MODIFIEDBY VARCHAR(255) NOT NULL DEFAULT CURRENT_USER(),\n\tAUDIT_MODIFIEDBY_TIMESTAMP TIMESTAMP_LTZ(9) NOT NULL DEFAULT CURRENT_TIMESTAMP(),\n\tconstraint PK_MATILLION_SUMMARY primary key (ID)\n);","colour":"e6e63c"},"84477":{"id":84477,"x":-18,"y":-135,"width":305,"height":148,"text":"**``CHANGE HISTORY``**\n\n20191108:  Created (BRR)","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}}],"variables":[{"name":"env_account","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_monitor_email","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_name","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_password","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_sas_token","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_storage","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_username","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"}],"environments":[{"index":0,"name":"securitasdev-west-europe","instanceCredentials":true,"credentialsName":"","schema":"DBO","encrypted":false,"url":"securitasdev.west-europe.azure","port":"WH_PUBLIC","database":"ODS_GRS_NO","driver":null,"user":"MATILLION_USER","passwordName":"","passphraseName":"","role":"ACCOUNTADMIN","variables":{"env_name":"TEST","env_monitor_email":"naresh.bawankar@securitas.com;santhosh.tm@securitas.com;subba.neerukonda@securitas.com;vinay.ramachandra@securitas.com","env_password":"","env_username":"MATILLION_USER","env_account":"securitasdev.west-europe.azure","env_sas_token":"?sv=2019-07-07&ss=btqf&srt=sco&st=2020-09-25T15%3A33%3A33Z&se=2022-09-26T15%3A33%3A00Z&sp=rwdlacup&sig=9N6EITMw7l3ujhP7UrDq%2F7PQQ7K0mGj8usrIfpAWDro%3D","env_storage":"devwewhstore"},"defaultStorageLocation":"","concurrentConnections":4,"passwordType":"PASSWORD","connectionOptions":{}}]}