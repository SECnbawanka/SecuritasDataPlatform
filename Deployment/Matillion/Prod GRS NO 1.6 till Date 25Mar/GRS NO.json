{"dbEnvironment":"snowflake","version":"1.50.6","jobsTree":{"id":1199,"name":"ROOT","children":[{"id":1210,"name":"GRS","children":[{"id":1211,"name":"Shared jobs","children":[{"id":1243,"name":"StageSystem","children":[],"jobs":[{"id":1244,"name":"StageSystem","description":"StageSystem","type":"ORCHESTRATION","tag":"03f6cd0d-07a1-415e-8786-43e6c55e9ab9"},{"id":1297,"name":"StageObject","description":"Data Loads from Source system to Stage DB","type":"ORCHESTRATION","tag":"5c19c457-bae1-4dad-bb18-eee7dda0e3d9"}]},{"id":1266,"name":"LoadSystem","children":[],"jobs":[{"id":1267,"name":"LoadSystem","description":"LoadSystem","type":"ORCHESTRATION","tag":"44e3cfcd-43bb-49e2-9ef6-7b320019660b"},{"id":1304,"name":"LoadObject_STG_ODS","description":"Stage_ODS_Object","type":"ORCHESTRATION","tag":"df71111a-bc2e-4c8b-bf44-a83bf73024f9"},{"id":1365,"name":"Load - Append","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"f1a64866-3fe7-4211-b4d0-8c13db9d35f9"},{"id":1373,"name":"Load - Difference","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"25cba163-676b-4732-ac41-71ce135592ce"},{"id":1381,"name":"Load - DifferenceDelete","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"da04da55-2f10-4fc3-9f4e-9d530bc2d23b"},{"id":1395,"name":"Load - Overwrite","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"bfd7dac2-615e-40e5-8093-27a43bb9c3c9"},{"id":1411,"name":"Load - Upsert","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"c08d3597-03e2-4eb8-9e25-01a27d2bcf85"},{"id":1419,"name":"Initial Load - SCD","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"99208e77-368c-4c59-af1a-eb4683374e8a"},{"id":1446,"name":"Load - SCD from STREAM","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"7b026abf-ddb3-4914-b27a-41bd951d5ac9"},{"id":1403,"name":"Logging","description":"Unpacked from Shared Job [LoadSystem].","type":"TRANSFORMATION","tag":"6aa4fa99-f82b-4464-8c68-cdecee6fd64a"}]},{"id":1451,"name":"Laod_Template","children":[],"jobs":[{"id":1452,"name":"LOAD_TEMPLATE","description":"Unpacked from Shared Job [LOAD_TEMPLATE].","type":"ORCHESTRATION","tag":"cf7c04d9-e189-4e6b-a131-3f7abed288a0"}]}],"jobs":[{"id":1212,"name":"DW Key Processing","description":"Unpacked from Shared Job [DW Key Processing].","type":"ORCHESTRATION","tag":"4298196b-65a8-45bf-8fbd-d75acaad7ca3"},{"id":1234,"name":"Restricted Data Load","description":"Restricted Excel Data to load into Global data platform","type":"ORCHESTRATION","tag":"bedf5344-007b-492b-be56-d824c9d2f0bd"},{"id":452806,"name":"OrphanDataDeletion","description":"OrphanDataDeletion for Restricted customer as part of data cleanup","type":"ORCHESTRATION","tag":"788a1f89-ac75-490f-a59b-d0dbec707814"}]}],"jobs":[]}],"jobs":[]},"orchestrationJobs":[{"id":1212,"revision":2,"created":1611346220641,"timestamp":1611346220641,"components":{"1217":{"id":1217,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":320,"y":-7,"width":32,"height":16,"inputConnectorIDs":[1226],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[1230],"outputUnconditionalConnectorIDs":[1227],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Iterate - Key Mapping"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"KeyMap"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[1233],"inputIterationConnectorIDs":[]},"1218":{"id":1218,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1228],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1219":{"id":1219,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":487,"y":-4,"width":32,"height":16,"inputConnectorIDs":[1227],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[1229],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Iterate - Key Object"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"KeyMap"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[1232],"inputIterationConnectorIDs":[]},"1220":{"id":1220,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":317,"y":-4,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Key Object"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nsf = context.cursor()\n\n# get ODS PK\n\n\ndef getodspk(database, schema, table):\n    try:\n        cmd = \"desc table \"+database+\".\"+schema+\".\"+table+\";\"\n        #print(\"DESC TABLE cmd:  \",cmd)\n        sf.execute(cmd)\n        PKCols = sf.fetchall()\n        PKColumns = [[c[0], ] for c in PKCols if c[5] == 'Y']\n    except:\n        PKColumns = []\n    return(PKColumns)\n\n# get KeyMap Columns\n\n\ndef getkm(database, schema, table):\n    try:\n        cmd = \"select coalesce(parent_keymap_id,keymap_id) as keymap, ARRAY_TO_STRING(column_name_list, ',') as column_name_list, coalesce(key_precedence,0) as key_precedence, dw_key_name, dw_column_name from dw.key.keymap where table_catalog=\\'\" + \\\n            database+\"\\' and table_schema=\\'\"+schema + \\\n            \"\\' and table_name=\\'\"+table+\"\\' order by 5 asc,3 asc;\"\n        #print(\"getkm cmd:  \",cmd)\n        sf.execute(cmd)\n        KM = sf.fetchall()\n        # print(type(KM))\n    except:\n        KM = []\n    return KM\n\n\nif __name__ == '__main__':\n    # set cmd sub-variables\n    FromList = \"FROM \"+ODSDatabaseName+\".\"+ODSSchemaName+\".\"+ODSTableName+\" src \"\n\n    # get ODS PK\n    PK = getodspk(ODSDatabaseName, ODSSchemaName, ODSTableName)\n    ODSColList = [\"src.\"+i[0] for i in PK]\n\n    # get KeyMap and build lists for mapped Source columns, DW columns with no precedence, DW columns with precedence, and Key table Joins\n    # Note that Jython interpreter seems to convert all numbers from the cursor to float; added the int() to convert back to integer\n    KM = getkm(ODSDatabaseName, ODSSchemaName, ODSTableName)\n    # print(KM)\n    SrcColList = []\n    Columns = []\n    Column_str = \"\"\n    for k in KM:\n        SrcColList = SrcColList+[\"src.\"+c for c in k[1].split(\",\")]\n    #print(\"SrcColList:  \", SrcColList)\n    \n    #Columns = [\"TO_VARCHAR(src.\"+c+\")\" for c in k[1].split(\",\")]\n    #Column_str = ', '.join(Columns)\n    #print(\"k[1].split \", k[1].split(\",\"))\n    #print(\"k:  \", k)\n    #print(\"Columns:  \",Columns)\n    \n    #vcList = [ \"TO_VARCHAR(\"+k+\")\" for k in k[1].split(\",\")]\n    #print(\"vcList:  \",vcList)\n    #vcList_str = ', '.join([\"TO_VARCHAR(\"+k+\")\" for k in k[1].split(\",\")])\n    \n    DWCP0List = [\"key_\"+str(int(k[0]))+\".\"+k[4] +\n                 \" as DW_\"+k[4]+\"\" for k in KM if k[2] == 0]\n    DWColList = [\"key_\"+str(int(k[0]))+\".\"+k[4]+\" as DW_\" +\n                 k[4]+\"_\"+str(int(k[2]))+\"\" for k in KM if k[2] != 0]\n    TabList = [\"LEFT OUTER JOIN \"+k[3]+\" key_\"+str(int(k[0]))+\" ON key_\"+str(int(k[0]))+\".keymap_id = \"+str(\n        int(k[0]))+\" AND key_\"+str(int(k[0]))+\".COLUMN_VALUE_LIST = ARRAY_CONSTRUCT(\"+', '.join([\"TO_VARCHAR(src.\"+x+\")\" for x in k[1].split(\",\")])+\") \" for k in KM]\n\n    # build Coalesced DW columns\n    DWCPList = list(set([k[4] for k in KM if k[2] != 0]))\n    COAList = \"\"\n\n    # Loop through the distinct DW columns with precedence to build the Coalesced DW columns\n    for i in DWCPList:\n        # print(i)\n        for k in KM:\n            if k[4] == i:\n                CPList = \"coalesce(\" if k[2] == 1 else CPList+\", \"\n                CPList = CPList+\"key_\"+str(int(k[0]))+\".\"+k[4]\n        CPList = CPList+\") as DW_\"+i\n        COAList = COAList+\", \"+CPList\n\n    # convert lists to strings\n    TabList = \"\".join(TabList)\n    SrcList = set(ODSColList+SrcColList)\n    CombList = list(SrcList)+DWCP0List+DWColList\n    ColList = \", \".join(CombList)\n    ColList = ColList+COAList if len(COAList) > 0 else ColList\n    FromList = FromList+\" \"+TabList\n    #print(ColList)\n    #print (FromList)\n    # Build View\n    cmd = \"create or replace view \"+ODSDatabaseName+\".\"+ODSSchemaName + \\\n        \".\"+ODSTableName+\"_KEY as (select \"+ColList+\" \"+FromList+\");\"\n    print(cmd)\n    try:\n        sf.execute(cmd)\n        RC = sf.fetchone()\n    except:\n        RC = \"Error creating view\"\n        raise Exception(RC)\n\n        # get SCD PK\n    SCDPK = getodspk(ODSDatabaseName, ODSSchemaName, ODSTableName+\"_SCD\")\n    if len(SCDPK) > 0:\n        # Build SCD View\n        FromList = \"FROM \"+ODSDatabaseName+\".\"+ODSSchemaName+\".\"+ODSTableName+\"_SCD src \"\n        cmd = \"create or replace view \"+ODSDatabaseName+\".\"+ODSSchemaName + \\\n            \".\"+ODSTableName+\"_SCD_KEY as (select \"+ColList+\", SCD_START_TIMESTAMP \"+FromList+\" \"+TabList+\");\"\n\n        print(cmd)\n        try:\n            sf.execute(cmd)\n            RC = sf.fetchone()\n        except:\n            RC = \"Error creating SCD view\"\n            raise Exception(RC)\n\n    print(\"RC:  \", RC)\n    # sf.close()\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"20"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[1232]},"1221":{"id":1221,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":176,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Key Mapping"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nsf = context.cursor()\n\n# get KeyMap Columns\n\n\ndef getkm(database, schema, table):\n    try:\n        cmd = \"select coalesce(parent_keymap_id,keymap_id) as keymap, coalesce(key_precedence,0) as key_precedence, dw_sequence_name, dw_key_name, dw_column_name, filter_criteria, array_to_string(column_name_list, ', ') from dw.key.keymap where table_catalog=\\'\" + \\\n            database+\"\\' and table_schema=\\'\"+schema + \\\n            \"\\' and table_name=\\'\"+table+\"\\' order by 5 asc, 2 asc;\"\n        print(\"getkm cmd:  \",cmd)\n        sf.execute(cmd)\n        KM = sf.fetchall()\n        #print(KM)\n    except:\n        KM = []\n    return KM\n\n\nif __name__ == '__main__':\n    # Verify Connection to SF\n    #    ver=sf_connected()\n    #    print(ver)\n\n    # get KeyMap and build lists for mapped Source columns, DW columns with no precedence, DW columns with precedence, and Key table Joins\n    KM = getkm(ODSDatabaseName, ODSSchemaName, ODSTableName)\n\n    # Loop through the distinct DW columns with precedence to build the Coalesced DW columns\n    for i in KM:\n        print(i)\n        KEYMAP_ID, KEY_PRECEDENCE, DW_SEQUENCE_NAME, DW_KEY_NAME, DW_COLUMN_NAME, FILTER_CRITERIA, COLUMN_NAME_LIST = i\n        Columns = [\"TRIM(src.\"+c+\")\" for c in COLUMN_NAME_LIST.split(\",\")]\n        # print(type(Columns))\n        # print(Columns)\n        Column_str = ', '.join(Columns)\n        ColList = \"CREATE OR REPLACE TEMPORARY TABLE \"+ODSDatabaseName+\".\"+ODSSchemaName+\".tmp_\"+ODSTableName + \\\n            \" AS SELECT DISTINCT src.ods_src_system_id, \" + \\\n            str(int(KEYMAP_ID))+\" as keymap_id, ARRAY_CONSTRUCT(\" + \\\n            Column_str+\") as column_value_list,  \"\n        FromList = \"FROM \"+ODSDatabaseName+\".\"+ODSSchemaName+\".\"+ODSTableName+\" src \"\n        WhereList = \"WHERE ARRAY_SIZE(ARRAY_CONSTRUCT(\" + \\\n            Column_str+\")) > 0 AND \"\n        if FILTER_CRITERIA != None:\n            WhereList = WhereList+\" \"+FILTER_CRITERIA+\" AND \"\n\n        if KEY_PRECEDENCE > 0:\n            # print(KEY_PRECEDENCE)\n\n            for j in KM:\n                # NOTE:  The next line is for the DW_COLUMN_NAME & the index starts at 0!!!!\n                if j[4] == i[4]:\n                    #print(j[4])\n                    #print(j)\n                    jKEYMAP_ID, jKEY_PRECEDENCE, jDW_SEQUENCE_NAME, jDW_KEY_NAME, jDW_COLUMN_NAME, jFILTER_CRITERIA, jCOLUMN_NAME_LIST = j\n                    if jKEY_PRECEDENCE == 1:\n                        coa = \"coalesce(key_\"+str(int(jKEY_PRECEDENCE)\n                                                  )+\".\"+DW_COLUMN_NAME+\"  \"\n                        #print(coa)\n                        FromList = FromList+\"LEFT OUTER JOIN \"+DW_KEY_NAME+\" key_\"+str(int(jKEY_PRECEDENCE))+\" ON key_\"+str(int(jKEY_PRECEDENCE))+\".keymap_id = \"+str(\n                            int(jKEYMAP_ID))+\" and key_\"+str(int(jKEY_PRECEDENCE))+\".column_value_list = ARRAY_CONSTRUCT(\"+Column_str+\") \"\n                    else:\n                        coa = coa+\", key_\" + \\\n                            str(int(jKEY_PRECEDENCE))+\".\"+DW_COLUMN_NAME\n                        #print(coa)\n                        FromList = FromList+\"LEFT OUTER JOIN \"+DW_KEY_NAME+\" key_\"+str(int(jKEY_PRECEDENCE))+\" ON key_\"+str(int(jKEY_PRECEDENCE))+\".keymap_id = \"+str(\n                            int(jKEYMAP_ID))+\" and key_\"+str(int(jKEY_PRECEDENCE))+\".column_value_list = ARRAY_CONSTRUCT(\"+Column_str+\") \"\n\n            ColList = ColList+\" \"+coa+\")\"\n            WhereList = WhereList+\" key_\" + \\\n                str(int(KEY_PRECEDENCE))+\".\"+DW_COLUMN_NAME\n\n        else:\n            ColList = ColList+\"key.\"+DW_COLUMN_NAME\n            FromList = FromList+\"LEFT OUTER JOIN \"+DW_KEY_NAME+\" key ON key.keymap_id = \" + \\\n                str(int(KEYMAP_ID)) + \\\n                \" and key.column_value_list = ARRAY_CONSTRUCT(\"+Column_str+\") \"\n            WhereList = WhereList+\"key.\"+DW_COLUMN_NAME\n\n        ColList = ColList+\" as \"+DW_COLUMN_NAME+\" \"\n        tmpcmd = ColList+FromList+WhereList+\" is null;\"\n        print(tmpcmd)\n\n        # Build Merge cmd\n        inscmd = \"INSERT ALL INTO \"+DW_KEY_NAME+\" (KEYMAP_ID, COLUMN_VALUE_LIST, \"+DW_COLUMN_NAME+\", DW_SRC_SYSTEM_ID) VALUES (keymap_id, COLUMN_VALUE_LIST, coalesce(\" + \\\n            DW_COLUMN_NAME+\",\"+DW_SEQUENCE_NAME+\".nextval), ods_src_system_id) SELECT * FROM \" + \\\n            ODSDatabaseName+\".\"+ODSSchemaName+\".tmp_\"+ODSTableName+\";\"\n        print(inscmd)\n\n        try:\n            sf.execute(tmpcmd)\n            tmpRC = sf.fetchone()\n        except:\n            tmpRC = \"error on temporary table\"\n            raise Exception (tmpRC)\n\n        try:\n            sf.execute(inscmd)\n            insRC = sf.fetchone()\n        except:\n            insRC = \"error on insert\"\n            raise Exception (insRC)\n\n        print(\"tmpRC:  \", tmpRC)\n        print(\"insRC:  \", insRC)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[1233]},"1222":{"id":1222,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":482,"y":163,"width":32,"height":32,"inputConnectorIDs":[1229],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1223":{"id":1223,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":161,"y":164,"width":32,"height":32,"inputConnectorIDs":[1231],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1224":{"id":1224,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":154,"y":5,"width":32,"height":32,"inputConnectorIDs":[1228],"outputSuccessConnectorIDs":[1226],"outputFailureConnectorIDs":[1231],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get KeyMap List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH x AS (\nSELECT \nggp.KEYMAP_ID AS ggp_keymap_id, ggp.TABLE_CATALOG AS ggp_table_catalog, ggp.TABLE_SCHEMA AS ggp_table_Schema, ggp.TABLE_NAME AS ggp_table_name,\ngp.KEYMAP_ID AS gp_keymap_id, gp.TABLE_CATALOG AS gp_table_catalog, gp.TABLE_SCHEMA AS gp_table_schema, gp.TABLE_NAME AS gp_table_name,\nprnt.KEYMAP_ID AS pr_keymap_id, prnt.TABLE_CATALOG AS pr_table_catalog, prnt.table_schema AS pr_table_schema, prnt.TABLE_NAME AS pr_table_name,\nKEY.keymap_id, KEY.TABLE_CATALOG, KEY.TABLE_SCHEMA, KEY.TABLE_NAME\nFROM dw.KEY.keymap key \nLEFT outer JOIN dw.KEY.keymap prnt\nON KEY.PARENT_KEYMAP_ID=prnt.KEYMAP_ID\nAND KEY.SRC_SYSTEM_ID = PRNT.SRC_SYSTEM_ID\nLEFT OUTER JOIN dw.KEY.keymap gp \nON prnt.TABLE_CATALOG=gp.TABLE_CATALOG\nAND prnt.TABLE_SCHEMA=gp.TABLE_SCHEMA\nAND prnt.TABLE_NAME=gp.TABLE_NAME\nAND key.SRC_SYSTEM_ID= gp.SRC_SYSTEM_ID\nLEFT outer JOIN dw.KEY.keymap ggp\nON gp.PARENT_KEYMAP_ID=ggp.KEYMAP_ID\nAND key.SRC_SYSTEM_ID = ggp.SRC_SYSTEM_ID\nWHERE KEY.SRC_SYSTEM_ID in (${SourceSystemId})\n),\n--use gp_table_catalog rather than ggp_table_catalog in order to return actual catalog, not universals\nggp AS (SELECT DISTINCT ggp_table_catalog AS table_catalog, ggp_TABLE_SCHEMA AS TABLE_SCHEMA, ggp_TABLE_NAME AS TABLE_NAME, ggp_KEYMAP_ID AS rank1, NULL AS rank2, NULL AS rank3, NULL AS rank4  FROM x WHERE ggp_KEYMAP_ID IS NOT NULL),\ngp AS (SELECT DISTINCT gp_table_catalog AS table_catalog, gp_TABLE_SCHEMA AS TABLE_SCHEMA, gp_TABLE_NAME AS TABLE_NAME, null AS rank1, gp_KEYMAP_ID AS rank2, NULL AS rank3, NULL AS rank4  FROM x WHERE gp_KEYMAP_ID IS NOT NULL),\nprnt AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, pr_KEYMAP_ID AS rank3, NULL AS rank4 FROM x WHERE KEYMAP_ID IS NOT NULL),\nKEY AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, null AS rank3, keymap_id AS rank4 FROM x WHERE KEYMAP_ID IS NOT NULL),\nun AS (SELECT * FROM ggp UNION SELECT * FROM gp UNION SELECT * FROM prnt UNION SELECT * FROM key),\nord AS (SELECT *, ROW_NUMBER() over(ORDER BY rank1, rank2, rank3, rank4) AS rnk FROM un)\nSELECT \nTABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, min(rnk) AS rnk\nFROM ord WHERE TABLE_CATALOG NOT LIKE '%UNIVERSAL%' \nGROUP BY TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME\nORDER BY rnk\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"KeyMap"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_CATALOG"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_SCHEMA"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_NAME"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1225":{"id":1225,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":320,"y":160,"width":32,"height":32,"inputConnectorIDs":[1230],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"1226":{"id":1226,"sourceID":1224,"targetID":1217}},"failureConnectors":{"1229":{"id":1229,"sourceID":1219,"targetID":1222},"1230":{"id":1230,"sourceID":1217,"targetID":1225},"1231":{"id":1231,"sourceID":1224,"targetID":1223}},"unconditionalConnectors":{"1227":{"id":1227,"sourceID":1217,"targetID":1219},"1228":{"id":1228,"sourceID":1218,"targetID":1224}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"1232":{"id":1232,"sourceID":1219,"targetID":1220},"1233":{"id":1233,"sourceID":1217,"targetID":1221}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1213":{"id":1213,"x":89,"y":-234,"width":143,"height":306,"text":"Changed to use this...\n\nWITH x AS (\nSELECT \nggp.KEYMAP_ID AS ggp_keymap_id, ggp.TABLE_CATALOG AS ggp_table_catalog, ggp.TABLE_SCHEMA AS ggp_table_Schema, ggp.TABLE_NAME AS ggp_table_name,\ngp.KEYMAP_ID AS gp_keymap_id, gp.TABLE_CATALOG AS gp_table_catalog, gp.TABLE_SCHEMA AS gp_table_schema, gp.TABLE_NAME AS gp_table_name,\nprnt.KEYMAP_ID AS pr_keymap_id, prnt.TABLE_CATALOG AS pr_table_catalog, prnt.table_schema AS pr_table_schema, prnt.TABLE_NAME AS pr_table_name,\nKEY.keymap_id, KEY.TABLE_CATALOG, KEY.TABLE_SCHEMA, KEY.TABLE_NAME\nFROM dw.KEY.keymap key \nLEFT outer JOIN dw.KEY.keymap prnt\nON KEY.PARENT_KEYMAP_ID=prnt.KEYMAP_ID\nAND KEY.SRC_SYSTEM_ID = PRNT.SRC_SYSTEM_ID\nLEFT OUTER JOIN dw.KEY.keymap gp \nON prnt.TABLE_CATALOG=gp.TABLE_CATALOG\nAND prnt.TABLE_SCHEMA=gp.TABLE_SCHEMA\nAND prnt.TABLE_NAME=gp.TABLE_NAME\nAND key.SRC_SYSTEM_ID= gp.SRC_SYSTEM_ID\nLEFT outer JOIN dw.KEY.keymap ggp\nON gp.PARENT_KEYMAP_ID=ggp.KEYMAP_ID\nAND key.SRC_SYSTEM_ID = ggp.SRC_SYSTEM_ID\nWHERE KEY.SRC_SYSTEM_ID in (61)\n),\n--use gp_table_catalog rather than ggp_table_catalog in order to return actual catalog, not universals\nggp AS (SELECT DISTINCT ggp_table_catalog AS table_catalog, ggp_TABLE_SCHEMA AS TABLE_SCHEMA, ggp_TABLE_NAME AS TABLE_NAME, ggp_KEYMAP_ID AS rank1, NULL AS rank2, NULL AS rank3, NULL AS rank4  FROM x WHERE ggp_KEYMAP_ID IS NOT NULL),\ngp AS (SELECT DISTINCT gp_table_catalog AS table_catalog, gp_TABLE_SCHEMA AS TABLE_SCHEMA, gp_TABLE_NAME AS TABLE_NAME, null AS rank1, gp_KEYMAP_ID AS rank2, NULL AS rank3, NULL AS rank4  FROM x WHERE gp_KEYMAP_ID IS NOT NULL),\nprnt AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, pr_KEYMAP_ID AS rank3, NULL AS rank4 FROM x WHERE KEYMAP_ID IS NOT NULL),\nKEY AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, null AS rank3, keymap_id AS rank4 FROM x WHERE KEYMAP_ID IS NOT NULL),\nun AS (SELECT * FROM ggp UNION SELECT * FROM gp UNION SELECT * FROM prnt UNION SELECT * FROM key),\nord AS (SELECT *, ROW_NUMBER() over(ORDER BY rank1, rank2, rank3, rank4) AS rnk FROM un)\nSELECT \nTABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, min(rnk) AS rnk\nFROM ord WHERE TABLE_CATALOG NOT LIKE '%UNIVERSAL%' \nGROUP BY TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME\nORDER BY rnk\n;\n","colour":"d60000"},"1214":{"id":1214,"x":729,"y":-311,"width":62,"height":460,"text":"WITH x AS (\nSELECT \nggp.KEYMAP_ID AS ggp_keymap_id, ggp.TABLE_CATALOG AS ggp_table_catalog, ggp.TABLE_SCHEMA AS ggp_table_Schema, ggp.TABLE_NAME AS ggp_table_name,\ngp.KEYMAP_ID AS gp_keymap_id, gp.TABLE_CATALOG AS gp_table_catalog, gp.TABLE_SCHEMA AS gp_table_schema, gp.TABLE_NAME AS gp_table_name,\nprnt.KEYMAP_ID AS pr_keymap_id, prnt.TABLE_CATALOG AS pr_table_catalog, prnt.table_schema AS pr_table_schema, prnt.TABLE_NAME AS pr_table_name,\nKEY.keymap_id, KEY.TABLE_CATALOG, KEY.TABLE_SCHEMA, KEY.TABLE_NAME\nFROM dw.KEY.keymap key \nLEFT outer JOIN dw.KEY.keymap prnt\nON KEY.PARENT_KEYMAP_ID=prnt.KEYMAP_ID\nLEFT OUTER JOIN dw.KEY.keymap gp \nON prnt.TABLE_CATALOG=gp.TABLE_CATALOG\nAND prnt.TABLE_SCHEMA=gp.TABLE_SCHEMA\nAND prnt.TABLE_NAME=gp.TABLE_NAME\nLEFT outer JOIN dw.KEY.keymap ggp\nON gp.PARENT_KEYMAP_ID=ggp.KEYMAP_ID\nWHERE KEY.SRC_SYSTEM_ID in (${SourceSystemId})\n),\n--use gp_table_catalog rather than ggp_table_catalog in order to return actual catalog, not universals\nggp AS (SELECT DISTINCT ggp_table_catalog AS table_catalog, ggp_TABLE_SCHEMA AS TABLE_SCHEMA, ggp_TABLE_NAME AS TABLE_NAME, ggp_KEYMAP_ID AS rank1, NULL AS rank2, NULL AS rank3  FROM x WHERE ggp_KEYMAP_ID IS NOT NULL),\ngp AS (SELECT DISTINCT gp_table_catalog AS table_catalog, gp_TABLE_SCHEMA AS TABLE_SCHEMA, gp_TABLE_NAME AS TABLE_NAME, null AS rank1, gp_KEYMAP_ID AS rank2, NULL AS rank3  FROM x WHERE gp_KEYMAP_ID IS NOT NULL),\nprnt AS (SELECT DISTINCT table_catalog, TABLE_SCHEMA, TABLE_NAME, NULL AS rank1, NULL AS rank2, KEYMAP_ID AS rank3 FROM x WHERE KEYMAP_ID IS NOT NULL),\nun AS (SELECT * FROM ggp UNION SELECT * FROM gp UNION SELECT * FROM prnt),\nord AS (SELECT *, ROW_NUMBER() over(ORDER BY rank1, rank2) AS rnk FROM un)\nSELECT TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, min(rnk) \nFROM ord WHERE TABLE_CATALOG NOT LIKE '%UNIVERSAL%' GROUP BY TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME\nORDER BY 4","colour":"f9c21b"},"1215":{"id":1215,"x":649,"y":-314,"width":67,"height":466,"text":"Pass in SourceSystemId as a parameter.\n\nFIX!\n\nShould joins in this really be as...\n\nFROM dw.KEY.keymap key \nLEFT outer JOIN dw.KEY.keymap prnt\nON KEY.PARENT_KEYMAP_ID=prnt.KEYMAP_ID\nLEFT OUTER JOIN dw.KEY.KEYMAP gp \nON prnt.PARENT_KEYMAP_ID = gp.KEYMAP_ID\nLEFT outer JOIN dw.KEY.keymap ggp\nON gp.PARENT_KEYMAP_ID=ggp.KEYMAP_ID","colour":"f9c21b"},"1216":{"id":1216,"x":-395,"y":-76,"width":359,"height":164,"text":"**``CHANGE HISTORY``**\n\n20190725:  Changed to support composite source keys.  Requires many DDL changes...\nnew table DW.KEY.KEY_MAP\nAdditional column COLUMN_VALUE_LIST on KEY tables (plus COLUMN_VALUE & DATA_TYPE  as NULLABLE)\n20190726:  Added support for raise exceptions in Python code (BRR)\n20190821:  Added support for Key Objects on SCD objects (BRR)\n20200108:  Change the SQL for KeyMap List to eliminate redundancies.  (BRR)\n20200114:  Changed to add TO_VARCHAR to the Key Object definition (BRR)\n20200115:  Changed to correct TO_VARCHAR in Key Object.  (BRR)\n20200116:  Changed Key Object to properly handle composite value lists.  (BRR)","colour":"00ce4f"}},"variables":{"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"ODS_GRS_NO"}},"grids":{"KeyMap":{"definition":{"name":"KeyMap","scope":"BRANCH","definitions":[{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]}}},{"id":1234,"revision":2,"created":1611346220673,"timestamp":1611346220673,"components":{"1236":{"id":1236,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-336,"y":-48,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1241],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1237":{"id":1237,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1897708461,"x":-112,"y":-48,"width":32,"height":32,"inputConnectorIDs":[1241],"outputSuccessConnectorIDs":[1240],"outputFailureConnectorIDs":[1242],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Excel Query 0"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Customer"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"RowId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_SYSTEM_NAME"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT ..."}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_GRS_NO"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DBO"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_RESTRICTED_DATA"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"18":{"slot":18,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Excel"}}}},"visible":false},"400":{"slot":400,"name":"Storage URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://prodwewhstore/restricted-data/restricteddata.xlsx"}}}},"visible":true},"401":{"slot":401,"name":"Cell Range","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"A1:B1048786"}}}},"visible":true},"402":{"slot":402,"name":"Contains Header Row","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"403":{"slot":403,"name":"Credentials","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"498":{"slot":498,"name":"Storage Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Azure Blob Storage"}}}},"visible":true},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"1992":{"slot":1992,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1994":{"slot":1994,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1995":{"slot":1995,"name":"Stage Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1996":{"slot":1996,"name":"Stage Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1997":{"slot":1997,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1998":{"slot":1998,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1999":{"slot":1999,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"2000":{"slot":2000,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake Managed"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1238":{"id":1238,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":167,"y":-50,"width":32,"height":32,"inputConnectorIDs":[1240],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1239":{"id":1239,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-112,"y":64,"width":32,"height":32,"inputConnectorIDs":[1242],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"1240":{"id":1240,"sourceID":1237,"targetID":1238}},"failureConnectors":{"1242":{"id":1242,"sourceID":1237,"targetID":1239}},"unconditionalConnectors":{"1241":{"id":1241,"sourceID":1236,"targetID":1237}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1235":{"id":1235,"x":-185,"y":-129,"width":237,"height":134,"text":"Pull the data from Excel Restricted Data into ODS and while processing in ODS ignore these data into Global data platform warehouse","colour":"e6e63c"}},"variables":{"SYSTEMNAME":{"definition":{"name":"SYSTEMNAME","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"GRS_NO"},"SchemaName":{"definition":{"name":"SchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CONTROL"},"DatabaseName":{"definition":{"name":"DatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DW"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"1"}},"grids":{}},{"id":452806,"revision":2,"created":1614316521475,"timestamp":1614316521475,"components":{"452801":{"id":452801,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-240,"y":-48,"width":32,"height":32,"inputConnectorIDs":[452813],"outputSuccessConnectorIDs":[452815],"outputFailureConnectorIDs":[452810],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Restricted Level 3 and above"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\nSourceSystemId\t,\nODSDatabaseName\t,\nODSSchemaName\t,\nODSTableName\t,\ntrim(SourceSystemName) SourceSystemName,\nOrphanDelete_Expressions,\nIsOrphanDelete\nfrom dw.control.sourcesystem_loadprocess3\nWHERE LOADPROCESS_ACTIVEFLAG=true \nAND OrphanDelete_Expressions is not null\nAND sourcesystemid=${SourceSystemId}\nAND IsOrphanDelete  = TRUE\nand RestrictedTable_Rank>2\n--and ODSTableName = 'CONTR_PART_VER'\nOrder by RestrictedTable_Rank asc\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DeleteOrphan"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMNAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ORPHANDELETE_EXPRESSIONS"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ISORPHANDELETE"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"452802":{"id":452802,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-32,"y":80,"width":32,"height":32,"inputConnectorIDs":[452811],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"452803":{"id":452803,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-416,"y":-48,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[452813],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"452804":{"id":452804,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":112,"y":-48,"width":32,"height":32,"inputConnectorIDs":[452812],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"452805":{"id":452805,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-243,"y":83,"width":32,"height":32,"inputConnectorIDs":[452810],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"452807":{"id":452807,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-32,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build Orphan record Deletion"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0] FULL PULL\n###\ncmd = OrphanDelete_Expressions\nprint(cmd)\nprint('*****************************')\nif IsOrphanDelete == 'true':\n    \tcursor = context.cursor()\n    \tcursor.execute(cmd)\n        rowcount =  cursor.fetchone()[0]\n        print(str(rowcount) + \"   - Number of Records deleted\")"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[452808]},"452814":{"id":452814,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-32,"y":-48,"width":32,"height":16,"inputConnectorIDs":[452815],"outputSuccessConnectorIDs":[452812],"outputFailureConnectorIDs":[452811],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop OrphantableList for deletion"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DeleteOrphan"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSystemName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"OrphanDelete_Expressions"},"2":{"slot":2,"type":"STRING","value":"OrphanDelete_Expressions"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"IsOrphanDelete"},"2":{"slot":2,"type":"STRING","value":"IsOrphanDelete"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[452808],"inputIterationConnectorIDs":[]}},"successConnectors":{"452815":{"id":452815,"sourceID":452801,"targetID":452814},"452812":{"id":452812,"sourceID":452814,"targetID":452804}},"failureConnectors":{"452810":{"id":452810,"sourceID":452801,"targetID":452805},"452811":{"id":452811,"sourceID":452814,"targetID":452802}},"unconditionalConnectors":{"452813":{"id":452813,"sourceID":452803,"targetID":452801}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"452808":{"id":452808,"sourceID":452814,"targetID":452807}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CONTR_PART_VER"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"IsOrphanDelete":{"definition":{"name":"IsOrphanDelete","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":"true"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"ODS_GRS_NO"},"SourceSystemName":{"definition":{"name":"SourceSystemName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS_NO"},"OrphanDelete_Expressions":{"definition":{"name":"OrphanDelete_Expressions","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":" Delete from ODS_GRS_NO.DBO.CONTR_PART_VER where CONTRACT_ID not in (SELECT CONTRACT_ID from  ODS_GRS_NO.DBO.CONTRACT)"}},"grids":{"DeleteOrphan":{"definition":{"name":"DeleteOrphan","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"},{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"},{"name":"SourceSystemName","type":"TEXT"},{"name":"OrphanDelete_Expressions","type":"TEXT"},{"name":"IsOrphanDelete","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},{"id":1244,"revision":2,"created":1611346220686,"timestamp":1611346220686,"components":{"1245":{"id":1245,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-64,"y":160,"width":32,"height":32,"inputConnectorIDs":[1293],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1246":{"id":1246,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-64,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load_Source_Stage_Object"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"StageObject"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ContainerName"},"2":{"slot":2,"type":"STRING","value":"${ContainerName}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"${LoadType}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SourceConnectionString"},"2":{"slot":2,"type":"STRING","value":"${SourceConnectionString}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"SourceDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${SourceDatabaseName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SourceJDBCDriver"},"2":{"slot":2,"type":"STRING","value":"${SourceJDBCDriver}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"SourcePassword"},"2":{"slot":2,"type":"STRING","value":"${SourcePassword}"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSchemaName"},"2":{"slot":2,"type":"STRING","value":"${SourceSchemaName}"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"SourceTableName"},"2":{"slot":2,"type":"STRING","value":"${SourceTableName}"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"SourceUserID"},"2":{"slot":2,"type":"STRING","value":"${SourceUserID}"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"StageType"},"2":{"slot":2,"type":"STRING","value":"${StageType}"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"WatermarkColumnName"},"2":{"slot":2,"type":"STRING","value":"${WatermarkColumnName}"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"WatermarkDataType"},"2":{"slot":2,"type":"STRING","value":"${WatermarkDataType}"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"IsRestricted"},"2":{"slot":2,"type":"STRING","value":"${IsRestricted}"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedColumnName"},"2":{"slot":2,"type":"STRING","value":"${RestrictedColumnName}"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedTablename"},"2":{"slot":2,"type":"STRING","value":"${RestrictedTablename}"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"Source_sql"},"2":{"slot":2,"type":"STRING","value":"${Source_sql}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[1296]},"1247":{"id":1247,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-496,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1290],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1248":{"id":1248,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-256,"y":-16,"width":32,"height":32,"inputConnectorIDs":[1290],"outputSuccessConnectorIDs":[1289],"outputFailureConnectorIDs":[1294],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get LoadProcess List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\nSourceSystemId\t,\nSourceJDBCDriver\t,\nSourceConnectionString\t,\nsourceuserid,\nsourcepassword,\nSourceDatabaseName\t,\nSourceSchemaName\t,\nSourceTableName\t,\nStageType\t,\nStageDatabaseName\t,\nStageSchemaName\t,\nStageTableName\t,\nWatermarkColumnName\t,\nWatermarkDataType\t,\nWatermarkValue\t,\nODSDatabaseName\t,\nODSSchemaName\t,\nODSTableName\t,\nreplace(lower(StageDatabaseName),'_','-') as ContainerName,\ntrim(SourceSystemName) SourceSystemName,\nIsRestricted,\nRestrictedColumnName,\nRestrictedTablename,\nSource_Sql,\nExpressions\t\nfrom dw.control.sourcesystem_loadprocess3\nWHERE LOADPROCESS_ACTIVEFLAG=true \nAND STAGETYPE <> 'BYPASS'\nAND sourcesystemid=${SourceSystemId}\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadProcess"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCEJDBCDRIVER"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCECONNECTIONSTRING"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCEUSERID"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCEPASSWORD"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCEDATABASENAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESCHEMANAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCETABLENAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETYPE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"WATERMARKCOLUMNNAME"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"WATERMARKDATATYPE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"WATERMARKVALUE"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"CONTAINERNAME"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMNAME"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"ISRESTRICTED"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDCOLUMNNAME"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDTABLENAME"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_SQL"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"EXPRESSIONS"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1249":{"id":1249,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-64,"y":-16,"width":32,"height":16,"inputConnectorIDs":[1289],"outputSuccessConnectorIDs":[1287],"outputFailureConnectorIDs":[1293],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop sourcesystem parameter List - Stage"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadProcess"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SourceJDBCDriver"},"2":{"slot":2,"type":"STRING","value":"SourceJDBCDriver"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SourceConnectionString"},"2":{"slot":2,"type":"STRING","value":"SourceConnectionString"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SourceDatabaseName"},"2":{"slot":2,"type":"STRING","value":"SourceDatabaseName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSchemaName"},"2":{"slot":2,"type":"STRING","value":"SourceSchemaName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SourceTableName"},"2":{"slot":2,"type":"STRING","value":"SourceTableName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"StageType"},"2":{"slot":2,"type":"STRING","value":"StageType"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"StageDatabaseName"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"StageSchemaName"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"StageTableName"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"WatermarkColumnName"},"2":{"slot":2,"type":"STRING","value":"WatermarkColumnName"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"WatermarkDataType"},"2":{"slot":2,"type":"STRING","value":"WatermarkDataType"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"SourceUserid"},"2":{"slot":2,"type":"STRING","value":"SourceUserID"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"SourcePassword"},"2":{"slot":2,"type":"STRING","value":"SourcePassword"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"ContainerName"},"2":{"slot":2,"type":"STRING","value":"ContainerName"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSystemName"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"IsRestricted"},"2":{"slot":2,"type":"STRING","value":"IsRestricted"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedTablename"},"2":{"slot":2,"type":"STRING","value":"RestrictedTablename"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedColumnName"},"2":{"slot":2,"type":"STRING","value":"RestrictedColumnName"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"Source_sql"},"2":{"slot":2,"type":"STRING","value":"Source_sql"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[1296],"inputIterationConnectorIDs":[]},"1250":{"id":1250,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":592,"y":-16,"width":32,"height":32,"inputConnectorIDs":[1288],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1280":{"id":1280,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-256,"y":160,"width":32,"height":32,"inputConnectorIDs":[1294],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1281":{"id":1281,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":384,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build Restricted Delete SQL"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0] FULL PULL\n###\n# RestrictedColumnName='C1,C2'\nif IsRestricted == 'true':\n    \tcmd = \" Delete from \"+StageDatabaseName+\".\"+StageSchemaName+\".\"+StageTableName +\" where \" +RestrictedColumnName + \" IN ( \"+ \\\n        Expressions +\")\"\n        print(cmd)\n    \tcursor = context.cursor()\n    \tcursor.execute(cmd)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[1295]},"1282":{"id":1282,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":384,"y":160,"width":32,"height":32,"inputConnectorIDs":[1291],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1283":{"id":1283,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":384,"y":-16,"width":32,"height":16,"inputConnectorIDs":[1286],"outputSuccessConnectorIDs":[1288],"outputFailureConnectorIDs":[1291],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop sourcesystem parameter List -Stage"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Deleteprocess"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"StageDatabaseName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"StageSchemaName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"StageTableName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSystemName"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"IsRestricted"},"2":{"slot":2,"type":"STRING","value":"IsRestricted"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedTablename"},"2":{"slot":2,"type":"STRING","value":"RestrictedTablename"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"RestrictedColumnName"},"2":{"slot":2,"type":"STRING","value":"RestrictedColumnName"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"Expressions"},"2":{"slot":2,"type":"STRING","value":"Expressions"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemName"},"2":{"slot":2,"type":"STRING","value":"SourceSchemaName"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[1295],"inputIterationConnectorIDs":[]},"1284":{"id":1284,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":176,"y":-16,"width":32,"height":32,"inputConnectorIDs":[1287],"outputSuccessConnectorIDs":[1286],"outputFailureConnectorIDs":[1292],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Restricted DeleteProcess List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\nSourceSystemId\t,\nStageDatabaseName\t,\nStageSchemaName\t,\nStageTableName\t,\nODSDatabaseName\t,\nODSSchemaName\t,\nODSTableName\t,\ntrim(SourceSystemName) SourceSystemName,\nIsRestricted,\nRestrictedColumnName,\nRestrictedTablename,\nExpressions\t\nfrom dw.control.sourcesystem_loadprocess3\nWHERE LOADPROCESS_ACTIVEFLAG=true \nAND STAGETYPE <> 'BYPASS'\nAND sourcesystemid=${SourceSystemId}\nAND IsRestricted = 'TRUE'\nOrder by RestrictedTable_Rank desc\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Deleteprocess"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMNAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ISRESTRICTED"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDCOLUMNNAME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"RESTRICTEDTABLENAME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"EXPRESSIONS"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1285":{"id":1285,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":176,"y":160,"width":32,"height":32,"inputConnectorIDs":[1292],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"1286":{"id":1286,"sourceID":1284,"targetID":1283},"1287":{"id":1287,"sourceID":1249,"targetID":1284},"1288":{"id":1288,"sourceID":1283,"targetID":1250},"1289":{"id":1289,"sourceID":1248,"targetID":1249}},"failureConnectors":{"1291":{"id":1291,"sourceID":1283,"targetID":1282},"1292":{"id":1292,"sourceID":1284,"targetID":1285},"1293":{"id":1293,"sourceID":1249,"targetID":1245},"1294":{"id":1294,"sourceID":1248,"targetID":1280}},"unconditionalConnectors":{"1290":{"id":1290,"sourceID":1247,"targetID":1248}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"1296":{"id":1296,"sourceID":1249,"targetID":1246},"1295":{"id":1295,"sourceID":1283,"targetID":1281}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"LoadType":{"definition":{"name":"LoadType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"APPEND"},"StageType":{"definition":{"name":"StageType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"INCREMENTAL"},"Source_sql":{"definition":{"name":"Source_sql","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"select * from"},"Expressions":{"definition":{"name":"Expressions","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"SELECT CUSTOMER_ID from ODS_GRS_NO.DBO.CUSTOMER_RESTRICTED_DATA"},"IsRestricted":{"definition":{"name":"IsRestricted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"TRUE"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"SourceUserID":{"definition":{"name":"SourceUserID","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"seu_dwloader"},"ContainerName":{"definition":{"name":"ContainerName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"stg_grs_norway"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourcePassword":{"definition":{"name":"SourcePassword","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS-NO-EU"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"2"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"ODS_GRS_NO"},"SourceTableName":{"definition":{"name":"SourceTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceJDBCDriver":{"definition":{"name":"SourceJDBCDriver","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"SQL Server (Microsoft Driver)"},"SourceSchemaName":{"definition":{"name":"SourceSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceSystemName":{"definition":{"name":"SourceSystemName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS_NO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"STG_GRS_NO"},"WatermarkDataType":{"definition":{"name":"WatermarkDataType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"TIMESTAMP"},"SourceDatabaseName":{"definition":{"name":"SourceDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS_NO"},"RestrictedTablename":{"definition":{"name":"RestrictedTablename","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_RESTRICTED_DATA"},"WatermarkColumnName":{"definition":{"name":"WatermarkColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"INSERT_DATE"},"RestrictedColumnName":{"definition":{"name":"RestrictedColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_ID"},"SourceConnectionString":{"definition":{"name":"SourceConnectionString","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"jdbc:sqlserver://10.163.116.32\\GRS_NO:1433"}},"grids":{"LoadProcess":{"definition":{"name":"LoadProcess","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"},{"name":"SourceJDBCDriver","type":"TEXT"},{"name":"SourceConnectionString","type":"TEXT"},{"name":"SourceUserid","type":"TEXT"},{"name":"SourcePassword","type":"TEXT"},{"name":"SourceDatabaseName","type":"TEXT"},{"name":"SourceSchemaName","type":"TEXT"},{"name":"SourceTableName","type":"TEXT"},{"name":"StageType","type":"TEXT"},{"name":"StageDatabaseName","type":"TEXT"},{"name":"StageSchemaName","type":"TEXT"},{"name":"StageTableName","type":"TEXT"},{"name":"WatermarkColumnName","type":"TEXT"},{"name":"WatermarkDataType","type":"TEXT"},{"name":"WatermarkValue","type":"TEXT"},{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"},{"name":"ContainerName","type":"TEXT"},{"name":"SourceSystemName","type":"TEXT"},{"name":"IsRestricted","type":"TEXT"},{"name":"RestrictedColumnName","type":"TEXT"},{"name":"RestrictedTablename","type":"TEXT"},{"name":"Source_sql","type":"TEXT"},{"name":"Expressions","type":"TEXT"}],"description":"LoadProcess","visibility":"PRIVATE"},"values":[]},"Deleteprocess":{"definition":{"name":"Deleteprocess","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"},{"name":"StageDatabaseName","type":"TEXT"},{"name":"StageSchemaName","type":"TEXT"},{"name":"StageTableName","type":"TEXT"},{"name":"ODSDatabaseName","type":"TEXT"},{"name":"ODSSchemaName","type":"TEXT"},{"name":"ODSTableName","type":"TEXT"},{"name":"SourceSystemName","type":"TEXT"},{"name":"IsRestricted","type":"TEXT"},{"name":"RestrictedColumnName","type":"TEXT"},{"name":"RestrictedTablename","type":"TEXT"},{"name":"Expressions","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]}}},{"id":1297,"revision":2,"created":1611346220698,"timestamp":1611346220698,"components":{"1251":{"id":1251,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-352,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1262],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1252":{"id":1252,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":631604974,"x":-208,"y":0,"width":32,"height":32,"inputConnectorIDs":[1262],"outputSuccessConnectorIDs":[1261],"outputFailureConnectorIDs":[1264],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL Server (Microsoft Driver)"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceConnectionString}"}}}},"visible":true},"4":{"slot":4,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceUserID}"}}}},"visible":true},"5":{"slot":5,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${SourcePassword}"}}}},"visible":true},"6":{"slot":6,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"databaseName"},"2":{"slot":2,"type":"STRING","value":"${SourceDatabaseName}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"instanceName"},"2":{"slot":2,"type":"STRING","value":"${SourceSchemaName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"useSSL"},"2":{"slot":2,"type":"STRING","value":"true"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"requireSSL"},"2":{"slot":2,"type":"STRING","value":"false"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"verifyServerCertificate"},"2":{"slot":2,"type":"STRING","value":"false"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSchemaName}"}}}},"visible":true},"8":{"slot":8,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceTableName}"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"10":{"slot":10,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Size"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Precision"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Primary Key"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1253":{"id":1253,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-208,"y":144,"width":32,"height":32,"inputConnectorIDs":[1264],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1254":{"id":1254,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-28,"y":0,"width":32,"height":32,"inputConnectorIDs":[1261],"outputSuccessConnectorIDs":[1259],"outputFailureConnectorIDs":[1265],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build SQL"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport datetime\n\nprint StageType\nprint WatermarkDataType\nprint SourceJDBCDriver\n\nif StageType == 'INCREMENTAL':\n    cmd = \"select max(\"+WatermarkColumnName+\") from \" + \\\n        ODSDatabaseName+\".\"+ODSSchemaName+\".\"+ODSTableName\n    print(cmd)\n    cursor = context.cursor()\n    cursor.execute(cmd)\n    maxval = cursor.fetchone()\n    print(type(maxval[0]))\n    output = \"\"\n        #output = \"'\"+maxval[0].strftime(\"%Y-%m-%d %H:%M:%S.%f\") [:-3] + \"'\"\n      #output = \"'\"+maxval[0].strftime(\"%Y-%m-%d %H:%M:%S\")+ \"'\"\n    if type(maxval[0]) == datetime.datetime:\n        output = \"'\"+maxval[0].strftime(\"%Y-%m-%d %H:%M:%S.%f\") [:-3] + \"'\"\n    elif type(maxval[0]) == datetime.date:\n        output = \"'\"+maxval[0].strftime(\"%Y-%m-%d\")+\"'\"\n    elif type(maxval[0]) == datetime.time:\n        output = \"'\"+maxval[0].strftime(\"%H:%M:%S.%f\")+\"'\"\n    elif type(maxval[0]) == int:\n        output = \"'\"+str(maxval[0])+\"'\"\n    elif type(maxval[0]) == float:\n        output = \"'\"+str(maxval[0])+\"'\"\n    elif type(maxval[0]) == long:\n        output = \"'\"+str(maxval[0])+\"'\"\n    elif type(maxval[0]) == complex:\n        output = \"'\"+str(maxval[0])+\"'\"\n    elif maxval[0] == None:\n        if WatermarkDataType == \"TIMESTAMP\":\n            output = \"'1800-01-01 00:00:00'\"\n        else:\n          output = \"0\"\n\n    if \"ORACLE\" in SourceJDBCDriver.upper() and WatermarkDataType == \"TIMESTAMP\":\n        WatermarkLastValue = \"TO_TIMESTAMP(\"+output+\", 'YYYY-MM-DD HH24:MI:SS')\"\n    else:\n        WatermarkLastValue = output\n\n\n    context.updateVariable('WatermarkLastValue', WatermarkLastValue)\n    print(\"Type of WatermarkLastValue:  \",type(WatermarkLastValue))\n    print(\"WatermarkLastValue:  \", WatermarkLastValue)\n\n    context.updateGridVariable('SourceFilter', [[WatermarkColumnName,'Is','Greater than',WatermarkLastValue]])\n    \nelse:\n    print(\"NOT INCREMENTAL\")\n#    context.updateGridVariable('SourceFilter', [None,None,None,None])\n\n##Build SourceSQL Variable\n#ExecuteSourceSQL=\"select * from \"+SourceSchemaName+\".\"+SourceTableName\nSourceSQL=Source_sql + \" \" + SourceSchemaName+\".\"+SourceTableName\nprint(\"Base SourceSQL: \", SourceSQL)\nif StageType == \"INCREMENTAL\" :\n  context.updateVariable(\"ExecuteSourceSQL\", SourceSQL+\" where \"+WatermarkColumnName+\" > \"+WatermarkLastValue)\n\nprint(\"SourceSQL:  \",SourceSQL)\nprint(\"ExecuteSourceSQL:  \",ExecuteSourceSQL)\nprint(\"SourceFilter:  \",context.getGridVariable('SourceFilter'))\n\nprint(\"STGColumns: \",context.getGridVariable('STGColumns'))"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1255":{"id":1255,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-32,"y":144,"width":32,"height":32,"inputConnectorIDs":[1265],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1256":{"id":1256,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":784,"y":0,"width":32,"height":32,"inputConnectorIDs":[1260],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1257":{"id":1257,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":400,"y":144,"width":32,"height":32,"inputConnectorIDs":[1263],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1258":{"id":1258,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":400,"y":0,"width":32,"height":32,"inputConnectorIDs":[1259],"outputSuccessConnectorIDs":[1260],"outputFailureConnectorIDs":[1263],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Extract & Stage Data"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceJDBCDriver}"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceConnectionString}"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceUserID}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${SourcePassword}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ExecuteSourceSQL}"}}}},"visible":true},"9":{"slot":9,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"databaseName"},"2":{"slot":2,"type":"STRING","value":"${SourceDatabaseName}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"instanceName"},"2":{"slot":2,"type":"STRING","value":"${SourceSchemaName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"useSSL"},"2":{"slot":2,"type":"STRING","value":"true"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"requireSSL"},"2":{"slot":2,"type":"STRING","value":"false"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"verifyServerCertificate"},"2":{"slot":2,"type":"STRING","value":"false"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"zeroDateTimeBehavior"},"2":{"slot":2,"type":"STRING","value":"convertToNull"}}}},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":false},"13":{"slot":13,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"14":{"slot":14,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageTableName}"}}}},"visible":true},"15":{"slot":15,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"16":{"slot":16,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"17":{"slot":17,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"101":{"slot":101,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"102":{"slot":102,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"103":{"slot":103,"name":"Data Selection","elements":{},"visible":false},"104":{"slot":104,"name":"Data Source Filter","elements":{},"visible":false},"105":{"slot":105,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"106":{"slot":106,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1992":{"slot":1992,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1994":{"slot":1994,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1995":{"slot":1995,"name":"Stage Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1996":{"slot":1996,"name":"Stage Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1997":{"slot":1997,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1998":{"slot":1998,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1999":{"slot":1999,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"2000":{"slot":2000,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake Managed"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"1259":{"id":1259,"sourceID":1254,"targetID":1258},"1260":{"id":1260,"sourceID":1258,"targetID":1256},"1261":{"id":1261,"sourceID":1252,"targetID":1254}},"failureConnectors":{"1264":{"id":1264,"sourceID":1252,"targetID":1253},"1265":{"id":1265,"sourceID":1254,"targetID":1255},"1263":{"id":1263,"sourceID":1258,"targetID":1257}},"unconditionalConnectors":{"1262":{"id":1262,"sourceID":1251,"targetID":1252}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1298":{"id":1298,"x":-739,"y":-127,"width":301,"height":469,"text":"``Required Variables`` \n\nODSDatabaseName\nODSSchemaName\nODSTableName\nSourceConnectionString\nSourceDatabaseName\nSourceJDBCDriver\nSourcePassword\nSourceSchemaName\nSourceSQL\nSourceTableName\nSourceUserName\nStageType\nSTGDatabaseName\nSTGSchemaName\nSTGTableName\nWatermarkColumnName\nWatermarkDataType\nWatermarkLastValue\n\n``Required Grid Variables``\n1) Source Filter:\nInput_Column\nQualifier\nComparator\nValue\n2) STGColumn\nName\nType\nSize\nPrecision\nPrimary_Key","colour":"e6e63c"},"1299":{"id":1299,"x":-98,"y":-47,"width":252,"height":110,"text":"Pull Incremental data based on the Watermark columns as mention in metadata","colour":"e6e63c"},"1300":{"id":1300,"x":182,"y":-122,"width":498,"height":223,"text":"Snowflake managed the Stage area where data loads (Truncate and Load) from SRC to STG \n\nThis component is potentially destructive. If the target table undergoes a change in structure, it will be recreated. Otherwise, the target table is truncated. Setting the Load Option Recreate Target Table to \"Off\" will prevent both recreation and truncation. Do not modify the target table structure manually.\n\n","colour":"e6e63c"}},"variables":{"LoadType":{"definition":{"name":"LoadType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"APPEND"},"StageType":{"definition":{"name":"StageType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"INCREMENTAL"},"Source_sql":{"definition":{"name":"Source_sql","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"Select * from"},"IsRestricted":{"definition":{"name":"IsRestricted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"TRUE"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"SourceUserID":{"definition":{"name":"SourceUserID","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"seu_dwloader"},"ContainerName":{"definition":{"name":"ContainerName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"stg_grs_norway"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourcePassword":{"definition":{"name":"SourcePassword","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"GRS-NO-EU"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"TEXT","scope":"BRANCH","description":"1","visibility":"PUBLIC"},"value":"2"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"SourceTableName":{"definition":{"name":"SourceTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"ExecuteSourceSQL":{"definition":{"name":"ExecuteSourceSQL","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"select * from ${SourceSchemaName}.${SourceTableName}"},"SourceJDBCDriver":{"definition":{"name":"SourceJDBCDriver","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"SQL Server (Microsoft Driver)"},"SourceSchemaName":{"definition":{"name":"SourceSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemName":{"definition":{"name":"SourceSystemName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS_NO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"},"WatermarkDataType":{"definition":{"name":"WatermarkDataType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"TIMESTAMP"},"SourceDatabaseName":{"definition":{"name":"SourceDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"GRS_NO"},"WatermarkLastValue":{"definition":{"name":"WatermarkLastValue","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"'1800-01-01 00:00:00'"},"RestrictedTablename":{"definition":{"name":"RestrictedTablename","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_RESTRICTED_DATA"},"WatermarkColumnName":{"definition":{"name":"WatermarkColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CHANGE_DATE"},"RestrictedColumnName":{"definition":{"name":"RestrictedColumnName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID"},"SourceConnectionString":{"definition":{"name":"SourceConnectionString","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"jdbc:sqlserver://10.163.116.32\\GRS_NO:1433"}},"grids":{"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Primary_Key","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"SourceFilter":{"definition":{"name":"SourceFilter","scope":"BRANCH","definitions":[{"name":"Input_Column","type":"TEXT"},{"name":"Qualifier","type":"TEXT"},{"name":"Comparator","type":"TEXT"},{"name":"Value","type":"TEXT"}],"description":"SourceFilter","visibility":"PRIVATE"},"values":[]}}},{"id":1267,"revision":2,"created":1611346220712,"timestamp":1611346220712,"components":{"1270":{"id":1270,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-576,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1279],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1271":{"id":1271,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-416,"y":-16,"width":32,"height":32,"inputConnectorIDs":[1279],"outputSuccessConnectorIDs":[1277],"outputFailureConnectorIDs":[1301],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get LoadProcess List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select Distinct\nSOURCESYSTEMID,\nSTAGEDATABASENAME,\nSTAGESCHEMANAME,\nSTAGETABLENAME,\nODSDATABASENAME,\nODSSCHEMANAME,\nODSTABLENAME,\nSOURCESYSTEM_ACTIVEFLAG,\nLOADTYPE,\nCOLUMNLISTEXP\nfrom dw.control.sourcesystem_loadprocess3\nwhere sourcesystem_activeflag=TRUE\nand loadprocess_activeflag=TRUE\nand sourcesystemid=${SourceSystemId}\nand COLUMNLISTEXP is not null"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ObjectList"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"LOADTYPE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMNLISTEXP"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1272":{"id":1272,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-160,"y":-16,"width":32,"height":16,"inputConnectorIDs":[1277],"outputSuccessConnectorIDs":[1278],"outputFailureConnectorIDs":[1302],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop Stg system parameter List - Ods"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ObjectList"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STAGEDATABASENAME"},"2":{"slot":2,"type":"STRING","value":"StageDatabaseName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STAGESCHEMANAME"},"2":{"slot":2,"type":"STRING","value":"StageSchemaName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"STAGETABLENAME"},"2":{"slot":2,"type":"STRING","value":"StageTableName"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDATABASENAME"},"2":{"slot":2,"type":"STRING","value":"ODSDatabaseName"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSCHEMANAME"},"2":{"slot":2,"type":"STRING","value":"ODSSchemaName"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTABLENAME"},"2":{"slot":2,"type":"STRING","value":"ODSTableName"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"LOADTYPE"},"2":{"slot":2,"type":"STRING","value":"LoadType"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMNLISTEXP"},"2":{"slot":2,"type":"STRING","value":"ColumnListExp"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[1303],"inputIterationConnectorIDs":[]},"1273":{"id":1273,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":128,"y":-16,"width":32,"height":32,"inputConnectorIDs":[1278],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1274":{"id":1274,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-416,"y":160,"width":32,"height":32,"inputConnectorIDs":[1301],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1275":{"id":1275,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-160,"y":160,"width":32,"height":32,"inputConnectorIDs":[1302],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1276":{"id":1276,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-160,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load_Stage_ODS_Object"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadObject_STG_ODS"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"${LoadType}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[1303]}},"successConnectors":{"1277":{"id":1277,"sourceID":1271,"targetID":1272},"1278":{"id":1278,"sourceID":1272,"targetID":1273}},"failureConnectors":{"1301":{"id":1301,"sourceID":1271,"targetID":1274},"1302":{"id":1302,"sourceID":1272,"targetID":1275}},"unconditionalConnectors":{"1279":{"id":1279,"sourceID":1270,"targetID":1271}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"1303":{"id":1303,"sourceID":1272,"targetID":1276}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1268":{"id":1268,"x":-908,"y":-88,"width":292,"height":204,"text":"``Required Variables`` \n(Text\tCopied\tPrivate) excluding the  SourceSystemId\t\n\nODSDatabaseName\nODSSchemaName\nODSTableName\nSourceSystemId\nSourceUserId\nSTGDatabaseName\nSTGSchemaName\nSTGTableName\n\n``Required Grid Variables``\nObjectList (Column Names)\nSOURCESYSTEMID\nSTAGEDATABASENAME\nSTAGESCHEMANAME\nSTAGETABLENAME\nODSDATABASENAME\nODSSCHEMANAME\nODSTABLENAME\nLOADTYPE","colour":"e6e63c"},"1269":{"id":1269,"x":-326,"y":-108,"width":340,"height":202,"text":" ``Grid Iterator Loop Stg system parameter List - Ods  ``\n\nSOURCESYSTEMID\nSTAGEDATABASENAME\nSTAGESCHEMANAME\nSTAGETABLENAME\nODSDATABASENAME\nODSSCHEMANAME\nODSTABLENAME\nLOADTYPE\n","colour":"e6e63c"}},"variables":{"LoadType":{"definition":{"name":"LoadType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"UPSERT"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"SourceUserId":{"definition":{"name":"SourceUserId","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"GRS_NO"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"2"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"STG_GRS_NO"}},"grids":{"ObjectList":{"definition":{"name":"ObjectList","scope":"BRANCH","definitions":[{"name":"SOURCESYSTEMID","type":"DECIMAL"},{"name":"STAGEDATABASENAME","type":"TEXT"},{"name":"STAGESCHEMANAME","type":"TEXT"},{"name":"STAGETABLENAME","type":"TEXT"},{"name":"ODSDATABASENAME","type":"TEXT"},{"name":"ODSSCHEMANAME","type":"TEXT"},{"name":"ODSTABLENAME","type":"TEXT"},{"name":"LOADTYPE","type":"TEXT"},{"name":"COLUMNLISTEXP","type":"TEXT"}],"description":"ObjectList","visibility":"PRIVATE"},"values":[]}}},{"id":1304,"revision":2,"created":1611346220723,"timestamp":1611346220723,"components":{"1305":{"id":1305,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-352,"y":96,"width":32,"height":32,"inputConnectorIDs":[1348],"outputSuccessConnectorIDs":[1341,1342],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PK Grid Variable"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n##access Hashcolumnlist Grid Variable\n\n#v_Hashcolumnlist=context.getGridVariable('Hashcolumnlist')\n#print(\"v_Hashcolumnlist:  \",v_Hashcolumnlist)\n\n##access ColumnListExp Grid Variable\nv_ColumnListExp=context.getGridVariable('ColumnListExp')\nprint(\"v_ColumnListExp:  \",v_ColumnListExp)\n\n##access ODSColumns Grid Variable\nv_ODSColumns=context.getGridVariable('ODSColumns')\nprint(\"v_ODSColumns:  \",v_ODSColumns)\n\n## Build PKColumns Grid Variable\nPKColumns=[[c[0],] for c in v_ODSColumns if c[8] =='Yes']\ncontext.updateGridVariable('PKColumns', PKColumns)\nprint(\"PKColumns:  \",context.getGridVariable('PKColumns'))\n\n## Build PKColumns\nPKColumnsList=[\"\\\"tgt\\\".\\\"\"+c[0]+\"\\\"=\\\"src\\\".\\\"\"+c[0]+\"\\\"\" for c in v_ODSColumns if c[8] =='Yes']\nPKMatch=\" and \".join(PKColumnsList) if len(PKColumnsList) > 0 else \"\"\ncontext.updateVariable('PKMatch', PKMatch)\nprint(\"PKMatch:  \",PKMatch)\n\n## Build PKMatch Variable\nPKLister=[\"\\\"\"+c[0]+\"\\\"\" for c in v_ODSColumns if c[8] =='Yes']\nPKList=\", \".join(PKLister) if len(PKLister) > 0 else \"\"\ncontext.updateVariable('PKList', PKList)\nprint(\"PKList:  \",PKList)\n\n## Build CompareColumns\nCompareColumnsList=[[c[0], \"\\\"compare_\"+c[0]+\"\\\"\",] for c in v_ODSColumns if (c[8] == 'No' and c[0] != 'ODS_SRC_SYSTEM_ID' and c[0] != 'ODS_MODIFIEDBY' and c[0] != 'ODS_MODIFIEDBY_TIMESTAMP')]\ncontext.updateGridVariable('CompareColumns', CompareColumnsList)\nprint(\"CompareColumns:  \",context.getGridVariable('CompareColumns'))\n\n##Build CompareList\nCCList=[\"EQUAL_NULL(\\\"tgt\\\".\\\"\"+c[0]+\"\\\",\\\"src\\\".\\\"\"+c[0]+\"\\\") = FALSE\" for c in v_ODSColumns if (c[8] == 'No' and c[0] != 'ODS_SRC_SYSTEM_ID' and c[0] != 'ODS_MODIFIEDBY' and c[0] != 'ODS_MODIFIEDBY_TIMESTAMP')]\nCompareList=\" or \".join(CCList) if len(CCList) > 0 else \"\"\ncontext.updateVariable('CompareList', CompareList)\nprint(\"CompareList:  \",CompareList)\n\n##Build OtherList\nOtherLister=[\"\\\"\"+c[0]+\"\\\"\" for c in v_ODSColumns if (c[8] == 'No' and c[0] != 'ODS_SRC_SYSTEM_ID' and c[0] != 'ODS_MODIFIEDBY' and c[0] != 'ODS_MODIFIEDBY_TIMESTAMP')]\nOtherColumns=\", \".join(OtherLister) if len(OtherLister) > 0 else \"\"\ncontext.updateVariable('OtherColumns', OtherColumns)\nprint(\"OtherColumns:  \", OtherColumns)\n\n#End\n#quit()"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1306":{"id":1306,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-128,"y":64,"width":32,"height":32,"inputConnectorIDs":[1341],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[1350],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If UPSERT"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"UPSERT"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1307":{"id":1307,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":96,"y":64,"width":32,"height":32,"inputConnectorIDs":[1350],"outputSuccessConnectorIDs":[1336],"outputFailureConnectorIDs":[1358],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Upsert"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Upsert"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"PKMatch"},"2":{"slot":2,"type":"STRING","value":"${PKMatch}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{"2":{"slot":2,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}},"3":{"slot":3,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1308":{"id":1308,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":336,"y":64,"width":32,"height":32,"inputConnectorIDs":[1358],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure  6"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1309":{"id":1309,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-128,"y":176,"width":32,"height":32,"inputConnectorIDs":[1342],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[1352],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If DIFFERENCE"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"DIFFERENCE"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1310":{"id":1310,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":80,"y":176,"width":32,"height":32,"inputConnectorIDs":[1352],"outputSuccessConnectorIDs":[1338],"outputFailureConnectorIDs":[1355],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Difference"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Difference"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"PKMatch"},"2":{"slot":2,"type":"STRING","value":"${PKMatch}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"CompareList"},"2":{"slot":2,"type":"STRING","value":"${CompareList}"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{"2":{"slot":2,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}},"3":{"slot":3,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1311":{"id":1311,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":336,"y":176,"width":32,"height":32,"inputConnectorIDs":[1355],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 8"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1312":{"id":1312,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1280,"y":-256,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1354],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1313":{"id":1313,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":356330947,"x":-1104,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1354],"outputSuccessConnectorIDs":[1345],"outputFailureConnectorIDs":[1364],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"5":{"slot":5,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"6":{"slot":6,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Database Type"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Size"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Precision"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Default Value"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"Not Null"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"Unique"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"Primary Key"}}}},"visible":true},"7":{"slot":7,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1314":{"id":1314,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-1104,"y":-96,"width":32,"height":32,"inputConnectorIDs":[1364],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1315":{"id":1315,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1395699082,"x":-944,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1345],"outputSuccessConnectorIDs":[1346],"outputFailureConnectorIDs":[1356],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove Audit Fields"}}}},"visible":true},"2":{"slot":2,"name":"Target Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"3":{"slot":3,"name":"Key Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}}},"visible":true},"4":{"slot":4,"name":"Operation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Not In"}}}},"visible":true},"5":{"slot":5,"name":"Fixed/Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fixed"}}}},"visible":true},"6":{"slot":6,"name":"Values Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"}}}},"visible":true},"7":{"slot":7,"name":"Source Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":false},"8":{"slot":8,"name":"Key Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMN_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DATA_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LENGTH"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PK"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1316":{"id":1316,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-944,"y":-96,"width":32,"height":32,"inputConnectorIDs":[1356],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1317":{"id":1317,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-369209785,"x":-784,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1346],"outputSuccessConnectorIDs":[1335],"outputFailureConnectorIDs":[1357],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"2":{"slot":2,"name":"Target Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"3":{"slot":3,"name":"Fixed/Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid"}}}},"visible":true},"4":{"slot":4,"name":"Values Grid","elements":{},"visible":false},"5":{"slot":5,"name":"Source Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"}}}},"visible":true},"6":{"slot":6,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Database_Type"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Size"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Precision"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Default_Value"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"Not_Null"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"Unique"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"Primary_Key"}}}},"visible":true},"7":{"slot":7,"name":"Append/Prepend","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1318":{"id":1318,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-784,"y":-96,"width":32,"height":32,"inputConnectorIDs":[1357],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1319":{"id":1319,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-672,"y":-96,"width":32,"height":32,"inputConnectorIDs":[1360],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1320":{"id":1320,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1395699082,"x":-608,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1335],"outputSuccessConnectorIDs":[1344,1347,1337],"outputFailureConnectorIDs":[1360],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns Remove Audit Fields"}}}},"visible":true},"2":{"slot":2,"name":"Target Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":true},"3":{"slot":3,"name":"Key Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}}},"visible":true},"4":{"slot":4,"name":"Operation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Not In"}}}},"visible":true},"5":{"slot":5,"name":"Fixed/Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fixed"}}}},"visible":true},"6":{"slot":6,"name":"Values Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}}},"visible":true},"7":{"slot":7,"name":"Source Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"}}}},"visible":false},"8":{"slot":8,"name":"Key Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMN_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DATA_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LENGTH"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PK"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1321":{"id":1321,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-464,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1344],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[1349],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If APPEND"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"APPEND"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1322":{"id":1322,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-304,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1349],"outputSuccessConnectorIDs":[1339],"outputFailureConnectorIDs":[1362],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Append"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Append"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{"2":{"slot":2,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}},"3":{"slot":3,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1323":{"id":1323,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-304,"y":-160,"width":32,"height":32,"inputConnectorIDs":[1362],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 4"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1324":{"id":1324,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":592,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1334,1336,1338,1339],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1353],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1325":{"id":1325,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":880,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1343],"outputSuccessConnectorIDs":[1340],"outputFailureConnectorIDs":[1363],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Logging"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Logging"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ProcessType"},"2":{"slot":2,"type":"STRING","value":"LOAD"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"RunResult"},"2":{"slot":2,"type":"STRING","value":"SUCCESS"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Command"},"2":{"slot":2,"type":"STRING","value":"LOAD - ${LoadType}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1326":{"id":1326,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":1152,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1340],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1327":{"id":1327,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":1152,"y":-176,"width":32,"height":32,"inputConnectorIDs":[1363],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1328":{"id":1328,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-448,"y":-48,"width":32,"height":32,"inputConnectorIDs":[1347],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[1351],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If OVERWRITE"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"OVERWRITE"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1329":{"id":1329,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-304,"y":-48,"width":32,"height":32,"inputConnectorIDs":[1351],"outputSuccessConnectorIDs":[1334],"outputFailureConnectorIDs":[1361],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Overwrite"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load - Overwrite"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"${SourceSystemId}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"StageDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${StageDatabaseName}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"StageSchemaName"},"2":{"slot":2,"type":"STRING","value":"${StageSchemaName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"StageTableName"},"2":{"slot":2,"type":"STRING","value":"${StageTableName}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODSDatabaseName"},"2":{"slot":2,"type":"STRING","value":"${ODSDatabaseName}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODSSchemaName"},"2":{"slot":2,"type":"STRING","value":"${ODSSchemaName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODSTableName"},"2":{"slot":2,"type":"STRING","value":"${ODSTableName}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ColumnListExp"},"2":{"slot":2,"type":"STRING","value":"${ColumnListExp}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{"2":{"slot":2,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"ODSColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}},"3":{"slot":3,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Name"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"STGColumns"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1330":{"id":1330,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-80,"y":-48,"width":32,"height":32,"inputConnectorIDs":[1361],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 5"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1331":{"id":1331,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-608,"y":96,"width":32,"height":32,"inputConnectorIDs":[1337],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[1348],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If DIFFERENCE or DIFFERENCEDELETE or UPSERT or SCD"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"UPSERT"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"DIFFERENCEDELETE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"DIFFERENCE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"LoadType"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"SCD"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1332":{"id":1332,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":736,"y":-256,"width":32,"height":32,"inputConnectorIDs":[1353],"outputSuccessConnectorIDs":[1343],"outputFailureConnectorIDs":[1359],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build STG Clean SQL"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible:\n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0] FULL PULL\n###\nif StageTableName is not None:\n    \tcmd = \" Truncate table \"+StageDatabaseName+\".\"+StageSchemaName+\".\"+StageTableName \n        print(cmd)\n    \tcursor = context.cursor()\n    \tcursor.execute(cmd)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1333":{"id":1333,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":736,"y":-112,"width":32,"height":32,"inputConnectorIDs":[1359],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure  7"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"1344":{"id":1344,"sourceID":1320,"targetID":1321},"1345":{"id":1345,"sourceID":1313,"targetID":1315},"1346":{"id":1346,"sourceID":1315,"targetID":1317},"1347":{"id":1347,"sourceID":1320,"targetID":1328},"1334":{"id":1334,"sourceID":1329,"targetID":1324},"1335":{"id":1335,"sourceID":1317,"targetID":1320},"1336":{"id":1336,"sourceID":1307,"targetID":1324},"1337":{"id":1337,"sourceID":1320,"targetID":1331},"1338":{"id":1338,"sourceID":1310,"targetID":1324},"1339":{"id":1339,"sourceID":1322,"targetID":1324},"1340":{"id":1340,"sourceID":1325,"targetID":1326},"1341":{"id":1341,"sourceID":1305,"targetID":1306},"1342":{"id":1342,"sourceID":1305,"targetID":1309},"1343":{"id":1343,"sourceID":1332,"targetID":1325}},"failureConnectors":{"1360":{"id":1360,"sourceID":1320,"targetID":1319},"1361":{"id":1361,"sourceID":1329,"targetID":1330},"1362":{"id":1362,"sourceID":1322,"targetID":1323},"1363":{"id":1363,"sourceID":1325,"targetID":1327},"1364":{"id":1364,"sourceID":1313,"targetID":1314},"1355":{"id":1355,"sourceID":1310,"targetID":1311},"1356":{"id":1356,"sourceID":1315,"targetID":1316},"1357":{"id":1357,"sourceID":1317,"targetID":1318},"1358":{"id":1358,"sourceID":1307,"targetID":1308},"1359":{"id":1359,"sourceID":1332,"targetID":1333}},"unconditionalConnectors":{"1353":{"id":1353,"sourceID":1324,"targetID":1332},"1354":{"id":1354,"sourceID":1312,"targetID":1313}},"trueConnectors":{"1348":{"id":1348,"sourceID":1331,"targetID":1305},"1349":{"id":1349,"sourceID":1321,"targetID":1322},"1350":{"id":1350,"sourceID":1306,"targetID":1307},"1351":{"id":1351,"sourceID":1328,"targetID":1329},"1352":{"id":1352,"sourceID":1309,"targetID":1310}},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{"PKList":{"definition":{"name":"PKList","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"PK_CUSTOMER"},"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"\"tgt\".\"CUSTOMER_ID\"=\"src\".\"CUSTOMER_ID\""},"LoadType":{"definition":{"name":"LoadType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"UPSERT"},"ClusterKey":{"definition":{"name":"ClusterKey","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":""},"CompareList":{"definition":{"name":"CompareList","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_ID"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"OtherColumns":{"definition":{"name":"OtherColumns","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CUSTOMER_ID"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"Constraint_Name":{"definition":{"name":"Constraint_Name","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"PK_CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"Table_Recreated":{"definition":{"name":"Table_Recreated","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"False"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"PKColumns":{"definition":{"name":"PKColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["CUSTOMER_ID"]}]},"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Database_Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Default_Value","type":"TEXT"},{"name":"Not_Null","type":"TEXT"},{"name":"Unique","type":"TEXT"},{"name":"Primary_Key","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["CUSTOMER_ID","","","","","","","",""]}]},"SCDColumns":{"definition":{"name":"SCDColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Database_Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Default_Value","type":"TEXT"},{"name":"Not_Null","type":"TEXT"},{"name":"Unique","type":"TEXT"},{"name":"Primary_Key","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"Name","type":"TEXT"},{"name":"Type","type":"TEXT"},{"name":"Database_Type","type":"TEXT"},{"name":"Size","type":"TEXT"},{"name":"Precision","type":"TEXT"},{"name":"Default_Value","type":"TEXT"},{"name":"Not_Null","type":"TEXT"},{"name":"Unique","type":"TEXT"},{"name":"Primary_Key","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["CUSTOMER_ID","","","","","","","",""]}]},"Constraints":{"definition":{"name":"Constraints","scope":"BRANCH","definitions":[{"name":"constraint_name","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]},"ColumnListExp":{"definition":{"name":"ColumnListExp","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"ColumnListExp","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"CompareColumns":{"definition":{"name":"CompareColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"},{"name":"COMPARE_NAME","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["CUSTOMER_TYPE_ID","compare_CUSTOMER_TYPE_ID"]}]}}},{"id":1452,"revision":35,"created":1614318634460,"timestamp":1614318634460,"components":{"1453":{"id":1453,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-592,"y":-80,"width":32,"height":32,"inputConnectorIDs":[1472],"outputSuccessConnectorIDs":[1470],"outputFailureConnectorIDs":[1478],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get SourceSystemId List"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW"}}}},"visible":false},"4":{"slot":4,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEM"}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}}},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select SOURCESYSTEMID\nfrom \"DW\".\"CONTROL\".\"SOURCESYSTEM\"\nwhere activeflag=true\nand SOURCESYSTEMNAME = '${SYSTEMNAME}'\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystem"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCESYSTEMID"}}}},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CONTROL"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1454":{"id":1454,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-592,"y":48,"width":32,"height":32,"inputConnectorIDs":[1478],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1455":{"id":1455,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-880,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1473],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1456":{"id":1456,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-272,"y":64,"width":32,"height":32,"inputConnectorIDs":[1475],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 3"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1457":{"id":1457,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":176,"y":-80,"width":32,"height":32,"inputConnectorIDs":[453293],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1458":{"id":1458,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-112,"y":-80,"width":32,"height":16,"inputConnectorIDs":[1471],"outputSuccessConnectorIDs":[453195],"outputFailureConnectorIDs":[1474],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop over SourceSystemId List - Key Processing"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystem"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[1481],"inputIterationConnectorIDs":[]},"1459":{"id":1459,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-112,"y":48,"width":32,"height":32,"inputConnectorIDs":[1474],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 4"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1460":{"id":1460,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1625823177,"x":-112,"y":-48,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW Key Processing 0"}}}},"visible":true},"2":{"slot":2,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[1481]},"1461":{"id":1461,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-432,"y":-80,"width":32,"height":16,"inputConnectorIDs":[1470],"outputSuccessConnectorIDs":[1468],"outputFailureConnectorIDs":[1476],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop SourceSystemId List - Stage"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystem"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[1480],"inputIterationConnectorIDs":[]},"1462":{"id":1462,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-272,"y":-80,"width":32,"height":16,"inputConnectorIDs":[1468],"outputSuccessConnectorIDs":[1471],"outputFailureConnectorIDs":[1475],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop SourceSystemId List - ODS Load"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystem"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[1479],"inputIterationConnectorIDs":[]},"1463":{"id":1463,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-432,"y":64,"width":32,"height":32,"inputConnectorIDs":[1476],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 2"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1464":{"id":1464,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-768,"y":48,"width":32,"height":32,"inputConnectorIDs":[1477],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1465":{"id":1465,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":962214725,"x":-432,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load Source to Stage System"}}}},"visible":true},"2":{"slot":2,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[1480]},"1466":{"id":1466,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-342421753,"x":-272,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load Stage to ODS System"}}}},"visible":true},"2":{"slot":2,"name":"ColumnListExp","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"}}}},"visible":true},"3":{"slot":3,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[1479]},"1467":{"id":1467,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1348346479,"x":-774,"y":-75,"width":32,"height":32,"inputConnectorIDs":[1473],"outputSuccessConnectorIDs":[1472],"outputFailureConnectorIDs":[1477],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted Data Load 0"}}}},"visible":true},"2":{"slot":2,"name":"SYSTEMNAME","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRS_NO"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"453105":{"id":453105,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-878169426,"x":32,"y":-48,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OrphanDataDeletion 0"}}}},"visible":true},"2":{"slot":2,"name":"SourceSystemId","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"}}}},"visible":true},"3":{"slot":3,"name":"DeleteOrphan","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[453192]},"453168":{"id":453168,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":32,"y":-80,"width":32,"height":16,"inputConnectorIDs":[453195],"outputSuccessConnectorIDs":[453293],"outputFailureConnectorIDs":[453245],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop OrphantableList for deletion"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystem"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SourceSystemId"},"2":{"slot":2,"type":"STRING","value":"SourceSystemId"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[453192],"inputIterationConnectorIDs":[]},"453234":{"id":453234,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":37,"y":50,"width":32,"height":32,"inputConnectorIDs":[453245],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 5"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"1472":{"id":1472,"sourceID":1467,"targetID":1453},"1468":{"id":1468,"sourceID":1461,"targetID":1462},"453195":{"id":453195,"sourceID":1458,"targetID":453168},"1470":{"id":1470,"sourceID":1453,"targetID":1461},"1471":{"id":1471,"sourceID":1462,"targetID":1458},"453293":{"id":453293,"sourceID":453168,"targetID":1457}},"failureConnectors":{"1474":{"id":1474,"sourceID":1458,"targetID":1459},"1475":{"id":1475,"sourceID":1462,"targetID":1456},"1476":{"id":1476,"sourceID":1461,"targetID":1463},"1477":{"id":1477,"sourceID":1467,"targetID":1464},"1478":{"id":1478,"sourceID":1453,"targetID":1454},"453245":{"id":453245,"sourceID":453168,"targetID":453234}},"unconditionalConnectors":{"1473":{"id":1473,"sourceID":1455,"targetID":1467}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"1479":{"id":1479,"sourceID":1462,"targetID":1466},"1480":{"id":1480,"sourceID":1461,"targetID":1465},"1481":{"id":1481,"sourceID":1458,"targetID":1460},"453192":{"id":453192,"sourceID":453168,"targetID":453105}},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1614317589523,"canRedo":false,"redoCommand":"","redoCreated":1614317493577,"notes":{},"variables":{"SYSTEMNAME":{"definition":{"name":"SYSTEMNAME","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"GRS_NO"},"SchemaName":{"definition":{"name":"SchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"CONTROL"},"DatabaseName":{"definition":{"name":"DatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"DW"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"1"}},"grids":{"SourceSystem":{"definition":{"name":"SourceSystem","scope":"BRANCH","definitions":[{"name":"SourceSystemId","type":"DECIMAL"}],"description":"","visibility":"PRIVATE"},"values":[{"values":["1"]}]}}}],"transformationJobs":[{"id":1365,"revision":2,"created":1611346220737,"timestamp":1611346220737,"components":{"1368":{"id":1368,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":160,"y":192,"width":32,"height":32,"inputConnectorIDs":[1372],"outputConnectorIDs":[1371],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1369":{"id":1369,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":364,"y":196,"width":32,"height":32,"inputConnectorIDs":[1371],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1370":{"id":1370,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":-32,"y":192,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1372],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${ColumnListExp} from ${StageDatabaseName}.${StageSchemaName}.\"${StageTableName}\""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1371":{"id":1371,"sourceID":1368,"targetID":1369},"1372":{"id":1372,"sourceID":1370,"targetID":1368}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1366":{"id":1366,"x":-466,"y":73,"width":272,"height":204,"text":"``Required Variables`` \n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nSourceSystemId\t\nStageDatabaseName\t\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns (COLUMN_NAME)\nODSColumns COLUMN_NAME)","colour":"e6e63c"},"1367":{"id":1367,"x":-465,"y":-4,"width":250,"height":58,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"}},"noteConnectors":{},"variables":{"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"ColumnListExp":{"definition":{"name":"ColumnListExp","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"COLUMNLISTEXP","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]}}},{"id":1373,"revision":2,"created":1611346220749,"timestamp":1611346220749,"components":{"1376":{"id":1376,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":400,"y":240,"width":32,"height":32,"inputConnectorIDs":[1380],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge ODS"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${PKMatch}"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${CompareList}"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1377":{"id":1377,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":240,"y":240,"width":32,"height":32,"inputConnectorIDs":[1379],"outputConnectorIDs":[1380],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1378":{"id":1378,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":64,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1379],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${ColumnListExp} from ${StageDatabaseName}.${StageSchemaName}.${StageTableName}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1379":{"id":1379,"sourceID":1378,"targetID":1377},"1380":{"id":1380,"sourceID":1377,"targetID":1376}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1374":{"id":1374,"x":-317,"y":87,"width":257,"height":247,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nCompareList\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nPKMatch\t\nSourceSystemId\t\nStageDatabaseName\t\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns (COLUMN_NAME)\nODSColumns  (COLUMN_NAME)","colour":"e6e63c"},"1375":{"id":1375,"x":-315,"y":7,"width":250,"height":58,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"}},"noteConnectors":{},"variables":{"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"\"tgt\".\"CUSTOMER_ID\"=\"src\".\"CUSTOMER_ID\""},"CompareList":{"definition":{"name":"CompareList","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"equal_null(src.ADDRESS,tgt.ADDRESS) = FALSE OR equal_null(src.NAME,tgt.NAME)=FALSE"},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,'1029','KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,'1029','KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,'1029','KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,'1029','KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,'1029','KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"COLUMNLISTEXP":{"definition":{"name":"COLUMNLISTEXP","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"COLUMNLISTEXP","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]}}},{"id":1381,"revision":2,"created":1611346220755,"timestamp":1611346220755,"components":{"1384":{"id":1384,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":720,"y":240,"width":32,"height":32,"inputConnectorIDs":[1393],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge ODS"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${PKMatch}"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR = 'C'"},"2":{"slot":2,"type":"STRING","value":"Update"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR = 'D'"},"2":{"slot":2,"type":"STRING","value":"Delete"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1385":{"id":1385,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":560,"y":240,"width":32,"height":32,"inputConnectorIDs":[1390],"outputConnectorIDs":[1393],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1386":{"id":1386,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":80,"y":304,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1391],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1387":{"id":1387,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":240,"y":240,"width":32,"height":32,"inputConnectorIDs":[1392,1391],"outputConnectorIDs":[1394],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect Changes"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"PKColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"CompareColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"CompareColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COMPARE_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1388":{"id":1388,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":400,"y":240,"width":32,"height":32,"inputConnectorIDs":[1394],"outputConnectorIDs":[1390],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"N, C, or D"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"INDICATOR"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"D"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1389":{"id":1389,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":80,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1392],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageTableName}"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"STGColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageSchemaName}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${StageDatabaseName}"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1392":{"id":1392,"sourceID":1389,"targetID":1387},"1393":{"id":1393,"sourceID":1385,"targetID":1384},"1394":{"id":1394,"sourceID":1387,"targetID":1388},"1390":{"id":1390,"sourceID":1388,"targetID":1385},"1391":{"id":1391,"sourceID":1386,"targetID":1387}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1382":{"id":1382,"x":-234,"y":167,"width":267,"height":233,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nPKMatch\t\nSourceSystemId\t\nStageDatabaseName\t\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns  (COLUMN_NAME)\nODSColumns  (COLUMN_NAME)\nCompareColumns (COLLUMN_NAME, COMPARE_NAME)\nPKColumns (COLUMN_NAME)","colour":"e6e63c"},"1383":{"id":1383,"x":-232,"y":84,"width":286,"height":61,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"}},"noteConnectors":{},"variables":{"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"src.customer_id = tgt.customer_id "},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_TYPE_ID\tcompare_CUSTOMER_TYPE_ID"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NORWAY"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NORWAY"}},"grids":{"PKColumns":{"definition":{"name":"PKColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_TYPE_ID"]},{"values":["CUSTOMER_ID"]},{"values":["NAME_1"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_TYPE_ID"]},{"values":["CUSTOMER_ID"]},{"values":["NAME_1"]}]},"ColumnListExp":{"definition":{"name":"ColumnListExp","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"COLUMNLISTEXP","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"CompareColumns":{"definition":{"name":"CompareColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"},{"name":"COMPARE_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_TYPE_ID","compare_CUSTOMER_TYPE_ID"]}]}}},{"id":1395,"revision":2,"created":1611346220765,"timestamp":1611346220765,"components":{"1399":{"id":1399,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":262,"y":198,"width":32,"height":32,"inputConnectorIDs":[1409],"outputConnectorIDs":[1410],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1400":{"id":1400,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":364,"y":196,"width":32,"height":32,"inputConnectorIDs":[1410],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1408":{"id":1408,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":128,"y":192,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1409],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${ColumnListExp} from ${StageDatabaseName}.${StageSchemaName}.${StageTableName}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1409":{"id":1409,"sourceID":1408,"targetID":1399},"1410":{"id":1410,"sourceID":1399,"targetID":1400}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1396":{"id":1396,"x":-233,"y":6,"width":250,"height":58,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"},"1397":{"id":1397,"x":242,"y":59,"width":250,"height":58,"text":"SELECT \n  \"CUST_OBJ_ID\", \n  CURRENT_TIMESTAMP()\nAS \"ODS_MODIFIEDBY_TIMESTAMP\", \n  CURRENT_USER()\t\t\nAS \"ODS_MODIFIEDBY\", \n  1\nAS \"ODS_SRC_SYSTEM_ID\", \n  MD5(NVL( ADDRESS,'0')||NVL( ADDRESS_2,'0')||NVL( CUST_OBJ_NO,0)||NVL( NAME,'0')||NVL( POSTCODE,0)||NVL( POSTDELIVERY_ADDRESS,'0'))\nAS \"HASHVALUE\" \nFROM \"STG_GRS_NORWAY\".\"DBO\".\"CUSTOMER_OBJECT\";","colour":"e6e63c"},"1398":{"id":1398,"x":-234,"y":87,"width":280,"height":195,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nSourceSystemId\t\nStageDatabaseName\t\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns  (COLUMN_NAME)\nODSColumns  (COLUMN_NAME)","colour":"e6e63c"}},"noteConnectors":{},"variables":{"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,1029,'KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,1029,'KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,1029,'KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,1029,'KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,1029,'KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"COLUMNLISTEXP":{"definition":{"name":"COLUMNLISTEXP","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"COLUMNLISTEXP","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]}}},{"id":1411,"revision":2,"created":1611346220773,"timestamp":1611346220773,"components":{"1414":{"id":1414,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":464,"y":208,"width":32,"height":32,"inputConnectorIDs":[1418],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge ODS"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${PKMatch}"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"true"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true}},"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Rows Inserted","mapTo":"RowInserted"}},"expectedFailure":null,"activationStatus":"ENABLED"},"1415":{"id":1415,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":262,"y":210,"width":32,"height":32,"inputConnectorIDs":[1417],"outputConnectorIDs":[1418],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1416":{"id":1416,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":96,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1417],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${ColumnListExp} from ${StageDatabaseName}.${StageSchemaName}.${StageTableName}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1417":{"id":1417,"sourceID":1416,"targetID":1415},"1418":{"id":1418,"sourceID":1415,"targetID":1414}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1412":{"id":1412,"x":-232,"y":84,"width":276,"height":180,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nPKMatch\nSourceSystemId\nStageDatabaseName\nStageSchemaName\t\nStageTableName\t\n\n``Required Grid Variables``\nSTGColumns  (COLUMN_NAME)\nODSColumns  (COLUMN_NAME)","colour":"e6e63c"},"1413":{"id":1413,"x":-235,"y":6,"width":250,"height":58,"text":"**``NOTE``**\n\nGrid Variables must NOT have default values entered, otherwise they will be included in the variable values.","colour":"d60000"}},"noteConnectors":{},"variables":{"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"\"tgt\".\"CUSTOMER_ID\"=\"src\".\"CUSTOMER_ID\""},"RowInserted":{"definition":{"name":"RowInserted","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ColumnListExp":{"definition":{"name":"ColumnListExp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_ID, CUSTOMER_TYPE_ID, CUSTOMER_NO, VALIDTO, INSERT_DATE, CHANGE_DATE,encrypt(NAME_SEARCH,'1029','KEY_2020','aes-gcm') NAME_SEARCH ,encrypt(NAME_1,'1029','KEY_2020','aes-gcm') NAME_1  ,encrypt(ADDRESS,'1029','KEY_2020','aes-gcm') ADDRESS  ,encrypt(POSTCODE,'1029','KEY_2020','aes-gcm') POSTCODE  ,encrypt(POSTADDRESS,'1029','KEY_2020','aes-gcm') POSTADDRESS"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"StageTableName":{"definition":{"name":"StageTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NO"},"StageSchemaName":{"definition":{"name":"StageSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"StageDatabaseName":{"definition":{"name":"StageDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STG_GRS_NO"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"STGColumns":{"definition":{"name":"STGColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]},"ColumnListExp":{"definition":{"name":"ColumnListExp","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"ColumnListExp","visibility":"PUBLIC"},"values":[{"values":["CUSTOMER_ID"]}]}}},{"id":1419,"revision":2,"created":1611346220779,"timestamp":1611346220779,"components":{"1421":{"id":1421,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1040,"y":240,"width":32,"height":32,"inputConnectorIDs":[1435],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert Multiple Current"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}_SCD"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"SCDColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1422":{"id":1422,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":80,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1441],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"ODSColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1423":{"id":1423,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":400,"y":400,"width":32,"height":32,"inputConnectorIDs":[1440],"outputConnectorIDs":[1443],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Single Active Only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"\"ODS_MODIFIEDBY_TIMESTAMP\""}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1424":{"id":1424,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":640,"y":240,"width":32,"height":32,"inputConnectorIDs":[1442],"outputConnectorIDs":[1434],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Multiple Current"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"ODS_MODIFIEDBY_TIMESTAMP\"::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_START_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'9999-12-31 23:59:59.99999'::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_END_TIMESTAMP"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TRUE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_CURRENT_FLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_FLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Null::TIMESTAMP_LTZ"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1425":{"id":1425,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1949249710,"x":240,"y":240,"width":32,"height":32,"inputConnectorIDs":[1441],"outputConnectorIDs":[1440,1444],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Replicate"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1426":{"id":1426,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":640,"y":400,"width":32,"height":32,"inputConnectorIDs":[1443],"outputConnectorIDs":[1436],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Single Current"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"ODS_CREATEDBY_TIMESTAMP\"::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_START_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'9999-12-31 23:59:59.99999'::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_END_TIMESTAMP"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TRUE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_CURRENT_FLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_FLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"null::timestamp_LTZ"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1427":{"id":1427,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":400,"y":240,"width":32,"height":32,"inputConnectorIDs":[1444],"outputConnectorIDs":[1442,1445],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Multiple Only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_CREATEDBY_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"\"ODS_MODIFIEDBY_TIMESTAMP\""}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1428":{"id":1428,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":640,"y":320,"width":32,"height":32,"inputConnectorIDs":[1445],"outputConnectorIDs":[1438],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Multiple Closed"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"ODS_CREATEDBY_TIMESTAMP\"::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_START_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"ODS_MODIFIEDBY_TIMESTAMP\"::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"SCD_END_TIMESTAMP"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_CURRENT_FLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE::boolean"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_FLAG"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"null::timestamp_LTZ"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1429":{"id":1429,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1040,"y":320,"width":32,"height":32,"inputConnectorIDs":[1439],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert Multiple Closed"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}_SCD"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"SCDColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1430":{"id":1430,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":800,"y":240,"width":32,"height":32,"inputConnectorIDs":[1434],"outputConnectorIDs":[1435],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS - Multiple Current"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1431":{"id":1431,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1040,"y":400,"width":32,"height":32,"inputConnectorIDs":[1437],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert Single Current"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}_SCD"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"SCDColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1432":{"id":1432,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":800,"y":400,"width":32,"height":32,"inputConnectorIDs":[1436],"outputConnectorIDs":[1437],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS - Single Current"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1433":{"id":1433,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":800,"y":320,"width":32,"height":32,"inputConnectorIDs":[1438],"outputConnectorIDs":[1439],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS - Multiple Closed"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1440":{"id":1440,"sourceID":1425,"targetID":1423},"1441":{"id":1441,"sourceID":1422,"targetID":1425},"1442":{"id":1442,"sourceID":1427,"targetID":1424},"1443":{"id":1443,"sourceID":1423,"targetID":1426},"1444":{"id":1444,"sourceID":1425,"targetID":1427},"1445":{"id":1445,"sourceID":1427,"targetID":1428},"1434":{"id":1434,"sourceID":1424,"targetID":1430},"1435":{"id":1435,"sourceID":1430,"targetID":1421},"1436":{"id":1436,"sourceID":1426,"targetID":1432},"1437":{"id":1437,"sourceID":1432,"targetID":1431},"1438":{"id":1438,"sourceID":1428,"targetID":1433},"1439":{"id":1439,"sourceID":1433,"targetID":1429}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1420":{"id":1420,"x":-232,"y":163,"width":271,"height":177,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nSourceSystemId\t\n\n``Required Grid Variables``\nSTGColumns (COLUMN_NAME)\nODSColumns (COLUMN_NAME)","colour":"e6e63c"}},"noteConnectors":{},"variables":{"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_OBJECT"},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NORWAY"}},"grids":{"ODSColumns":{"definition":{"name":"ODSColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUST_OBJ_ID"]}]},"SCDColumns":{"definition":{"name":"SCDColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["CUST_OBJ_ID"]}]}}},{"id":1446,"revision":2,"created":1611346220788,"timestamp":1611346220788,"components":{"1448":{"id":1448,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":240,"y":240,"width":32,"height":32,"inputConnectorIDs":[1402],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge SCD"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSTableName}_SCD"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSSchemaName}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ODSDatabaseName}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"src"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${PKMatch}\nAND\n\"tgt\".\"SCD_START_TIMESTAMP\"=\"src\".\"SCD_START_TIMESTAMP\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tgt.scd_current_flag = true"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD_END_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SCD_END_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SCD_CURRENT_FLAG"},"2":{"slot":2,"type":"STRING","value":"SCD_CURRENT_FLAG"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SCD_DELETE_FLAG"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_FLAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SCD_DELETE_TIMESTAMP"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"SCDColumns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"COLUMN_NAME"},"2":{"slot":2,"type":"GRID","value":"COLUMN_NAME"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1449":{"id":1449,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":-80,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1401],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS STREAM"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${PKList}, ${OtherColumns},\nods_modifiedby_timestamp as scd_start_timestamp,\ncase\n\twhen metadata$action='DELETE' AND metadata$isupdate=TRUE THEN lag(ods_modifiedby_timestamp) over (partition by ${PKList} order by ods_modifiedby_timestamp desc)\n    when metadata$action='DELETE' AND metadata$isupdate=FALSE THEN current_timestamp::timestamp_ltz\n    when metadata$action='INSERT' then '9999-12-31 23:59:59.99999'::TIMESTAMP_LTZ\nend AS scd_end_timestamp,\ncase\n\twhen metadata$action='DELETE' AND metadata$isupdate=TRUE THEN FALSE\n    when metadata$action='DELETE' AND metadata$isupdate=FALSE THEN FALSE\n    when metadata$action='INSERT' then TRUE\nend as scd_current_flag,\ncase\n\twhen metadata$action='DELETE' AND metadata$isupdate=TRUE THEN FALSE\n    when metadata$action='DELETE' AND metadata$isupdate=FALSE THEN TRUE\n    when metadata$action='INSERT' then FALSE\nend as scd_delete_flag,\ncase\n\twhen metadata$action='DELETE' AND metadata$isupdate=TRUE THEN null\n    when metadata$action='DELETE' AND metadata$isupdate=FALSE THEN current_timestamp::timestamp_ltz\n    when metadata$action='INSERT' then null\nend as scd_delete_timestamp\nfrom ${ODSDatabaseName}.${ODSSchemaName}.${ODSTableName}_STREAM"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1450":{"id":1450,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":80,"y":240,"width":32,"height":32,"inputConnectorIDs":[1401],"outputConnectorIDs":[1402],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULTS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP()"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY_TIMESTAMP"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_USER()\t\t"},"2":{"slot":2,"type":"STRING","value":"ODS_MODIFIEDBY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"${SourceSystemId}"},"2":{"slot":2,"type":"STRING","value":"ODS_SRC_SYSTEM_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1401":{"id":1401,"sourceID":1449,"targetID":1450},"1402":{"id":1402,"sourceID":1450,"targetID":1448}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1447":{"id":1447,"x":-397,"y":82,"width":260,"height":216,"text":"``Required Variables``\n(Text\tCopied\tPublic) excluding the  SourceSystemId\t\n\nODSDatabaseName\t\nODSSchemaName\t\nODSTableName\t\nPKList\nPKMatch\nOtherColumns\nSourceSystemId\t\n\n``Required Grid Variables``\nSCDColumns (COLUMN_NAME)","colour":"e6e63c"}},"noteConnectors":{},"variables":{"PKList":{"definition":{"name":"PKList","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"PKMatch":{"definition":{"name":"PKMatch","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":null},"ODSTableName":{"definition":{"name":"ODSTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CUSTOMER_OBJECT"},"OtherColumns":{"definition":{"name":"OtherColumns","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":null},"ODSSchemaName":{"definition":{"name":"ODSSchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DBO"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"ODSDatabaseName":{"definition":{"name":"ODSDatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ODS_GRS_NORWAY"}},"grids":{"SCDColumns":{"definition":{"name":"SCDColumns","scope":"BRANCH","definitions":[{"name":"COLUMN_NAME","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},{"id":1403,"revision":2,"created":1611346220794,"timestamp":1611346220794,"components":{"1405":{"id":1405,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":181,"y":194,"width":32,"height":32,"inputConnectorIDs":[1407],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Logging"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LOGGING"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PROCESS_TYPE"},"2":{"slot":2,"type":"STRING","value":"PROCESS_TYPE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"OBJECT_NAME"},"2":{"slot":2,"type":"STRING","value":"OBJECT_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"COMMAND"},"2":{"slot":2,"type":"STRING","value":"COMMAND"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"RUN_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"RUN_TIMESTAMP"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"RUN_RESULT"},"2":{"slot":2,"type":"STRING","value":"RUN_RESULT"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_INSERTED"},"2":{"slot":2,"type":"STRING","value":"RECORDS_INSERTED"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_UPDATED"},"2":{"slot":2,"type":"STRING","value":"RECORDS_UPDATED"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_DELETED"},"2":{"slot":2,"type":"STRING","value":"RECORDS_DELETED"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_SYSTEM_ID"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CONTROL"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1406":{"id":1406,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":738944574,"x":15,"y":193,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1407],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set Values"}}}},"visible":true},"2":{"slot":2,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PROCESS_TYPE"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":null}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"OBJECT_NAME"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"COMMAND"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"RUN_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"TIMESTAMP"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"RUN_RESULT"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":null},"4":{"slot":4,"type":"INTEGER","value":""}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_INSERTED"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":"0"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_UPDATED"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":"0"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDS_DELETED"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":"0"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_ID"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":""}}}},"visible":true},"3":{"slot":3,"name":"Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'${ProcessType}'"},"2":{"slot":2,"type":"STRING","value":"'${DatabaseName}.${SchemaName}.${TableName}'"},"3":{"slot":3,"type":"STRING","value":"'${Command}'"},"4":{"slot":4,"type":"DATETIME","value":"${RunTimestamp}"},"5":{"slot":5,"type":"STRING","value":"'${RunResult}'"},"6":{"slot":6,"type":"DECIMAL","value":"${RecordsInserted}"},"7":{"slot":7,"type":"DECIMAL","value":"${RecordsUpdated}"},"8":{"slot":8,"type":"DECIMAL","value":"${RecordsDeleted}"},"9":{"slot":9,"type":"DECIMAL","value":"${SourceSystemId}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1407":{"id":1407,"sourceID":1406,"targetID":1405}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"1404":{"id":1404,"x":-366,"y":71,"width":235,"height":177,"text":"``Required Variables``\nCommand\nDatabaseName\nProcessType\nRecordsDeleted\nRecordsInserted\nRecordsUpdated\nRunResult\nRunTimestamp\nSchemaName\nSourceSystemId\nTableName\n","colour":"e6e63c"}},"noteConnectors":{},"variables":{"Command":{"definition":{"name":"Command","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":null},"RunResult":{"definition":{"name":"RunResult","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"UNKNOWN"},"TableName":{"definition":{"name":"TableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"LOGGING"},"SchemaName":{"definition":{"name":"SchemaName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CONTROL"},"ProcessType":{"definition":{"name":"ProcessType","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":null},"DatabaseName":{"definition":{"name":"DatabaseName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"DW"},"RunTimestamp":{"definition":{"name":"RunTimestamp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1800-01-01 00:00:00"},"RecordsDeleted":{"definition":{"name":"RecordsDeleted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"0"},"RecordsUpdated":{"definition":{"name":"RecordsUpdated","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"0"},"SourceSystemId":{"definition":{"name":"SourceSystemId","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"RecordsInserted":{"definition":{"name":"RecordsInserted","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"0"}},"grids":{}}],"variables":[{"name":"env_account","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_monitor_email","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_name","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_password","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_sas_token","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_storage","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},{"name":"env_username","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"}],"environments":[{"index":0,"name":"securitasprod-west-europe","instanceCredentials":true,"credentialsName":"","awsCredentialsId":-1,"gcCredentialsId":-1,"azureCredentialsId":0,"schema":"BASE","encrypted":false,"url":"securitas.west-europe.azure","port":"WH_DATA_LOAD","database":"DW","driver":null,"user":"MATILLION_USER","passwordName":"","passphraseName":"","role":"DATA_LOADER","variables":{"env_name":"PROD","env_monitor_email":"naresh.bawankar@securitas.com;santhosh.tm@securitas.com;jon.skvagerson@securitas.com;","env_password":"Matty_2018$$!!","env_username":"MATILLION_USER","env_account":"securitasprod.west-europe.azure","env_sas_token":"?sv=2019-12-12&ss=btqf&srt=sco&st=2021-01-28T18%3A59%3A58Z&se=2023-01-29T18%3A59%3A00Z&sp=rwdxftlacup&sig=y7pfgmcMpVA6cbHo4KtkxIWddVAAgGufO3kffA1N4%2F8%3D","env_storage":"prodwewhstore"},"defaultStorageLocation":"","concurrentConnections":16,"passwordType":"PASSWORD","connectionOptions":{},"defaultEnvironment":false}]}